Initiating authentication
Started dropping all tables.
Successfully dropped the tables
Started dropping all views.
Successfully dropped the VIEWS
Starting sqoop Import process for builton tables.
Initiating authentication
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/collected_corp_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table collected_corp .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 17:48:13 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 17:48:13 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 17:48:13 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 17:48:13 INFO tool.CodeGenTool: Beginning code generation
18/03/27 17:48:13 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:48:14 INFO manager.SqlManager: Executing SQL statement: select * from dbo.collected_corp where  (1 = 0) 
18/03/27 17:48:14 INFO manager.SqlManager: Executing SQL statement: select * from dbo.collected_corp where  (1 = 0) 
18/03/27 17:48:14 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/777a298fd7afe4ba2ecdd245d228142e/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 17:48:15 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/777a298fd7afe4ba2ecdd245d228142e/QueryResult.jar
18/03/27 17:48:15 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 17:48:15 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 17:48:16 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 17:48:17 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522172897015, maxDate=1522777697015, sequenceNumber=27485, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 17:48:17 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522172897015, maxDate=1522777697015, sequenceNumber=27485, masterKeyId=478)
18/03/27 17:48:17 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172897475, maxDate=1522777697475, sequenceNumber=40234, masterKeyId=862)
18/03/27 17:48:17 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172897851, maxDate=1522777697851, sequenceNumber=40235, masterKeyId=863)
18/03/27 17:48:19 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:48:19 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 17:48:19 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(corp_seq), MAX(corp_seq) FROM (select * from dbo.collected_corp where  (1 = 1) ) AS t1
18/03/27 17:48:19 INFO db.IntegerSplitter: Split size: 60024; Num splits: 4 from: 165165 to: 405263
18/03/27 17:48:20 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 17:48:20 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0893
18/03/27 17:48:20 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172897475, maxDate=1522777697475, sequenceNumber=40234, masterKeyId=862)
18/03/27 17:48:20 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172897851, maxDate=1522777697851, sequenceNumber=40235, masterKeyId=863)
18/03/27 17:48:20 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522172897015, maxDate=1522777697015, sequenceNumber=27485, masterKeyId=478)
18/03/27 17:48:20 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0893
18/03/27 17:48:20 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0893/
18/03/27 17:48:20 INFO mapreduce.Job: Running job: job_1521666602777_0893
18/03/27 17:48:34 INFO mapreduce.Job: Job job_1521666602777_0893 running in uber mode : false
18/03/27 17:48:34 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 17:48:48 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 17:48:49 INFO mapreduce.Job: Job job_1521666602777_0893 completed successfully
18/03/27 17:48:49 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735272
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1164
		HDFS: Number of bytes written=2372383
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=92452
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=46226
		Total vcore-milliseconds taken by all map tasks=46226
		Total megabyte-milliseconds taken by all map tasks=189341696
	Map-Reduce Framework
		Map input records=19223
		Map output records=19223
		Input split bytes=465
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=375
		CPU time spent (ms)=24530
		Physical memory (bytes) snapshot=2049761280
		Virtual memory (bytes) snapshot=22598279168
		Total committed heap usage (bytes)=6160908288
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=2372383
18/03/27 17:48:49 INFO mapreduce.ImportJobBase: Transferred 2.2625 MB in 32.8386 seconds (70.5506 KB/sec)
18/03/27 17:48:49 INFO mapreduce.ImportJobBase: Retrieved 19223 records.
Sqoop Import to History Load Successful for collected_corp .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_category_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table priceon_category .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 17:48:53 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 17:48:53 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 17:48:53 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 17:48:53 INFO tool.CodeGenTool: Beginning code generation
18/03/27 17:48:53 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:48:54 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_category where  (1 = 0) 
18/03/27 17:48:54 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_category where  (1 = 0) 
18/03/27 17:48:54 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/3d7c958e13124e73b4c39572a04d6616/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 17:48:55 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/3d7c958e13124e73b4c39572a04d6616/QueryResult.jar
18/03/27 17:48:55 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 17:48:55 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 17:48:56 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 17:48:56 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522172936768, maxDate=1522777736768, sequenceNumber=27486, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 17:48:57 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522172936768, maxDate=1522777736768, sequenceNumber=27486, masterKeyId=478)
18/03/27 17:48:57 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172937157, maxDate=1522777737157, sequenceNumber=40236, masterKeyId=862)
18/03/27 17:48:57 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172937496, maxDate=1522777737496, sequenceNumber=40237, masterKeyId=863)
18/03/27 17:48:59 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:48:59 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 17:48:59 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(id), MAX(id) FROM (select * from dbo.priceon_category where  (1 = 1) ) AS t1
18/03/27 17:48:59 WARN db.TextSplitter: Generating splits for a textual index column.
18/03/27 17:48:59 WARN db.TextSplitter: If your database sorts in a case-insensitive order, this may result in a partial import or duplicate records.
18/03/27 17:48:59 WARN db.TextSplitter: You are strongly encouraged to choose an integral split column.
18/03/27 17:48:59 WARN db.BigDecimalSplitter: Set BigDecimal splitSize to MIN_INCREMENT
18/03/27 17:48:59 INFO mapreduce.JobSubmitter: number of splits:1
18/03/27 17:48:59 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0894
18/03/27 17:48:59 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172937157, maxDate=1522777737157, sequenceNumber=40236, masterKeyId=862)
18/03/27 17:48:59 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172937496, maxDate=1522777737496, sequenceNumber=40237, masterKeyId=863)
18/03/27 17:48:59 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522172936768, maxDate=1522777736768, sequenceNumber=27486, masterKeyId=478)
18/03/27 17:49:00 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0894
18/03/27 17:49:00 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0894/
18/03/27 17:49:00 INFO mapreduce.Job: Running job: job_1521666602777_0894
18/03/27 17:49:10 INFO mapreduce.Job: Job job_1521666602777_0894 running in uber mode : false
18/03/27 17:49:10 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 17:49:19 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 17:49:19 INFO mapreduce.Job: Job job_1521666602777_0894 completed successfully
18/03/27 17:49:19 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=183804
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=115
		HDFS: Number of bytes written=5870
		HDFS: Number of read operations=4
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=2
	Job Counters 
		Launched map tasks=1
		Other local map tasks=1
		Total time spent by all maps in occupied slots (ms)=12926
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=6463
		Total vcore-milliseconds taken by all map tasks=6463
		Total megabyte-milliseconds taken by all map tasks=26472448
	Map-Reduce Framework
		Map input records=473
		Map output records=473
		Input split bytes=115
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=83
		CPU time spent (ms)=3580
		Physical memory (bytes) snapshot=461938688
		Virtual memory (bytes) snapshot=5646794752
		Total committed heap usage (bytes)=1541406720
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=5870
18/03/27 17:49:19 INFO mapreduce.ImportJobBase: Transferred 5.7324 KB in 23.3361 seconds (251.5414 bytes/sec)
18/03/27 17:49:19 INFO mapreduce.ImportJobBase: Retrieved 473 records.
Sqoop Import to History Load Successful for priceon_category .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_card_price_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table priceon_collected_card_price .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 17:49:23 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 17:49:23 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 17:49:24 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 17:49:24 INFO tool.CodeGenTool: Beginning code generation
18/03/27 17:49:24 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:49:24 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_collected_card_price where  (1 = 0) 
18/03/27 17:49:24 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_collected_card_price where  (1 = 0) 
18/03/27 17:49:24 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/3cdd511d53cf63e5dae6be57b1cb9b0b/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 17:49:26 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/3cdd511d53cf63e5dae6be57b1cb9b0b/QueryResult.jar
18/03/27 17:49:26 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 17:49:26 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 17:49:27 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 17:49:27 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522172967408, maxDate=1522777767408, sequenceNumber=27487, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 17:49:27 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522172967408, maxDate=1522777767408, sequenceNumber=27487, masterKeyId=478)
18/03/27 17:49:27 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172967740, maxDate=1522777767740, sequenceNumber=40238, masterKeyId=862)
18/03/27 17:49:28 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172968040, maxDate=1522777768040, sequenceNumber=40239, masterKeyId=863)
18/03/27 17:49:30 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:49:30 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 17:49:30 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(seq), MAX(seq) FROM (select * from dbo.priceon_collected_card_price where  (1 = 1) ) AS t1
18/03/27 17:49:30 INFO db.IntegerSplitter: Split size: 319386; Num splits: 4 from: 1 to: 1277547
18/03/27 17:49:30 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 17:49:30 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0895
18/03/27 17:49:30 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172967740, maxDate=1522777767740, sequenceNumber=40238, masterKeyId=862)
18/03/27 17:49:30 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522172968040, maxDate=1522777768040, sequenceNumber=40239, masterKeyId=863)
18/03/27 17:49:30 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522172967408, maxDate=1522777767408, sequenceNumber=27487, masterKeyId=478)
18/03/27 17:49:30 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0895
18/03/27 17:49:30 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0895/
18/03/27 17:49:30 INFO mapreduce.Job: Running job: job_1521666602777_0895
18/03/27 17:49:41 INFO mapreduce.Job: Job job_1521666602777_0895 running in uber mode : false
18/03/27 17:49:41 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 17:49:52 INFO mapreduce.Job:  map 25% reduce 0%
18/03/27 17:49:53 INFO mapreduce.Job:  map 75% reduce 0%
18/03/27 17:49:58 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 17:49:59 INFO mapreduce.Job: Job job_1521666602777_0895 completed successfully
18/03/27 17:49:59 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735472
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1063
		HDFS: Number of bytes written=105438772
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=88134
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=44067
		Total vcore-milliseconds taken by all map tasks=44067
		Total megabyte-milliseconds taken by all map tasks=180498432
	Map-Reduce Framework
		Map input records=472870
		Map output records=472870
		Input split bytes=421
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=787
		CPU time spent (ms)=54590
		Physical memory (bytes) snapshot=3743621120
		Virtual memory (bytes) snapshot=22666092544
		Total committed heap usage (bytes)=7201619968
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=105438772
18/03/27 17:49:59 INFO mapreduce.ImportJobBase: Transferred 100.5542 MB in 32.3842 seconds (3.105 MB/sec)
18/03/27 17:49:59 INFO mapreduce.ImportJobBase: Retrieved 472870 records.
Sqoop Import to History Load Successful for priceon_collected_card_price .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_price_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table priceon_collected_price .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 17:50:03 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 17:50:03 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 17:50:03 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 17:50:03 INFO tool.CodeGenTool: Beginning code generation
18/03/27 17:50:03 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:50:04 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_collected_price where  (1 = 0) 
18/03/27 17:50:04 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_collected_price where  (1 = 0) 
18/03/27 17:50:04 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/fcea7d6c4dbeb7e52077c37f97d5ca3b/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 17:50:05 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/fcea7d6c4dbeb7e52077c37f97d5ca3b/QueryResult.jar
18/03/27 17:50:05 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 17:50:06 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 17:50:06 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 17:50:07 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173007212, maxDate=1522777807212, sequenceNumber=27488, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 17:50:07 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173007212, maxDate=1522777807212, sequenceNumber=27488, masterKeyId=478)
18/03/27 17:50:07 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173007560, maxDate=1522777807560, sequenceNumber=40240, masterKeyId=862)
18/03/27 17:50:07 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173007866, maxDate=1522777807866, sequenceNumber=40241, masterKeyId=863)
18/03/27 17:50:10 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:50:10 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 17:50:10 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(seq), MAX(seq) FROM (select * from dbo.priceon_collected_price where  (1 = 1) ) AS t1
18/03/27 17:50:10 INFO db.IntegerSplitter: Split size: 10736989; Num splits: 4 from: 1 to: 42947959
18/03/27 17:50:10 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 17:50:10 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0896
18/03/27 17:50:10 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173007560, maxDate=1522777807560, sequenceNumber=40240, masterKeyId=862)
18/03/27 17:50:10 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173007866, maxDate=1522777807866, sequenceNumber=40241, masterKeyId=863)
18/03/27 17:50:10 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173007212, maxDate=1522777807212, sequenceNumber=27488, masterKeyId=478)
18/03/27 17:50:10 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0896
18/03/27 17:50:10 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0896/
18/03/27 17:50:10 INFO mapreduce.Job: Running job: job_1521666602777_0896
18/03/27 17:50:26 INFO mapreduce.Job: Job job_1521666602777_0896 running in uber mode : false
18/03/27 17:50:26 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 17:52:27 INFO mapreduce.Job:  map 25% reduce 0%
18/03/27 17:52:32 INFO mapreduce.Job:  map 50% reduce 0%
18/03/27 17:52:40 INFO mapreduce.Job:  map 75% reduce 0%
18/03/27 17:52:52 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 17:52:52 INFO mapreduce.Job: Job job_1521666602777_0896 completed successfully
18/03/27 17:52:52 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735372
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1097
		HDFS: Number of bytes written=4533070082
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=1044344
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=522172
		Total vcore-milliseconds taken by all map tasks=522172
		Total megabyte-milliseconds taken by all map tasks=2138816512
	Map-Reduce Framework
		Map input records=18239730
		Map output records=18239730
		Input split bytes=434
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=2124
		CPU time spent (ms)=589010
		Physical memory (bytes) snapshot=5367656448
		Virtual memory (bytes) snapshot=22642630656
		Total committed heap usage (bytes)=7646216192
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=4533070082
18/03/27 17:52:52 INFO mapreduce.ImportJobBase: Transferred 4.2218 GB in 166.0287 seconds (26.0381 MB/sec)
18/03/27 17:52:52 INFO mapreduce.ImportJobBase: Retrieved 18239730 records.
Sqoop Import to History Load Successful for priceon_collected_price .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_piece_unit_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table priceon_piece_unit .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 17:52:57 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 17:52:57 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 17:52:57 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 17:52:57 INFO tool.CodeGenTool: Beginning code generation
18/03/27 17:52:57 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:52:57 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_piece_unit where  (1 = 0) 
18/03/27 17:52:57 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_piece_unit where  (1 = 0) 
18/03/27 17:52:57 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/701b164f4570c5a2e7fe008ed4058023/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 17:52:59 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/701b164f4570c5a2e7fe008ed4058023/QueryResult.jar
18/03/27 17:52:59 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 17:52:59 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 17:53:00 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 17:53:00 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173180429, maxDate=1522777980429, sequenceNumber=27489, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 17:53:01 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173180429, maxDate=1522777980429, sequenceNumber=27489, masterKeyId=478)
18/03/27 17:53:01 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173180898, maxDate=1522777980898, sequenceNumber=40242, masterKeyId=862)
18/03/27 17:53:01 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173181260, maxDate=1522777981260, sequenceNumber=40243, masterKeyId=863)
18/03/27 17:53:03 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:53:03 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 17:53:03 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(priceon_piece_unit_seq), MAX(priceon_piece_unit_seq) FROM (select * from dbo.priceon_piece_unit where  (1 = 1) ) AS t1
18/03/27 17:53:03 INFO db.IntegerSplitter: Split size: 970471; Num splits: 4 from: 3800171 to: 7682058
18/03/27 17:53:03 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 17:53:03 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0897
18/03/27 17:53:03 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173180898, maxDate=1522777980898, sequenceNumber=40242, masterKeyId=862)
18/03/27 17:53:03 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173181260, maxDate=1522777981260, sequenceNumber=40243, masterKeyId=863)
18/03/27 17:53:03 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173180429, maxDate=1522777980429, sequenceNumber=27489, masterKeyId=478)
18/03/27 17:53:04 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0897
18/03/27 17:53:04 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0897/
18/03/27 17:53:04 INFO mapreduce.Job: Running job: job_1521666602777_0897
18/03/27 17:53:15 INFO mapreduce.Job: Job job_1521666602777_0897 running in uber mode : false
18/03/27 17:53:15 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 17:53:28 INFO mapreduce.Job:  map 25% reduce 0%
18/03/27 17:53:32 INFO mapreduce.Job:  map 50% reduce 0%
18/03/27 17:53:33 INFO mapreduce.Job:  map 75% reduce 0%
18/03/27 17:53:36 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 17:53:36 INFO mapreduce.Job: Job job_1521666602777_0897 completed successfully
18/03/27 17:53:36 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735576
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1464
		HDFS: Number of bytes written=114710648
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=123292
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=61646
		Total vcore-milliseconds taken by all map tasks=61646
		Total megabyte-milliseconds taken by all map tasks=252502016
	Map-Reduce Framework
		Map input records=2310202
		Map output records=2310202
		Input split bytes=585
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=740
		CPU time spent (ms)=78250
		Physical memory (bytes) snapshot=5107654656
		Virtual memory (bytes) snapshot=22673051648
		Total committed heap usage (bytes)=7921991680
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=114710648
18/03/27 17:53:36 INFO mapreduce.ImportJobBase: Transferred 109.3966 MB in 36.5374 seconds (2.9941 MB/sec)
18/03/27 17:53:36 INFO mapreduce.ImportJobBase: Retrieved 2310202 records.
Sqoop Import to History Load Successful for priceon_piece_unit .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_sku_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table priceon_sku .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 17:53:40 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 17:53:40 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 17:53:40 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 17:53:40 INFO tool.CodeGenTool: Beginning code generation
18/03/27 17:53:41 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:53:41 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_sku where  (1 = 0) 
18/03/27 17:53:41 INFO manager.SqlManager: Executing SQL statement: select * from dbo.priceon_sku where  (1 = 0) 
18/03/27 17:53:41 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/faa7cfb0cb5991b8e77eea400986f6d6/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 17:53:42 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/faa7cfb0cb5991b8e77eea400986f6d6/QueryResult.jar
18/03/27 17:53:42 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 17:53:42 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 17:53:43 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 17:53:43 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173223791, maxDate=1522778023791, sequenceNumber=27490, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 17:53:44 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173223791, maxDate=1522778023791, sequenceNumber=27490, masterKeyId=478)
18/03/27 17:53:44 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173224197, maxDate=1522778024197, sequenceNumber=40244, masterKeyId=863)
18/03/27 17:53:44 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173224521, maxDate=1522778024521, sequenceNumber=40245, masterKeyId=862)
18/03/27 17:53:46 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:53:46 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 17:53:46 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(pid), MAX(pid) FROM (select * from dbo.priceon_sku where  (1 = 1) ) AS t1
18/03/27 17:53:46 INFO db.IntegerSplitter: Split size: 9820729; Num splits: 4 from: 1478686051 to: 1517968969
18/03/27 17:53:46 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 17:53:46 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0898
18/03/27 17:53:46 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173224521, maxDate=1522778024521, sequenceNumber=40245, masterKeyId=862)
18/03/27 17:53:46 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173224197, maxDate=1522778024197, sequenceNumber=40244, masterKeyId=863)
18/03/27 17:53:46 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173223791, maxDate=1522778023791, sequenceNumber=27490, masterKeyId=478)
18/03/27 17:53:47 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0898
18/03/27 17:53:47 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0898/
18/03/27 17:53:47 INFO mapreduce.Job: Running job: job_1521666602777_0898
18/03/27 17:53:57 INFO mapreduce.Job: Job job_1521666602777_0898 running in uber mode : false
18/03/27 17:53:57 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 17:54:07 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 17:54:07 INFO mapreduce.Job: Job job_1521666602777_0898 completed successfully
18/03/27 17:54:07 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735132
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1144
		HDFS: Number of bytes written=7919
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=60946
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=30473
		Total vcore-milliseconds taken by all map tasks=30473
		Total megabyte-milliseconds taken by all map tasks=124817408
	Map-Reduce Framework
		Map input records=222
		Map output records=222
		Input split bytes=457
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=510
		CPU time spent (ms)=15480
		Physical memory (bytes) snapshot=1789706240
		Virtual memory (bytes) snapshot=22602153984
		Total committed heap usage (bytes)=6142558208
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=7919
18/03/27 17:54:07 INFO mapreduce.ImportJobBase: Transferred 7.7334 KB in 24.516 seconds (323.013 bytes/sec)
18/03/27 17:54:07 INFO mapreduce.ImportJobBase: Retrieved 222 records.
Sqoop Import to History Load Successful for priceon_sku .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_attr_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table shelfon_attr .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 17:54:12 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 17:54:12 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 17:54:12 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 17:54:12 INFO tool.CodeGenTool: Beginning code generation
18/03/27 17:54:12 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:54:12 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_attr where  (1 = 0) 
18/03/27 17:54:12 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_attr where  (1 = 0) 
18/03/27 17:54:12 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/93a35f3779ec4b370450a24b4a51c7ed/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 17:54:13 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/93a35f3779ec4b370450a24b4a51c7ed/QueryResult.jar
18/03/27 17:54:13 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 17:54:14 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 17:54:14 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 17:54:15 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173255352, maxDate=1522778055352, sequenceNumber=27491, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 17:54:15 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173255352, maxDate=1522778055352, sequenceNumber=27491, masterKeyId=478)
18/03/27 17:54:15 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173255737, maxDate=1522778055737, sequenceNumber=40246, masterKeyId=862)
18/03/27 17:54:16 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173256043, maxDate=1522778056043, sequenceNumber=40247, masterKeyId=863)
18/03/27 17:54:18 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:54:18 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 17:54:18 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(shelfon_attr_seq), MAX(shelfon_attr_seq) FROM (select * from dbo.shelfon_attr where  (1 = 1) ) AS t1
18/03/27 17:54:18 INFO db.IntegerSplitter: Split size: 2790683; Num splits: 4 from: 15175897 to: 26338631
18/03/27 17:54:18 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 17:54:18 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0899
18/03/27 17:54:18 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173255737, maxDate=1522778055737, sequenceNumber=40246, masterKeyId=862)
18/03/27 17:54:18 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173256043, maxDate=1522778056043, sequenceNumber=40247, masterKeyId=863)
18/03/27 17:54:18 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173255352, maxDate=1522778055352, sequenceNumber=27491, masterKeyId=478)
18/03/27 17:54:19 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0899
18/03/27 17:54:19 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0899/
18/03/27 17:54:19 INFO mapreduce.Job: Running job: job_1521666602777_0899
18/03/27 17:54:30 INFO mapreduce.Job: Job job_1521666602777_0899 running in uber mode : false
18/03/27 17:54:30 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 17:54:49 INFO mapreduce.Job:  map 25% reduce 0%
18/03/27 17:54:52 INFO mapreduce.Job:  map 50% reduce 0%
18/03/27 17:54:57 INFO mapreduce.Job:  map 75% reduce 0%
18/03/27 17:55:01 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 17:55:02 INFO mapreduce.Job: Job job_1521666602777_0899 completed successfully
18/03/27 17:55:02 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735360
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1364
		HDFS: Number of bytes written=421503543
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=178690
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=89345
		Total vcore-milliseconds taken by all map tasks=89345
		Total megabyte-milliseconds taken by all map tasks=365957120
	Map-Reduce Framework
		Map input records=7022374
		Map output records=7022374
		Input split bytes=545
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=840
		CPU time spent (ms)=93260
		Physical memory (bytes) snapshot=4890791936
		Virtual memory (bytes) snapshot=22650220544
		Total committed heap usage (bytes)=7995392000
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=421503543
18/03/27 17:55:02 INFO mapreduce.ImportJobBase: Transferred 401.9771 MB in 47.2649 seconds (8.5048 MB/sec)
18/03/27 17:55:02 INFO mapreduce.ImportJobBase: Retrieved 7022374 records.
Sqoop Import to History Load Successful for shelfon_attr .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_category_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table shelfon_category .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 17:55:06 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 17:55:06 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 17:55:06 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 17:55:06 INFO tool.CodeGenTool: Beginning code generation
18/03/27 17:55:06 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:55:06 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_category where  (1 = 0) 
18/03/27 17:55:06 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_category where  (1 = 0) 
18/03/27 17:55:06 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/b37baac030476b126f1ee2d5fa3c387e/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 17:55:08 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/b37baac030476b126f1ee2d5fa3c387e/QueryResult.jar
18/03/27 17:55:08 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 17:55:08 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 17:55:09 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 17:55:09 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173309472, maxDate=1522778109472, sequenceNumber=27492, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 17:55:10 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173309472, maxDate=1522778109472, sequenceNumber=27492, masterKeyId=478)
18/03/27 17:55:10 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173309887, maxDate=1522778109887, sequenceNumber=40248, masterKeyId=863)
18/03/27 17:55:10 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173310199, maxDate=1522778110199, sequenceNumber=40249, masterKeyId=862)
18/03/27 17:55:12 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:55:12 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 17:55:12 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(shelfon_category_seq), MAX(shelfon_category_seq) FROM (select * from dbo.shelfon_category where  (1 = 1) ) AS t1
18/03/27 17:55:12 INFO db.IntegerSplitter: Split size: 18; Num splits: 4 from: 3920 to: 3992
18/03/27 17:55:12 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 17:55:12 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0900
18/03/27 17:55:12 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173310199, maxDate=1522778110199, sequenceNumber=40249, masterKeyId=862)
18/03/27 17:55:12 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173309887, maxDate=1522778109887, sequenceNumber=40248, masterKeyId=863)
18/03/27 17:55:12 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173309472, maxDate=1522778109472, sequenceNumber=27492, masterKeyId=478)
18/03/27 17:55:13 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0900
18/03/27 17:55:13 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0900/
18/03/27 17:55:13 INFO mapreduce.Job: Running job: job_1521666602777_0900
18/03/27 17:55:23 INFO mapreduce.Job: Job job_1521666602777_0900 running in uber mode : false
18/03/27 17:55:23 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 17:55:33 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 17:55:33 INFO mapreduce.Job: Job job_1521666602777_0900 completed successfully
18/03/27 17:55:33 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735504
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1364
		HDFS: Number of bytes written=617
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=61252
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=30626
		Total vcore-milliseconds taken by all map tasks=30626
		Total megabyte-milliseconds taken by all map tasks=125444096
	Map-Reduce Framework
		Map input records=30
		Map output records=30
		Input split bytes=545
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=644
		CPU time spent (ms)=14730
		Physical memory (bytes) snapshot=1798250496
		Virtual memory (bytes) snapshot=22610382848
		Total committed heap usage (bytes)=5956435968
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=617
18/03/27 17:55:33 INFO mapreduce.ImportJobBase: Transferred 617 bytes in 24.3605 seconds (25.3279 bytes/sec)
18/03/27 17:55:33 INFO mapreduce.ImportJobBase: Retrieved 30 records.
Sqoop Import to History Load Successful for shelfon_category .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_data_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table shelfon_collected_data .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 17:55:37 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 17:55:37 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 17:55:37 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 17:55:37 INFO tool.CodeGenTool: Beginning code generation
18/03/27 17:55:38 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:55:38 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_collected_data_STAGE where  (1 = 0) 
18/03/27 17:55:38 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_collected_data_STAGE where  (1 = 0) 
18/03/27 17:55:38 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/6d78c80a1e345ba791ce91f63de77cf2/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 17:55:39 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/6d78c80a1e345ba791ce91f63de77cf2/QueryResult.jar
18/03/27 17:55:39 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 17:55:40 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 17:55:40 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 17:55:41 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173341126, maxDate=1522778141126, sequenceNumber=27493, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 17:55:41 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173341126, maxDate=1522778141126, sequenceNumber=27493, masterKeyId=478)
18/03/27 17:55:41 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173341554, maxDate=1522778141554, sequenceNumber=40250, masterKeyId=863)
18/03/27 17:55:41 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173341903, maxDate=1522778141903, sequenceNumber=40251, masterKeyId=862)
18/03/27 17:55:43 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 17:55:43 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 17:55:43 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(shelfon_data_seq), MAX(shelfon_data_seq) FROM (select * from dbo.shelfon_collected_data_STAGE where  (1 = 1) ) AS t1
18/03/27 17:58:40 INFO db.IntegerSplitter: Split size: 23972727; Num splits: 10 from: 427434 to: 240154708
18/03/27 17:58:40 INFO mapreduce.JobSubmitter: number of splits:10
18/03/27 17:58:40 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0901
18/03/27 17:58:40 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173341903, maxDate=1522778141903, sequenceNumber=40251, masterKeyId=862)
18/03/27 17:58:40 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522173341554, maxDate=1522778141554, sequenceNumber=40250, masterKeyId=863)
18/03/27 17:58:40 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522173341126, maxDate=1522778141126, sequenceNumber=27493, masterKeyId=478)
18/03/27 17:58:41 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0901
18/03/27 17:58:41 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0901/
18/03/27 17:58:41 INFO mapreduce.Job: Running job: job_1521666602777_0901
18/03/27 17:58:51 INFO mapreduce.Job: Job job_1521666602777_0901 running in uber mode : false
18/03/27 17:58:51 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:20:32 INFO mapreduce.Job:  map 20% reduce 0%
18/03/27 18:21:30 INFO mapreduce.Job:  map 30% reduce 0%
18/03/27 18:22:10 INFO mapreduce.Job:  map 40% reduce 0%
18/03/27 18:22:11 INFO mapreduce.Job:  map 50% reduce 0%
18/03/27 18:22:39 INFO mapreduce.Job:  map 60% reduce 0%
18/03/27 18:23:09 INFO mapreduce.Job:  map 70% reduce 0%
18/03/27 18:23:56 INFO mapreduce.Job:  map 80% reduce 0%
18/03/27 18:25:16 INFO mapreduce.Job:  map 90% reduce 0%
18/03/27 18:25:39 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:25:39 INFO mapreduce.Job: Job job_1521666602777_0901 completed successfully
18/03/27 18:25:39 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=1839100
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=7573
		HDFS: Number of bytes written=65764517549
		HDFS: Number of read operations=40
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=20
	Job Counters 
		Launched map tasks=10
		Other local map tasks=10
		Total time spent by all maps in occupied slots (ms)=28634262
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=14317131
		Total vcore-milliseconds taken by all map tasks=14317131
		Total megabyte-milliseconds taken by all map tasks=58642968576
	Map-Reduce Framework
		Map input records=234577809
		Map output records=234577809
		Input split bytes=1370
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=64694
		CPU time spent (ms)=9627920
		Physical memory (bytes) snapshot=6395371520
		Virtual memory (bytes) snapshot=56546443264
		Total committed heap usage (bytes)=11960057856
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=65764517549
18/03/27 18:25:39 INFO mapreduce.ImportJobBase: Transferred 61.248 GB in 1,798.8631 seconds (34.8653 MB/sec)
18/03/27 18:25:39 INFO mapreduce.ImportJobBase: Retrieved 234577809 records.
Sqoop Import to History Load Successful for shelfon_collected_data .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_option_data_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table shelfon_collected_option_data .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:25:43 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:25:43 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:25:44 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:25:44 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:25:44 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:25:44 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_collected_option_data where  (1 = 0) 
18/03/27 18:25:44 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_collected_option_data where  (1 = 0) 
18/03/27 18:25:44 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/0501378afb55b4b68f46a6af20732237/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:25:46 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/0501378afb55b4b68f46a6af20732237/QueryResult.jar
18/03/27 18:25:46 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:25:46 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:25:47 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:25:47 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175147425, maxDate=1522779947425, sequenceNumber=27494, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:25:47 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175147425, maxDate=1522779947425, sequenceNumber=27494, masterKeyId=478)
18/03/27 18:25:47 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175147795, maxDate=1522779947795, sequenceNumber=40252, masterKeyId=862)
18/03/27 18:25:48 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175148097, maxDate=1522779948097, sequenceNumber=40253, masterKeyId=863)
18/03/27 18:25:50 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:25:50 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:25:50 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(shelfon_option_data_seq), MAX(shelfon_option_data_seq) FROM (select * from dbo.shelfon_collected_option_data where  (1 = 1) ) AS t1
18/03/27 18:25:50 INFO db.IntegerSplitter: Split size: 18366985; Num splits: 10 from: 2389336 to: 186059188
18/03/27 18:25:50 INFO mapreduce.JobSubmitter: number of splits:10
18/03/27 18:25:50 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0902
18/03/27 18:25:50 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175147795, maxDate=1522779947795, sequenceNumber=40252, masterKeyId=862)
18/03/27 18:25:50 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175148097, maxDate=1522779948097, sequenceNumber=40253, masterKeyId=863)
18/03/27 18:25:50 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175147425, maxDate=1522779947425, sequenceNumber=27494, masterKeyId=478)
18/03/27 18:25:50 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0902
18/03/27 18:25:50 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0902/
18/03/27 18:25:50 INFO mapreduce.Job: Running job: job_1521666602777_0902
18/03/27 18:26:03 INFO mapreduce.Job: Job job_1521666602777_0902 running in uber mode : false
18/03/27 18:26:03 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:26:40 INFO mapreduce.Job:  map 10% reduce 0%
18/03/27 18:26:50 INFO mapreduce.Job:  map 20% reduce 0%
18/03/27 18:27:43 INFO mapreduce.Job:  map 30% reduce 0%
18/03/27 18:29:15 INFO mapreduce.Job:  map 40% reduce 0%
18/03/27 18:29:24 INFO mapreduce.Job:  map 50% reduce 0%
18/03/27 18:29:27 INFO mapreduce.Job:  map 60% reduce 0%
18/03/27 18:29:30 INFO mapreduce.Job:  map 70% reduce 0%
18/03/27 18:29:31 INFO mapreduce.Job:  map 80% reduce 0%
18/03/27 18:29:34 INFO mapreduce.Job:  map 90% reduce 0%
18/03/27 18:29:37 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:29:37 INFO mapreduce.Job: Job job_1521666602777_0902 completed successfully
18/03/27 18:29:37 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=1839550
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=8333
		HDFS: Number of bytes written=4775121467
		HDFS: Number of read operations=40
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=20
	Job Counters 
		Launched map tasks=10
		Other local map tasks=10
		Total time spent by all maps in occupied slots (ms)=3191946
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=1595973
		Total vcore-milliseconds taken by all map tasks=1595973
		Total megabyte-milliseconds taken by all map tasks=6537105408
	Map-Reduce Framework
		Map input records=141532004
		Map output records=141532004
		Input split bytes=1509
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=7373
		CPU time spent (ms)=1759590
		Physical memory (bytes) snapshot=13425037312
		Virtual memory (bytes) snapshot=56622493696
		Total committed heap usage (bytes)=18835046400
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=4775121467
18/03/27 18:29:37 INFO mapreduce.ImportJobBase: Transferred 4.4472 GB in 230.4484 seconds (19.7611 MB/sec)
18/03/27 18:29:37 INFO mapreduce.ImportJobBase: Retrieved 141532004 records.
Sqoop Import to History Load Successful for shelfon_collected_option_data .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table shelfon_item .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:29:41 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:29:41 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:29:41 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:29:41 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:29:42 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:29:42 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_item where  (1 = 0) 
18/03/27 18:29:42 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_item where  (1 = 0) 
18/03/27 18:29:42 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/fe1e3b46c9a99f1e3524aa01acc60634/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:29:43 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/fe1e3b46c9a99f1e3524aa01acc60634/QueryResult.jar
18/03/27 18:29:43 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:29:43 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:29:44 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:29:44 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175384816, maxDate=1522780184816, sequenceNumber=27495, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:29:45 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175384816, maxDate=1522780184816, sequenceNumber=27495, masterKeyId=478)
18/03/27 18:29:45 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175385277, maxDate=1522780185277, sequenceNumber=40254, masterKeyId=862)
18/03/27 18:29:45 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175385626, maxDate=1522780185626, sequenceNumber=40255, masterKeyId=863)
18/03/27 18:29:47 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:29:47 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:29:47 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(npid), MAX(npid) FROM (select * from dbo.shelfon_item where  (1 = 1) ) AS t1
18/03/27 18:29:47 INFO db.IntegerSplitter: Split size: 45; Num splits: 4 from: 1474966336 to: 1474966518
18/03/27 18:29:47 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:29:48 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0903
18/03/27 18:29:48 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175385277, maxDate=1522780185277, sequenceNumber=40254, masterKeyId=862)
18/03/27 18:29:48 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175385626, maxDate=1522780185626, sequenceNumber=40255, masterKeyId=863)
18/03/27 18:29:48 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175384816, maxDate=1522780184816, sequenceNumber=27495, masterKeyId=478)
18/03/27 18:29:48 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0903
18/03/27 18:29:48 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0903/
18/03/27 18:29:48 INFO mapreduce.Job: Running job: job_1521666602777_0903
18/03/27 18:29:58 INFO mapreduce.Job: Job job_1521666602777_0903 running in uber mode : false
18/03/27 18:29:58 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:30:15 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:30:15 INFO mapreduce.Job: Job job_1521666602777_0903 completed successfully
18/03/27 18:30:15 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735168
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1164
		HDFS: Number of bytes written=4325
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=105922
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=52961
		Total vcore-milliseconds taken by all map tasks=52961
		Total megabyte-milliseconds taken by all map tasks=216928256
	Map-Reduce Framework
		Map input records=177
		Map output records=177
		Input split bytes=465
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=471
		CPU time spent (ms)=15460
		Physical memory (bytes) snapshot=1781071872
		Virtual memory (bytes) snapshot=22589181952
		Total committed heap usage (bytes)=6027739136
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=4325
18/03/27 18:30:15 INFO mapreduce.ImportJobBase: Transferred 4.2236 KB in 30.7103 seconds (140.8324 bytes/sec)
18/03/27 18:30:15 INFO mapreduce.ImportJobBase: Retrieved 177 records.
Sqoop Import to History Load Successful for shelfon_item .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_channel_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table shelfon_item_channel .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:30:19 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:30:19 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:30:19 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:30:19 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:30:19 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:30:19 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_item_channel where  (1 = 0) 
18/03/27 18:30:19 INFO manager.SqlManager: Executing SQL statement: select * from dbo.shelfon_item_channel where  (1 = 0) 
18/03/27 18:30:19 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/5393142d3c72ae19c6607ee0c4677ca6/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:30:21 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/5393142d3c72ae19c6607ee0c4677ca6/QueryResult.jar
18/03/27 18:30:21 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:30:21 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:30:22 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:30:22 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175422537, maxDate=1522780222537, sequenceNumber=27496, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:30:23 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175422537, maxDate=1522780222537, sequenceNumber=27496, masterKeyId=478)
18/03/27 18:30:23 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175422953, maxDate=1522780222953, sequenceNumber=40256, masterKeyId=863)
18/03/27 18:30:23 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175423252, maxDate=1522780223252, sequenceNumber=40257, masterKeyId=862)
18/03/27 18:30:25 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:30:25 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:30:25 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(ngid), MAX(ngid) FROM (select * from dbo.shelfon_item_channel where  (1 = 1) ) AS t1
18/03/27 18:30:25 WARN db.TextSplitter: Generating splits for a textual index column.
18/03/27 18:30:25 WARN db.TextSplitter: If your database sorts in a case-insensitive order, this may result in a partial import or duplicate records.
18/03/27 18:30:25 WARN db.TextSplitter: You are strongly encouraged to choose an integral split column.
18/03/27 18:30:25 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:30:25 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0904
18/03/27 18:30:25 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175423252, maxDate=1522780223252, sequenceNumber=40257, masterKeyId=862)
18/03/27 18:30:25 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175422953, maxDate=1522780222953, sequenceNumber=40256, masterKeyId=863)
18/03/27 18:30:25 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175422537, maxDate=1522780222537, sequenceNumber=27496, masterKeyId=478)
18/03/27 18:30:26 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0904
18/03/27 18:30:26 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0904/
18/03/27 18:30:26 INFO mapreduce.Job: Running job: job_1521666602777_0904
18/03/27 18:30:37 INFO mapreduce.Job: Job job_1521666602777_0904 running in uber mode : false
18/03/27 18:30:37 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:30:47 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:30:48 INFO mapreduce.Job: Job job_1521666602777_0904 completed successfully
18/03/27 18:30:48 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735328
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1274
		HDFS: Number of bytes written=57959
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=66892
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=33446
		Total vcore-milliseconds taken by all map tasks=33446
		Total megabyte-milliseconds taken by all map tasks=136994816
	Map-Reduce Framework
		Map input records=2982
		Map output records=2982
		Input split bytes=509
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=521
		CPU time spent (ms)=17100
		Physical memory (bytes) snapshot=1856929792
		Virtual memory (bytes) snapshot=22589882368
		Total committed heap usage (bytes)=6210191360
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=57959
18/03/27 18:30:48 INFO mapreduce.ImportJobBase: Transferred 56.6006 KB in 26.7565 seconds (2.1154 KB/sec)
18/03/27 18:30:48 INFO mapreduce.ImportJobBase: Retrieved 2982 records.
Sqoop Import to History Load Successful for shelfon_item_channel .
Successfully imported the builton data
Starting sqoop Import process for CSV tables.
Initiating authentication
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_attentive_sku_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_attentive_sku .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:30:53 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:30:53 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:30:53 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:30:53 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:30:53 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:30:53 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_attentive_sku where  (1 = 0) 
18/03/27 18:30:53 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_attentive_sku where  (1 = 0) 
18/03/27 18:30:53 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/7d0ee69cf784e97a0e79bee8907e350b/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:30:54 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/7d0ee69cf784e97a0e79bee8907e350b/QueryResult.jar
18/03/27 18:30:54 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:30:55 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:30:55 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:30:56 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175456270, maxDate=1522780256270, sequenceNumber=27497, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:30:56 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175456270, maxDate=1522780256270, sequenceNumber=27497, masterKeyId=478)
18/03/27 18:30:56 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175456646, maxDate=1522780256646, sequenceNumber=40258, masterKeyId=862)
18/03/27 18:30:56 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175456953, maxDate=1522780256953, sequenceNumber=40259, masterKeyId=863)
18/03/27 18:30:59 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:30:59 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:30:59 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(seq), MAX(seq) FROM (select * from dbo.tb_attentive_sku where  (1 = 1) ) AS t1
18/03/27 18:30:59 INFO db.IntegerSplitter: Split size: 157; Num splits: 4 from: 1091 to: 1722
18/03/27 18:30:59 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:30:59 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0905
18/03/27 18:30:59 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175456646, maxDate=1522780256646, sequenceNumber=40258, masterKeyId=862)
18/03/27 18:30:59 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175456953, maxDate=1522780256953, sequenceNumber=40259, masterKeyId=863)
18/03/27 18:30:59 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175456270, maxDate=1522780256270, sequenceNumber=27497, masterKeyId=478)
18/03/27 18:30:59 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0905
18/03/27 18:30:59 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0905/
18/03/27 18:30:59 INFO mapreduce.Job: Running job: job_1521666602777_0905
18/03/27 18:31:10 INFO mapreduce.Job: Job job_1521666602777_0905 running in uber mode : false
18/03/27 18:31:10 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:31:20 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:31:21 INFO mapreduce.Job: Job job_1521666602777_0905 completed successfully
18/03/27 18:31:21 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735236
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1024
		HDFS: Number of bytes written=4033
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=62626
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=31313
		Total vcore-milliseconds taken by all map tasks=31313
		Total megabyte-milliseconds taken by all map tasks=128258048
	Map-Reduce Framework
		Map input records=240
		Map output records=240
		Input split bytes=409
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=462
		CPU time spent (ms)=15420
		Physical memory (bytes) snapshot=1794441216
		Virtual memory (bytes) snapshot=22623940608
		Total committed heap usage (bytes)=6085410816
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=4033
18/03/27 18:31:21 INFO mapreduce.ImportJobBase: Transferred 3.9385 KB in 25.3594 seconds (159.0335 bytes/sec)
18/03/27 18:31:21 INFO mapreduce.ImportJobBase: Retrieved 240 records.
Sqoop Import to History Load Successful for tb_attentive_sku .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_d_list_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_online_dpsm_d_list .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:31:25 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:31:25 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:31:25 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:31:25 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:31:25 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:31:25 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_d_list where  (1 = 0) 
18/03/27 18:31:25 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_d_list where  (1 = 0) 
18/03/27 18:31:25 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/6bd76d25ef238666a13d71eb9dd1ab7f/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:31:27 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/6bd76d25ef238666a13d71eb9dd1ab7f/QueryResult.jar
18/03/27 18:31:27 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:31:27 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:31:28 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:31:28 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175488841, maxDate=1522780288841, sequenceNumber=27499, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:31:29 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175488841, maxDate=1522780288841, sequenceNumber=27499, masterKeyId=478)
18/03/27 18:31:29 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175489251, maxDate=1522780289251, sequenceNumber=40261, masterKeyId=863)
18/03/27 18:31:29 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175489585, maxDate=1522780289585, sequenceNumber=40262, masterKeyId=862)
18/03/27 18:31:31 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:31:31 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:31:31 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(sku_cd), MAX(sku_cd) FROM (select * from dbo.tb_online_dpsm_d_list where  (1 = 1) ) AS t1
18/03/27 18:31:31 INFO db.IntegerSplitter: Split size: 4571; Num splits: 4 from: 11011348 to: 11029634
18/03/27 18:31:31 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:31:31 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0907
18/03/27 18:31:31 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175489585, maxDate=1522780289585, sequenceNumber=40262, masterKeyId=862)
18/03/27 18:31:31 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175489251, maxDate=1522780289251, sequenceNumber=40261, masterKeyId=863)
18/03/27 18:31:31 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175488841, maxDate=1522780288841, sequenceNumber=27499, masterKeyId=478)
18/03/27 18:31:32 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0907
18/03/27 18:31:32 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0907/
18/03/27 18:31:32 INFO mapreduce.Job: Running job: job_1521666602777_0907
18/03/27 18:31:42 INFO mapreduce.Job: Job job_1521666602777_0907 running in uber mode : false
18/03/27 18:31:42 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:31:52 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:31:52 INFO mapreduce.Job: Job job_1521666602777_0907 completed successfully
18/03/27 18:31:52 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735384
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1164
		HDFS: Number of bytes written=3511
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=60318
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=30159
		Total vcore-milliseconds taken by all map tasks=30159
		Total megabyte-milliseconds taken by all map tasks=123531264
	Map-Reduce Framework
		Map input records=341
		Map output records=341
		Input split bytes=465
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=485
		CPU time spent (ms)=15530
		Physical memory (bytes) snapshot=1820950528
		Virtual memory (bytes) snapshot=22599925760
		Total committed heap usage (bytes)=6140985344
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=3511
18/03/27 18:31:52 INFO mapreduce.ImportJobBase: Transferred 3.4287 KB in 24.3164 seconds (144.3883 bytes/sec)
18/03/27 18:31:52 INFO mapreduce.ImportJobBase: Retrieved 341 records.
Sqoop Import to History Load Successful for tb_online_dpsm_d_list .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_m_list_new_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_online_dpsm_m_list_new .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:31:56 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:31:56 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:31:56 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:31:56 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:31:57 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:31:57 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_m_list_new where  (1 = 0) 
18/03/27 18:31:57 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_m_list_new where  (1 = 0) 
18/03/27 18:31:57 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/2bf545b7b1a024bc4fee4c524bbdf5ea/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:31:58 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/2bf545b7b1a024bc4fee4c524bbdf5ea/QueryResult.jar
18/03/27 18:31:58 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:31:59 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:31:59 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:32:00 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175520218, maxDate=1522780320218, sequenceNumber=27500, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:32:00 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175520218, maxDate=1522780320218, sequenceNumber=27500, masterKeyId=478)
18/03/27 18:32:00 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175520555, maxDate=1522780320555, sequenceNumber=40263, masterKeyId=862)
18/03/27 18:32:00 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175520851, maxDate=1522780320851, sequenceNumber=40264, masterKeyId=863)
18/03/27 18:32:02 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:32:02 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:32:02 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(shelfon_category_seq), MAX(shelfon_category_seq) FROM (select * from dbo.tb_online_dpsm_m_list_new where  (1 = 1) ) AS t1
18/03/27 18:32:02 INFO db.IntegerSplitter: Split size: 17; Num splits: 4 from: 3921 to: 3992
18/03/27 18:32:03 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:32:03 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0908
18/03/27 18:32:03 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175520555, maxDate=1522780320555, sequenceNumber=40263, masterKeyId=862)
18/03/27 18:32:03 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175520851, maxDate=1522780320851, sequenceNumber=40264, masterKeyId=863)
18/03/27 18:32:03 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175520218, maxDate=1522780320218, sequenceNumber=27500, masterKeyId=478)
18/03/27 18:32:03 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0908
18/03/27 18:32:03 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0908/
18/03/27 18:32:03 INFO mapreduce.Job: Running job: job_1521666602777_0908
18/03/27 18:32:13 INFO mapreduce.Job: Job job_1521666602777_0908 running in uber mode : false
18/03/27 18:32:13 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:32:23 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:32:24 INFO mapreduce.Job: Job job_1521666602777_0908 completed successfully
18/03/27 18:32:25 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735688
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1364
		HDFS: Number of bytes written=3060
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=62082
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=31041
		Total vcore-milliseconds taken by all map tasks=31041
		Total megabyte-milliseconds taken by all map tasks=127143936
	Map-Reduce Framework
		Map input records=264
		Map output records=264
		Input split bytes=545
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=464
		CPU time spent (ms)=15470
		Physical memory (bytes) snapshot=1813532672
		Virtual memory (bytes) snapshot=22621622272
		Total committed heap usage (bytes)=6067585024
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=3060
18/03/27 18:32:25 INFO mapreduce.ImportJobBase: Transferred 2.9883 KB in 25.2559 seconds (121.1598 bytes/sec)
18/03/27 18:32:25 INFO mapreduce.ImportJobBase: Retrieved 264 records.
Sqoop Import to History Load Successful for tb_online_dpsm_m_list_new .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_p_list_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_online_dpsm_p_list .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:32:29 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:32:29 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:32:29 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:32:29 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:32:29 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:32:29 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_p_list where  (1 = 0) 
18/03/27 18:32:29 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_p_list where  (1 = 0) 
18/03/27 18:32:29 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/7f471b3a71e002066605bdc52a029698/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:32:31 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/7f471b3a71e002066605bdc52a029698/QueryResult.jar
18/03/27 18:32:31 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:32:31 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:32:32 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:32:32 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175552705, maxDate=1522780352705, sequenceNumber=27502, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:32:33 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175552705, maxDate=1522780352705, sequenceNumber=27502, masterKeyId=478)
18/03/27 18:32:33 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175553088, maxDate=1522780353088, sequenceNumber=40266, masterKeyId=862)
18/03/27 18:32:33 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175553408, maxDate=1522780353408, sequenceNumber=40267, masterKeyId=863)
18/03/27 18:32:35 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:32:35 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:32:35 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(mapped_sku_cd), MAX(mapped_sku_cd) FROM (select * from dbo.tb_online_dpsm_p_list where  (1 = 1) ) AS t1
18/03/27 18:32:35 INFO db.IntegerSplitter: Split size: 4208; Num splits: 4 from: 11012698 to: 11029530
18/03/27 18:32:35 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:32:35 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0910
18/03/27 18:32:35 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175553088, maxDate=1522780353088, sequenceNumber=40266, masterKeyId=862)
18/03/27 18:32:35 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175553408, maxDate=1522780353408, sequenceNumber=40267, masterKeyId=863)
18/03/27 18:32:35 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175552705, maxDate=1522780352705, sequenceNumber=27502, masterKeyId=478)
18/03/27 18:32:36 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0910
18/03/27 18:32:36 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0910/
18/03/27 18:32:36 INFO mapreduce.Job: Running job: job_1521666602777_0910
18/03/27 18:32:46 INFO mapreduce.Job: Job job_1521666602777_0910 running in uber mode : false
18/03/27 18:32:46 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:32:56 INFO mapreduce.Job:  map 50% reduce 0%
18/03/27 18:32:57 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:32:57 INFO mapreduce.Job: Job job_1521666602777_0910 completed successfully
18/03/27 18:32:57 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735496
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1304
		HDFS: Number of bytes written=2356
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=67246
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=33623
		Total vcore-milliseconds taken by all map tasks=33623
		Total megabyte-milliseconds taken by all map tasks=137719808
	Map-Reduce Framework
		Map input records=161
		Map output records=161
		Input split bytes=521
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=484
		CPU time spent (ms)=15270
		Physical memory (bytes) snapshot=1791176704
		Virtual memory (bytes) snapshot=22610976768
		Total committed heap usage (bytes)=6144655360
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=2356
18/03/27 18:32:57 INFO mapreduce.ImportJobBase: Transferred 2.3008 KB in 25.357 seconds (92.9133 bytes/sec)
18/03/27 18:32:57 INFO mapreduce.ImportJobBase: Retrieved 161 records.
Sqoop Import to History Load Successful for tb_online_dpsm_p_list .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_s_list_new_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_online_dpsm_s_list_new .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:33:01 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:33:01 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:33:01 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:33:01 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:33:02 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:33:02 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_s_list_new where  (1 = 0) 
18/03/27 18:33:02 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_s_list_new where  (1 = 0) 
18/03/27 18:33:02 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/86819b8f2f34b1ddee4b4c1998874e57/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:33:03 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/86819b8f2f34b1ddee4b4c1998874e57/QueryResult.jar
18/03/27 18:33:03 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:33:03 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:33:04 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:33:04 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175584892, maxDate=1522780384892, sequenceNumber=27503, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:33:05 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175584892, maxDate=1522780384892, sequenceNumber=27503, masterKeyId=478)
18/03/27 18:33:05 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175585235, maxDate=1522780385235, sequenceNumber=40268, masterKeyId=862)
18/03/27 18:33:05 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175585531, maxDate=1522780385531, sequenceNumber=40269, masterKeyId=863)
18/03/27 18:33:07 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:33:07 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:33:07 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(shelfon_category_seq), MAX(shelfon_category_seq) FROM (select * from dbo.tb_online_dpsm_s_list_new where  (1 = 1) ) AS t1
18/03/27 18:33:07 INFO db.IntegerSplitter: Split size: 4; Num splits: 4 from: 3923 to: 3939
18/03/27 18:33:07 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:33:07 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0911
18/03/27 18:33:07 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175585235, maxDate=1522780385235, sequenceNumber=40268, masterKeyId=862)
18/03/27 18:33:07 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175585531, maxDate=1522780385531, sequenceNumber=40269, masterKeyId=863)
18/03/27 18:33:07 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175584892, maxDate=1522780384892, sequenceNumber=27503, masterKeyId=478)
18/03/27 18:33:08 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0911
18/03/27 18:33:08 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0911/
18/03/27 18:33:08 INFO mapreduce.Job: Running job: job_1521666602777_0911
18/03/27 18:33:18 INFO mapreduce.Job: Job job_1521666602777_0911 running in uber mode : false
18/03/27 18:33:18 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:33:31 INFO mapreduce.Job:  map 75% reduce 0%
18/03/27 18:33:32 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:33:32 INFO mapreduce.Job: Job job_1521666602777_0911 completed successfully
18/03/27 18:33:32 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735688
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1364
		HDFS: Number of bytes written=730
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=90936
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=45468
		Total vcore-milliseconds taken by all map tasks=45468
		Total megabyte-milliseconds taken by all map tasks=186236928
	Map-Reduce Framework
		Map input records=33
		Map output records=33
		Input split bytes=545
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=421
		CPU time spent (ms)=15140
		Physical memory (bytes) snapshot=1781919744
		Virtual memory (bytes) snapshot=22602186752
		Total committed heap usage (bytes)=6189744128
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=730
18/03/27 18:33:32 INFO mapreduce.ImportJobBase: Transferred 730 bytes in 28.3219 seconds (25.7751 bytes/sec)
18/03/27 18:33:32 INFO mapreduce.ImportJobBase: Retrieved 33 records.
Sqoop Import to History Load Successful for tb_online_dpsm_s_list_new .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_penetration_list_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_penetration_list .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:33:37 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:33:37 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:33:37 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:33:37 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:33:37 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:33:37 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_penetration_list where  (1 = 0) 
18/03/27 18:33:37 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_penetration_list where  (1 = 0) 
18/03/27 18:33:37 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/66445ddb82dea19aa61802f32bdc8e63/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:33:38 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/66445ddb82dea19aa61802f32bdc8e63/QueryResult.jar
18/03/27 18:33:38 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:33:39 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:33:39 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:33:40 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175620277, maxDate=1522780420277, sequenceNumber=27504, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:33:40 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175620277, maxDate=1522780420277, sequenceNumber=27504, masterKeyId=478)
18/03/27 18:33:40 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175620681, maxDate=1522780420681, sequenceNumber=40270, masterKeyId=862)
18/03/27 18:33:40 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175620975, maxDate=1522780420975, sequenceNumber=40271, masterKeyId=863)
18/03/27 18:33:43 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:33:43 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:33:43 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(sku_cd), MAX(sku_cd) FROM (select * from dbo.tb_penetration_list where  (1 = 1) ) AS t1
18/03/27 18:33:43 INFO db.IntegerSplitter: Split size: 4805; Num splits: 4 from: 11010660 to: 11029883
18/03/27 18:33:43 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:33:43 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0912
18/03/27 18:33:43 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175620681, maxDate=1522780420681, sequenceNumber=40270, masterKeyId=862)
18/03/27 18:33:43 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175620975, maxDate=1522780420975, sequenceNumber=40271, masterKeyId=863)
18/03/27 18:33:43 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175620277, maxDate=1522780420277, sequenceNumber=27504, masterKeyId=478)
18/03/27 18:33:43 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0912
18/03/27 18:33:43 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0912/
18/03/27 18:33:43 INFO mapreduce.Job: Running job: job_1521666602777_0912
18/03/27 18:33:54 INFO mapreduce.Job: Job job_1521666602777_0912 running in uber mode : false
18/03/27 18:33:54 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:34:04 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:34:05 INFO mapreduce.Job: Job job_1521666602777_0912 completed successfully
18/03/27 18:34:05 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735344
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1164
		HDFS: Number of bytes written=15993
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=61916
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=30958
		Total vcore-milliseconds taken by all map tasks=30958
		Total megabyte-milliseconds taken by all map tasks=126803968
	Map-Reduce Framework
		Map input records=1542
		Map output records=1542
		Input split bytes=465
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=345
		CPU time spent (ms)=16670
		Physical memory (bytes) snapshot=1845153792
		Virtual memory (bytes) snapshot=22603599872
		Total committed heap usage (bytes)=6085410816
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=15993
18/03/27 18:34:05 INFO mapreduce.ImportJobBase: Transferred 15.6182 KB in 25.4524 seconds (628.3495 bytes/sec)
18/03/27 18:34:05 INFO mapreduce.ImportJobBase: Retrieved 1542 records.
Sqoop Import to History Load Successful for tb_penetration_list .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_sku_master_raw/ingestion_date=19990101 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_sku_master .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:34:09 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:34:09 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:34:09 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:34:09 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:34:09 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:34:09 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_sku_master where  (1 = 0) 
18/03/27 18:34:09 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_sku_master where  (1 = 0) 
18/03/27 18:34:10 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/b7e79652f767f1925880b92bc1310ed3/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:34:11 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/b7e79652f767f1925880b92bc1310ed3/QueryResult.jar
18/03/27 18:34:11 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:34:11 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:34:12 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:34:12 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175652965, maxDate=1522780452965, sequenceNumber=27505, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:34:13 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175652965, maxDate=1522780452965, sequenceNumber=27505, masterKeyId=478)
18/03/27 18:34:13 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175653386, maxDate=1522780453386, sequenceNumber=40272, masterKeyId=862)
18/03/27 18:34:13 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175653736, maxDate=1522780453736, sequenceNumber=40273, masterKeyId=863)
18/03/27 18:34:15 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:34:15 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:34:15 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(sku_cd), MAX(sku_cd) FROM (select * from dbo.tb_sku_master where  (1 = 1) ) AS t1
18/03/27 18:34:15 INFO db.IntegerSplitter: Split size: 2202351325344; Num splits: 4 from: 11000155 to: 8809416301532
18/03/27 18:34:15 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:34:16 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0913
18/03/27 18:34:16 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175653386, maxDate=1522780453386, sequenceNumber=40272, masterKeyId=862)
18/03/27 18:34:16 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175653736, maxDate=1522780453736, sequenceNumber=40273, masterKeyId=863)
18/03/27 18:34:16 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175652965, maxDate=1522780452965, sequenceNumber=27505, masterKeyId=478)
18/03/27 18:34:16 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0913
18/03/27 18:34:16 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0913/
18/03/27 18:34:16 INFO mapreduce.Job: Running job: job_1521666602777_0913
18/03/27 18:34:26 INFO mapreduce.Job: Job job_1521666602777_0913 running in uber mode : false
18/03/27 18:34:26 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:34:36 INFO mapreduce.Job:  map 75% reduce 0%
18/03/27 18:34:37 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:34:37 INFO mapreduce.Job: Job job_1521666602777_0913 completed successfully
18/03/27 18:34:38 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735224
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1259
		HDFS: Number of bytes written=455989
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=62312
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=31156
		Total vcore-milliseconds taken by all map tasks=31156
		Total megabyte-milliseconds taken by all map tasks=127614976
	Map-Reduce Framework
		Map input records=7065
		Map output records=7065
		Input split bytes=500
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=454
		CPU time spent (ms)=18510
		Physical memory (bytes) snapshot=1954742272
		Virtual memory (bytes) snapshot=22600212480
		Total committed heap usage (bytes)=6070730752
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=455989
18/03/27 18:34:38 INFO mapreduce.ImportJobBase: Transferred 445.3018 KB in 25.4111 seconds (17.5239 KB/sec)
18/03/27 18:34:38 INFO mapreduce.ImportJobBase: Retrieved 7065 records.
Sqoop Import to History Load Successful for tb_sku_master .
Successfully imported the CSV data
Starting sqoop Import process for Derived tables.
Initiating authentication
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_category_brand_report 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_category_brand_report .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:34:42 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:34:42 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:34:42 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:34:42 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:34:42 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:34:42 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_category_brand_report where  (1 = 0) 
18/03/27 18:34:42 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_category_brand_report where  (1 = 0) 
18/03/27 18:34:42 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/95505c848dc05a4a5635e4f8181eec9e/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:34:44 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/95505c848dc05a4a5635e4f8181eec9e/QueryResult.jar
18/03/27 18:34:44 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:34:44 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:34:45 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:34:45 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175685503, maxDate=1522780485503, sequenceNumber=27506, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:34:46 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175685503, maxDate=1522780485503, sequenceNumber=27506, masterKeyId=478)
18/03/27 18:34:46 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175685840, maxDate=1522780485840, sequenceNumber=40274, masterKeyId=863)
18/03/27 18:34:46 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175686211, maxDate=1522780486211, sequenceNumber=40275, masterKeyId=862)
18/03/27 18:34:48 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:34:48 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:34:48 INFO mapreduce.JobSubmitter: number of splits:1
18/03/27 18:34:48 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0914
18/03/27 18:34:48 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175686211, maxDate=1522780486211, sequenceNumber=40275, masterKeyId=862)
18/03/27 18:34:48 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175685840, maxDate=1522780485840, sequenceNumber=40274, masterKeyId=863)
18/03/27 18:34:48 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175685503, maxDate=1522780485503, sequenceNumber=27506, masterKeyId=478)
18/03/27 18:34:49 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0914
18/03/27 18:34:49 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0914/
18/03/27 18:34:49 INFO mapreduce.Job: Running job: job_1521666602777_0914
18/03/27 18:34:59 INFO mapreduce.Job: Job job_1521666602777_0914 running in uber mode : false
18/03/27 18:34:59 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:35:10 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:35:10 INFO mapreduce.Job: Job job_1521666602777_0914 completed successfully
18/03/27 18:35:10 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=183559
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=87
		HDFS: Number of bytes written=5764117
		HDFS: Number of read operations=4
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=2
	Job Counters 
		Launched map tasks=1
		Other local map tasks=1
		Total time spent by all maps in occupied slots (ms)=16854
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=8427
		Total vcore-milliseconds taken by all map tasks=8427
		Total megabyte-milliseconds taken by all map tasks=34516992
	Map-Reduce Framework
		Map input records=319490
		Map output records=319490
		Input split bytes=87
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=119
		CPU time spent (ms)=9690
		Physical memory (bytes) snapshot=998789120
		Virtual memory (bytes) snapshot=5656358912
		Total committed heap usage (bytes)=1795686400
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=5764117
18/03/27 18:35:10 INFO mapreduce.ImportJobBase: Transferred 5.4971 MB in 25.6233 seconds (219.6838 KB/sec)
18/03/27 18:35:10 INFO mapreduce.ImportJobBase: Retrieved 319490 records.
Sqoop Import to History Load Successful for tb_category_brand_report .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_category_brand_report_new 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_category_brand_report_new .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:35:14 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:35:14 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:35:15 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:35:15 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:35:15 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:35:15 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_category_brand_report_new where  (1 = 0) 
18/03/27 18:35:15 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_category_brand_report_new where  (1 = 0) 
18/03/27 18:35:15 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/049fdcd0dce96d84c1af7c95c33f7e9d/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:35:16 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/049fdcd0dce96d84c1af7c95c33f7e9d/QueryResult.jar
18/03/27 18:35:16 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:35:17 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:35:17 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:35:18 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175718260, maxDate=1522780518260, sequenceNumber=27507, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:35:18 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175718260, maxDate=1522780518260, sequenceNumber=27507, masterKeyId=478)
18/03/27 18:35:18 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175718627, maxDate=1522780518627, sequenceNumber=40276, masterKeyId=863)
18/03/27 18:35:18 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175718928, maxDate=1522780518928, sequenceNumber=40277, masterKeyId=862)
18/03/27 18:35:21 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:35:21 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:35:21 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(its_row_count), MAX(its_row_count) FROM (select * from dbo.tb_category_brand_report_new where  (1 = 1) ) AS t1
18/03/27 18:35:21 INFO db.IntegerSplitter: Split size: 43; Num splits: 4 from: 1 to: 175
18/03/27 18:35:21 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:35:21 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0915
18/03/27 18:35:21 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175718928, maxDate=1522780518928, sequenceNumber=40277, masterKeyId=862)
18/03/27 18:35:21 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175718627, maxDate=1522780518627, sequenceNumber=40276, masterKeyId=863)
18/03/27 18:35:21 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175718260, maxDate=1522780518260, sequenceNumber=27507, masterKeyId=478)
18/03/27 18:35:22 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0915
18/03/27 18:35:22 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0915/
18/03/27 18:35:22 INFO mapreduce.Job: Running job: job_1521666602777_0915
18/03/27 18:35:32 INFO mapreduce.Job: Job job_1521666602777_0915 running in uber mode : false
18/03/27 18:35:32 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:35:43 INFO mapreduce.Job:  map 75% reduce 0%
18/03/27 18:35:49 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:35:50 INFO mapreduce.Job: Job job_1521666602777_0915 completed successfully
18/03/27 18:35:50 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735408
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1194
		HDFS: Number of bytes written=19646213
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=78608
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=39304
		Total vcore-milliseconds taken by all map tasks=39304
		Total megabyte-milliseconds taken by all map tasks=160989184
	Map-Reduce Framework
		Map input records=1147310
		Map output records=1147310
		Input split bytes=475
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=559
		CPU time spent (ms)=38080
		Physical memory (bytes) snapshot=2696622080
		Virtual memory (bytes) snapshot=22624555008
		Total committed heap usage (bytes)=6596067328
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=19646213
18/03/27 18:35:50 INFO mapreduce.ImportJobBase: Transferred 18.7361 MB in 32.9724 seconds (581.8729 KB/sec)
18/03/27 18:35:50 INFO mapreduce.ImportJobBase: Retrieved 1147310 records.
Sqoop Import to History Load Successful for tb_category_brand_report_new .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_category_mnft_report 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_category_mnft_report .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:35:55 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:35:55 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:35:55 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:35:55 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:35:55 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:35:55 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_category_mnft_report where  (1 = 0) 
18/03/27 18:35:55 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_category_mnft_report where  (1 = 0) 
18/03/27 18:35:55 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/589fda0659426764d354f19e226e5376/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:35:56 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/589fda0659426764d354f19e226e5376/QueryResult.jar
18/03/27 18:35:56 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:35:57 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:35:57 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:35:58 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175758266, maxDate=1522780558266, sequenceNumber=27509, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:35:58 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175758266, maxDate=1522780558266, sequenceNumber=27509, masterKeyId=478)
18/03/27 18:35:58 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175758602, maxDate=1522780558602, sequenceNumber=40279, masterKeyId=862)
18/03/27 18:35:58 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175758902, maxDate=1522780558902, sequenceNumber=40280, masterKeyId=863)
18/03/27 18:36:01 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:36:01 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:36:01 INFO mapreduce.JobSubmitter: number of splits:1
18/03/27 18:36:01 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0917
18/03/27 18:36:01 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175758602, maxDate=1522780558602, sequenceNumber=40279, masterKeyId=862)
18/03/27 18:36:01 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175758902, maxDate=1522780558902, sequenceNumber=40280, masterKeyId=863)
18/03/27 18:36:01 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175758266, maxDate=1522780558266, sequenceNumber=27509, masterKeyId=478)
18/03/27 18:36:01 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0917
18/03/27 18:36:01 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0917/
18/03/27 18:36:01 INFO mapreduce.Job: Running job: job_1521666602777_0917
18/03/27 18:36:12 INFO mapreduce.Job: Job job_1521666602777_0917 running in uber mode : false
18/03/27 18:36:12 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:36:23 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:36:23 INFO mapreduce.Job: Job job_1521666602777_0917 completed successfully
18/03/27 18:36:23 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=183555
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=87
		HDFS: Number of bytes written=4868000
		HDFS: Number of read operations=4
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=2
	Job Counters 
		Launched map tasks=1
		Other local map tasks=1
		Total time spent by all maps in occupied slots (ms)=16800
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=8400
		Total vcore-milliseconds taken by all map tasks=8400
		Total megabyte-milliseconds taken by all map tasks=34406400
	Map-Reduce Framework
		Map input records=255990
		Map output records=255990
		Input split bytes=87
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=117
		CPU time spent (ms)=10050
		Physical memory (bytes) snapshot=904183808
		Virtual memory (bytes) snapshot=5655678976
		Total committed heap usage (bytes)=1798832128
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=4868000
18/03/27 18:36:23 INFO mapreduce.ImportJobBase: Transferred 4.6425 MB in 25.345 seconds (187.568 KB/sec)
18/03/27 18:36:23 INFO mapreduce.ImportJobBase: Retrieved 255990 records.
Sqoop Import to History Load Successful for tb_category_mnft_report .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_category_mnft_report_new 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_category_mnft_report_new .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:36:27 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:36:27 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:36:27 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:36:27 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:36:27 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:36:27 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_category_mnft_report_new where  (1 = 0) 
18/03/27 18:36:27 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_category_mnft_report_new where  (1 = 0) 
18/03/27 18:36:27 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/b1e1b98c6a145e9bd6d74afb8e2d9afe/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:36:29 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/b1e1b98c6a145e9bd6d74afb8e2d9afe/QueryResult.jar
18/03/27 18:36:29 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:36:29 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:36:30 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:36:30 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175790587, maxDate=1522780590587, sequenceNumber=27510, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:36:31 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175790587, maxDate=1522780590587, sequenceNumber=27510, masterKeyId=478)
18/03/27 18:36:31 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175791008, maxDate=1522780591008, sequenceNumber=40281, masterKeyId=862)
18/03/27 18:36:31 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175791316, maxDate=1522780591316, sequenceNumber=40282, masterKeyId=863)
18/03/27 18:36:33 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:36:33 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:36:33 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(its_row_count), MAX(its_row_count) FROM (select * from dbo.tb_category_mnft_report_new where  (1 = 1) ) AS t1
18/03/27 18:36:33 INFO db.IntegerSplitter: Split size: 45; Num splits: 4 from: 1 to: 182
18/03/27 18:36:33 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:36:33 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0918
18/03/27 18:36:33 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175791008, maxDate=1522780591008, sequenceNumber=40281, masterKeyId=862)
18/03/27 18:36:33 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175791316, maxDate=1522780591316, sequenceNumber=40282, masterKeyId=863)
18/03/27 18:36:33 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175790587, maxDate=1522780590587, sequenceNumber=27510, masterKeyId=478)
18/03/27 18:36:34 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0918
18/03/27 18:36:34 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0918/
18/03/27 18:36:34 INFO mapreduce.Job: Running job: job_1521666602777_0918
18/03/27 18:36:44 INFO mapreduce.Job: Job job_1521666602777_0918 running in uber mode : false
18/03/27 18:36:44 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:36:54 INFO mapreduce.Job:  map 75% reduce 0%
18/03/27 18:37:00 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:37:00 INFO mapreduce.Job: Job job_1521666602777_0918 completed successfully
18/03/27 18:37:00 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735388
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1194
		HDFS: Number of bytes written=15934898
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=72694
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=36347
		Total vcore-milliseconds taken by all map tasks=36347
		Total megabyte-milliseconds taken by all map tasks=148877312
	Map-Reduce Framework
		Map input records=881239
		Map output records=881239
		Input split bytes=475
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=561
		CPU time spent (ms)=33620
		Physical memory (bytes) snapshot=2658926592
		Virtual memory (bytes) snapshot=22616969216
		Total committed heap usage (bytes)=6416760832
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=15934898
18/03/27 18:37:00 INFO mapreduce.ImportJobBase: Transferred 15.1967 MB in 30.5211 seconds (509.8586 KB/sec)
18/03/27 18:37:00 INFO mapreduce.ImportJobBase: Retrieved 881239 records.
Sqoop Import to History Load Successful for tb_category_mnft_report_new .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_d_report 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_online_dpsm_d_report .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:37:04 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:37:04 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:37:04 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:37:04 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:37:05 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:37:05 INFO manager.SqlManager: Executing SQL statement: select year ,month ,classification ,biz_category ,vlt ,product_category_cd ,brand_cd ,sub_brand_cd ,product_name ,
sku_cd ,site ,
case 
when actual='true' then 1
when actual='false' then 0 end as actual,
target ,reg_date 
from dbo.tb_online_dpsm_d_report where  (1 = 0) 
18/03/27 18:37:05 INFO manager.SqlManager: Executing SQL statement: select year ,month ,classification ,biz_category ,vlt ,product_category_cd ,brand_cd ,sub_brand_cd ,product_name ,
sku_cd ,site ,
case 
when actual='true' then 1
when actual='false' then 0 end as actual,
target ,reg_date 
from dbo.tb_online_dpsm_d_report where  (1 = 0) 
18/03/27 18:37:05 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/347cba44ce32bbdc442df744a511b2bb/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:37:06 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/347cba44ce32bbdc442df744a511b2bb/QueryResult.jar
18/03/27 18:37:06 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:37:07 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:37:07 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:37:08 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175828145, maxDate=1522780628145, sequenceNumber=27511, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:37:08 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175828145, maxDate=1522780628145, sequenceNumber=27511, masterKeyId=478)
18/03/27 18:37:08 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175828585, maxDate=1522780628585, sequenceNumber=40283, masterKeyId=863)
18/03/27 18:37:08 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175828922, maxDate=1522780628922, sequenceNumber=40284, masterKeyId=862)
18/03/27 18:37:11 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:37:11 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:37:11 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(sku_cd), MAX(sku_cd) FROM (select year ,month ,classification ,biz_category ,vlt ,product_category_cd ,brand_cd ,sub_brand_cd ,product_name ,
sku_cd ,site ,
case 
when actual='true' then 1
when actual='false' then 0 end as actual,
target ,reg_date 
from dbo.tb_online_dpsm_d_report where  (1 = 1) ) AS t1
18/03/27 18:37:11 INFO db.IntegerSplitter: Split size: 4571; Num splits: 4 from: 11011348 to: 11029634
18/03/27 18:37:11 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:37:11 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0919
18/03/27 18:37:11 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175828922, maxDate=1522780628922, sequenceNumber=40284, masterKeyId=862)
18/03/27 18:37:11 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175828585, maxDate=1522780628585, sequenceNumber=40283, masterKeyId=863)
18/03/27 18:37:11 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175828145, maxDate=1522780628145, sequenceNumber=27511, masterKeyId=478)
18/03/27 18:37:11 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0919
18/03/27 18:37:12 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0919/
18/03/27 18:37:12 INFO mapreduce.Job: Running job: job_1521666602777_0919
18/03/27 18:37:22 INFO mapreduce.Job: Job job_1521666602777_0919 running in uber mode : false
18/03/27 18:37:22 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:37:32 INFO mapreduce.Job:  map 50% reduce 0%
18/03/27 18:37:33 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:37:33 INFO mapreduce.Job: Job job_1521666602777_0919 completed successfully
18/03/27 18:37:33 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=737768
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1164
		HDFS: Number of bytes written=43961
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=67118
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=33559
		Total vcore-milliseconds taken by all map tasks=33559
		Total megabyte-milliseconds taken by all map tasks=137457664
	Map-Reduce Framework
		Map input records=3230
		Map output records=3230
		Input split bytes=465
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=474
		CPU time spent (ms)=17910
		Physical memory (bytes) snapshot=1873326080
		Virtual memory (bytes) snapshot=22614708224
		Total committed heap usage (bytes)=6107430912
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=43961
18/03/27 18:37:33 INFO mapreduce.ImportJobBase: Transferred 42.9307 KB in 25.6841 seconds (1.6715 KB/sec)
18/03/27 18:37:33 INFO mapreduce.ImportJobBase: Retrieved 3230 records.
Sqoop Import to History Load Successful for tb_online_dpsm_d_report .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_m_report_new 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_online_dpsm_m_report_new .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:37:37 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:37:37 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:37:37 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:37:37 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:37:37 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:37:37 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_m_report_new where  (1 = 0) 
18/03/27 18:37:37 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_m_report_new where  (1 = 0) 
18/03/27 18:37:37 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/8e4cfe4306566935ffec2500935d7e8e/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:37:39 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/8e4cfe4306566935ffec2500935d7e8e/QueryResult.jar
18/03/27 18:37:39 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:37:40 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:37:40 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:37:41 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175861056, maxDate=1522780661056, sequenceNumber=27512, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:37:41 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175861056, maxDate=1522780661056, sequenceNumber=27512, masterKeyId=478)
18/03/27 18:37:41 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175861458, maxDate=1522780661458, sequenceNumber=40285, masterKeyId=863)
18/03/27 18:37:41 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175861764, maxDate=1522780661764, sequenceNumber=40286, masterKeyId=862)
18/03/27 18:37:44 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:37:44 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:37:44 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(year), MAX(year) FROM (select * from dbo.tb_online_dpsm_m_report_new where  (1 = 1) ) AS t1
18/03/27 18:37:44 INFO db.IntegerSplitter: Split size: 0; Num splits: 4 from: 2017 to: 2018
18/03/27 18:37:45 INFO mapreduce.JobSubmitter: number of splits:2
18/03/27 18:37:45 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0920
18/03/27 18:37:45 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175861764, maxDate=1522780661764, sequenceNumber=40286, masterKeyId=862)
18/03/27 18:37:45 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175861458, maxDate=1522780661458, sequenceNumber=40285, masterKeyId=863)
18/03/27 18:37:45 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175861056, maxDate=1522780661056, sequenceNumber=27512, masterKeyId=478)
18/03/27 18:37:45 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0920
18/03/27 18:37:45 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0920/
18/03/27 18:37:45 INFO mapreduce.Job: Running job: job_1521666602777_0920
18/03/27 18:37:55 INFO mapreduce.Job: Job job_1521666602777_0920 running in uber mode : false
18/03/27 18:37:55 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:38:05 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:38:06 INFO mapreduce.Job: Job job_1521666602777_0920 completed successfully
18/03/27 18:38:07 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=367622
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=314
		HDFS: Number of bytes written=39599
		HDFS: Number of read operations=8
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=4
	Job Counters 
		Launched map tasks=2
		Other local map tasks=2
		Total time spent by all maps in occupied slots (ms)=31482
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=15741
		Total vcore-milliseconds taken by all map tasks=15741
		Total megabyte-milliseconds taken by all map tasks=64475136
	Map-Reduce Framework
		Map input records=1832
		Map output records=1832
		Input split bytes=209
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=189
		CPU time spent (ms)=8000
		Physical memory (bytes) snapshot=915779584
		Virtual memory (bytes) snapshot=11297566720
		Total committed heap usage (bytes)=3042967552
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=39599
18/03/27 18:38:07 INFO mapreduce.ImportJobBase: Transferred 38.6709 KB in 26.3692 seconds (1.4665 KB/sec)
18/03/27 18:38:07 INFO mapreduce.ImportJobBase: Retrieved 1832 records.
Sqoop Import to History Load Successful for tb_online_dpsm_m_report_new .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_p_report 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_online_dpsm_p_report .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:38:11 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:38:11 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:38:11 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:38:11 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:38:11 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:38:11 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_p_report where  (1 = 0) 
18/03/27 18:38:11 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_p_report where  (1 = 0) 
18/03/27 18:38:11 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/69d84e484618e58bb1fc2c75a674972b/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:38:13 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/69d84e484618e58bb1fc2c75a674972b/QueryResult.jar
18/03/27 18:38:13 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:38:13 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:38:14 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:38:14 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175894451, maxDate=1522780694451, sequenceNumber=27513, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:38:14 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175894451, maxDate=1522780694451, sequenceNumber=27513, masterKeyId=478)
18/03/27 18:38:14 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175894830, maxDate=1522780694830, sequenceNumber=40287, masterKeyId=862)
18/03/27 18:38:15 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175895198, maxDate=1522780695198, sequenceNumber=40288, masterKeyId=863)
18/03/27 18:38:18 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:38:18 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:38:18 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(sku_cd), MAX(sku_cd) FROM (select * from dbo.tb_online_dpsm_p_report where  (1 = 1) ) AS t1
18/03/27 18:38:18 INFO db.IntegerSplitter: Split size: 4208; Num splits: 4 from: 11012698 to: 11029530
18/03/27 18:38:18 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:38:18 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0921
18/03/27 18:38:18 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175894830, maxDate=1522780694830, sequenceNumber=40287, masterKeyId=862)
18/03/27 18:38:18 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175895198, maxDate=1522780695198, sequenceNumber=40288, masterKeyId=863)
18/03/27 18:38:18 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175894451, maxDate=1522780694451, sequenceNumber=27513, masterKeyId=478)
18/03/27 18:38:19 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0921
18/03/27 18:38:19 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0921/
18/03/27 18:38:19 INFO mapreduce.Job: Running job: job_1521666602777_0921
18/03/27 18:38:29 INFO mapreduce.Job: Job job_1521666602777_0921 running in uber mode : false
18/03/27 18:38:29 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:38:40 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:38:41 INFO mapreduce.Job: Job job_1521666602777_0921 completed successfully
18/03/27 18:38:41 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735196
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1164
		HDFS: Number of bytes written=143907
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=67486
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=33743
		Total vcore-milliseconds taken by all map tasks=33743
		Total megabyte-milliseconds taken by all map tasks=138211328
	Map-Reduce Framework
		Map input records=3713
		Map output records=3713
		Input split bytes=465
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=458
		CPU time spent (ms)=18730
		Physical memory (bytes) snapshot=1901465600
		Virtual memory (bytes) snapshot=22591483904
		Total committed heap usage (bytes)=6084362240
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=143907
18/03/27 18:38:41 INFO mapreduce.ImportJobBase: Transferred 140.5342 KB in 27.65 seconds (5.0826 KB/sec)
18/03/27 18:38:41 INFO mapreduce.ImportJobBase: Retrieved 3713 records.
Sqoop Import to History Load Successful for tb_online_dpsm_p_report .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_s_report_new 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_online_dpsm_s_report_new .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:38:46 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:38:46 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:38:46 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:38:46 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:38:46 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:38:46 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_s_report_new where  (1 = 0) 
18/03/27 18:38:46 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_online_dpsm_s_report_new where  (1 = 0) 
18/03/27 18:38:46 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/5be2a8a9f8b9f640c00f0609c3e65211/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:38:47 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/5be2a8a9f8b9f640c00f0609c3e65211/QueryResult.jar
18/03/27 18:38:47 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:38:48 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:38:48 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:38:49 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175929334, maxDate=1522780729334, sequenceNumber=27515, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:38:49 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175929334, maxDate=1522780729334, sequenceNumber=27515, masterKeyId=478)
18/03/27 18:38:49 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175929672, maxDate=1522780729672, sequenceNumber=40290, masterKeyId=862)
18/03/27 18:38:49 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175929971, maxDate=1522780729971, sequenceNumber=40291, masterKeyId=863)
18/03/27 18:38:52 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:38:52 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:38:52 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(year), MAX(year) FROM (select * from dbo.tb_online_dpsm_s_report_new where  (1 = 1) ) AS t1
18/03/27 18:38:52 INFO db.IntegerSplitter: Split size: 0; Num splits: 4 from: 2017 to: 2018
18/03/27 18:38:52 INFO mapreduce.JobSubmitter: number of splits:2
18/03/27 18:38:52 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0923
18/03/27 18:38:52 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175929672, maxDate=1522780729672, sequenceNumber=40290, masterKeyId=862)
18/03/27 18:38:52 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175929971, maxDate=1522780729971, sequenceNumber=40291, masterKeyId=863)
18/03/27 18:38:52 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175929334, maxDate=1522780729334, sequenceNumber=27515, masterKeyId=478)
18/03/27 18:38:52 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0923
18/03/27 18:38:52 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0923/
18/03/27 18:38:52 INFO mapreduce.Job: Running job: job_1521666602777_0923
18/03/27 18:39:03 INFO mapreduce.Job: Job job_1521666602777_0923 running in uber mode : false
18/03/27 18:39:03 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:39:13 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:39:13 INFO mapreduce.Job: Job job_1521666602777_0923 completed successfully
18/03/27 18:39:13 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=367622
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=314
		HDFS: Number of bytes written=85079
		HDFS: Number of read operations=8
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=4
	Job Counters 
		Launched map tasks=2
		Other local map tasks=2
		Total time spent by all maps in occupied slots (ms)=29164
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=14582
		Total vcore-milliseconds taken by all map tasks=14582
		Total megabyte-milliseconds taken by all map tasks=59727872
	Map-Reduce Framework
		Map input records=4464
		Map output records=4464
		Input split bytes=209
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=232
		CPU time spent (ms)=9360
		Physical memory (bytes) snapshot=959328256
		Virtual memory (bytes) snapshot=11300823040
		Total committed heap usage (bytes)=3098017792
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=85079
18/03/27 18:39:13 INFO mapreduce.ImportJobBase: Transferred 83.085 KB in 24.4187 seconds (3.4025 KB/sec)
18/03/27 18:39:13 INFO mapreduce.ImportJobBase: Retrieved 4464 records.
Sqoop Import to History Load Successful for tb_online_dpsm_s_report_new .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_penetration_report 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_penetration_report .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:39:17 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:39:17 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:39:17 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:39:17 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:39:17 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:39:17 INFO manager.SqlManager: Executing SQL statement: select year ,month ,classification ,classification2 ,biz_category ,vlt	,product_category_cd ,brand_cd ,
sub_brand_cd ,product_name ,sku_cd ,site ,
case 
when actual='true' then 1
when actual='false' then 0 end as actual,
target ,reg_date  from dbo.tb_penetration_report where  (1 = 0) 
18/03/27 18:39:17 INFO manager.SqlManager: Executing SQL statement: select year ,month ,classification ,classification2 ,biz_category ,vlt	,product_category_cd ,brand_cd ,
sub_brand_cd ,product_name ,sku_cd ,site ,
case 
when actual='true' then 1
when actual='false' then 0 end as actual,
target ,reg_date  from dbo.tb_penetration_report where  (1 = 0) 
18/03/27 18:39:18 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/8a5763a96279c4300ee9ac1116771a7f/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:39:19 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/8a5763a96279c4300ee9ac1116771a7f/QueryResult.jar
18/03/27 18:39:19 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:39:19 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:39:20 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:39:20 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175960863, maxDate=1522780760863, sequenceNumber=27516, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:39:21 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175960863, maxDate=1522780760863, sequenceNumber=27516, masterKeyId=478)
18/03/27 18:39:21 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175961221, maxDate=1522780761221, sequenceNumber=40292, masterKeyId=862)
18/03/27 18:39:21 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175961616, maxDate=1522780761616, sequenceNumber=40293, masterKeyId=863)
18/03/27 18:39:23 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:39:23 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:39:23 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(year), MAX(year) FROM (select year ,month ,classification ,classification2 ,biz_category ,vlt	,product_category_cd ,brand_cd ,
sub_brand_cd ,product_name ,sku_cd ,site ,
case 
when actual='true' then 1
when actual='false' then 0 end as actual,
target ,reg_date  from dbo.tb_penetration_report where  (1 = 1) ) AS t1
18/03/27 18:39:23 INFO db.IntegerSplitter: Split size: 0; Num splits: 4 from: 2017 to: 2018
18/03/27 18:39:23 INFO mapreduce.JobSubmitter: number of splits:2
18/03/27 18:39:24 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0924
18/03/27 18:39:24 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175961221, maxDate=1522780761221, sequenceNumber=40292, masterKeyId=862)
18/03/27 18:39:24 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175961616, maxDate=1522780761616, sequenceNumber=40293, masterKeyId=863)
18/03/27 18:39:24 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175960863, maxDate=1522780760863, sequenceNumber=27516, masterKeyId=478)
18/03/27 18:39:24 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0924
18/03/27 18:39:24 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0924/
18/03/27 18:39:24 INFO mapreduce.Job: Running job: job_1521666602777_0924
18/03/27 18:39:34 INFO mapreduce.Job: Job job_1521666602777_0924 running in uber mode : false
18/03/27 18:39:34 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:39:43 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:39:44 INFO mapreduce.Job: Job job_1521666602777_0924 completed successfully
18/03/27 18:39:44 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=368950
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=314
		HDFS: Number of bytes written=134606
		HDFS: Number of read operations=8
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=4
	Job Counters 
		Launched map tasks=2
		Other local map tasks=2
		Total time spent by all maps in occupied slots (ms)=28692
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=14346
		Total vcore-milliseconds taken by all map tasks=14346
		Total megabyte-milliseconds taken by all map tasks=58761216
	Map-Reduce Framework
		Map input records=8330
		Map output records=8330
		Input split bytes=209
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=169
		CPU time spent (ms)=11720
		Physical memory (bytes) snapshot=1039241216
		Virtual memory (bytes) snapshot=11331178496
		Total committed heap usage (bytes)=3066560512
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=134606
18/03/27 18:39:44 INFO mapreduce.ImportJobBase: Transferred 131.4512 KB in 24.4676 seconds (5.3725 KB/sec)
18/03/27 18:39:45 INFO mapreduce.ImportJobBase: Retrieved 8330 records.
Sqoop Import to History Load Successful for tb_penetration_report .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_shelfon_sku_cd_batch 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_shelfon_sku_cd_batch .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:39:49 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:39:49 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:39:49 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:39:49 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:39:49 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:39:49 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_shelfon_sku_cd_batch where  (1 = 0) 
18/03/27 18:39:49 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_shelfon_sku_cd_batch where  (1 = 0) 
18/03/27 18:39:49 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/73c3a63b7720527e3c90325ef57f828e/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:39:50 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/73c3a63b7720527e3c90325ef57f828e/QueryResult.jar
18/03/27 18:39:50 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:39:51 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:39:51 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:39:52 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175992254, maxDate=1522780792254, sequenceNumber=27517, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:39:52 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175992254, maxDate=1522780792254, sequenceNumber=27517, masterKeyId=478)
18/03/27 18:39:52 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175992695, maxDate=1522780792695, sequenceNumber=40294, masterKeyId=862)
18/03/27 18:39:53 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175993018, maxDate=1522780793018, sequenceNumber=40295, masterKeyId=863)
18/03/27 18:39:55 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:39:55 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:39:55 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(seq_no), MAX(seq_no) FROM (select * from dbo.tb_shelfon_sku_cd_batch where  (1 = 1) ) AS t1
18/03/27 18:39:55 INFO db.IntegerSplitter: Split size: 87; Num splits: 4 from: 1 to: 352
18/03/27 18:39:55 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:39:55 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0925
18/03/27 18:39:55 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175992695, maxDate=1522780792695, sequenceNumber=40294, masterKeyId=862)
18/03/27 18:39:55 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522175993018, maxDate=1522780793018, sequenceNumber=40295, masterKeyId=863)
18/03/27 18:39:55 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522175992254, maxDate=1522780792254, sequenceNumber=27517, masterKeyId=478)
18/03/27 18:39:55 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0925
18/03/27 18:39:55 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0925/
18/03/27 18:39:55 INFO mapreduce.Job: Running job: job_1521666602777_0925
18/03/27 18:40:06 INFO mapreduce.Job: Job job_1521666602777_0925 running in uber mode : false
18/03/27 18:40:06 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:40:16 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:40:17 INFO mapreduce.Job: Job job_1521666602777_0925 completed successfully
18/03/27 18:40:17 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735196
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1059
		HDFS: Number of bytes written=15390
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=62140
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=31070
		Total vcore-milliseconds taken by all map tasks=31070
		Total megabyte-milliseconds taken by all map tasks=127262720
	Map-Reduce Framework
		Map input records=331
		Map output records=331
		Input split bytes=421
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=494
		CPU time spent (ms)=15850
		Physical memory (bytes) snapshot=1811312640
		Virtual memory (bytes) snapshot=22593466368
		Total committed heap usage (bytes)=5913444352
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=15390
18/03/27 18:40:17 INFO mapreduce.ImportJobBase: Transferred 15.0293 KB in 25.611 seconds (600.9147 bytes/sec)
18/03/27 18:40:17 INFO mapreduce.ImportJobBase: Retrieved 331 records.
Sqoop Import to History Load Successful for tb_shelfon_sku_cd_batch .
Initiating authentication
HDFS dir is /kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_shelfon_skucd_mapping 
Path does not exists, Creating Directory
Starting Sqoop Import Process for table tb_shelfon_skucd_mapping .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
18/03/27 18:40:21 INFO sqoop.Sqoop: Running Sqoop version: 1.4.6-cdh5.13.1
18/03/27 18:40:21 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.
18/03/27 18:40:21 INFO manager.SqlManager: Using default fetchSize of 1000
18/03/27 18:40:21 INFO tool.CodeGenTool: Beginning code generation
18/03/27 18:40:22 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:40:22 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_shelfon_skucd_mapping where  (1 = 0) 
18/03/27 18:40:22 INFO manager.SqlManager: Executing SQL statement: select * from dbo.tb_shelfon_skucd_mapping where  (1 = 0) 
18/03/27 18:40:22 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce
Note: /tmp/sqoop-r62574/compile/71cf54b8b65d5c3c0e495e256a8171d7/QueryResult.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
18/03/27 18:40:23 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-r62574/compile/71cf54b8b65d5c3c0e495e256a8171d7/QueryResult.jar
18/03/27 18:40:23 INFO mapreduce.ImportJobBase: Beginning query import.
18/03/27 18:40:23 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar
18/03/27 18:40:24 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps
18/03/27 18:40:24 INFO hdfs.DFSClient: Created token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522176024728, maxDate=1522780824728, sequenceNumber=27518, masterKeyId=478 on ha-hdfs:nameservice1
18/03/27 18:40:25 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522176024728, maxDate=1522780824728, sequenceNumber=27518, masterKeyId=478)
18/03/27 18:40:25 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522176025097, maxDate=1522780825097, sequenceNumber=40296, masterKeyId=863)
18/03/27 18:40:25 INFO security.TokenCache: Got dt for hdfs://nameservice1; Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522176025443, maxDate=1522780825443, sequenceNumber=40297, masterKeyId=862)
18/03/27 18:40:27 INFO jdbcdriver.VDBJDBCDriver: connect: URL=jdbc:jtds:sqlserver://USTCAS24.kcc.com:1433/SalesAnalytics;useNTLMv2=true;domain=KCUS; Properties=Q09654
18/03/27 18:40:27 INFO db.DBInputFormat: Using read commited transaction isolation
18/03/27 18:40:27 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN(sku_cd), MAX(sku_cd) FROM (select * from dbo.tb_shelfon_skucd_mapping where  (1 = 1) ) AS t1
18/03/27 18:40:27 INFO db.IntegerSplitter: Split size: 2480226; Num splits: 4 from: 1108976 to: 11029883
18/03/27 18:40:27 INFO mapreduce.JobSubmitter: number of splits:4
18/03/27 18:40:27 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1521666602777_0926
18/03/27 18:40:27 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522176025443, maxDate=1522780825443, sequenceNumber=40297, masterKeyId=862)
18/03/27 18:40:27 INFO mapreduce.JobSubmitter: Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=r62574, renewer=yarn, realUser=, issueDate=1522176025097, maxDate=1522780825097, sequenceNumber=40296, masterKeyId=863)
18/03/27 18:40:27 INFO mapreduce.JobSubmitter: Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for r62574: HDFS_DELEGATION_TOKEN owner=r62574@KCC.COM, renewer=yarn, realUser=, issueDate=1522176024728, maxDate=1522780824728, sequenceNumber=27518, masterKeyId=478)
18/03/27 18:40:28 INFO impl.YarnClientImpl: Submitted application application_1521666602777_0926
18/03/27 18:40:28 INFO mapreduce.Job: The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0926/
18/03/27 18:40:28 INFO mapreduce.Job: Running job: job_1521666602777_0926
18/03/27 18:40:39 INFO mapreduce.Job: Job job_1521666602777_0926 running in uber mode : false
18/03/27 18:40:39 INFO mapreduce.Job:  map 0% reduce 0%
18/03/27 18:40:48 INFO mapreduce.Job:  map 50% reduce 0%
18/03/27 18:40:51 INFO mapreduce.Job:  map 75% reduce 0%
18/03/27 18:42:15 INFO mapreduce.Job:  map 100% reduce 0%
18/03/27 18:42:16 INFO mapreduce.Job: Job job_1521666602777_0926 completed successfully
18/03/27 18:42:16 INFO mapreduce.Job: Counters: 30
	File System Counters
		FILE: Number of bytes read=0
		FILE: Number of bytes written=735216
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
		HDFS: Number of bytes read=1148
		HDFS: Number of bytes written=320480671
		HDFS: Number of read operations=16
		HDFS: Number of large read operations=0
		HDFS: Number of write operations=8
	Job Counters 
		Launched map tasks=4
		Other local map tasks=4
		Total time spent by all maps in occupied slots (ms)=239492
		Total time spent by all reduces in occupied slots (ms)=0
		Total time spent by all map tasks (ms)=119746
		Total vcore-milliseconds taken by all map tasks=119746
		Total megabyte-milliseconds taken by all map tasks=490479616
	Map-Reduce Framework
		Map input records=48364747
		Map output records=48364747
		Input split bytes=458
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=1172
		CPU time spent (ms)=127410
		Physical memory (bytes) snapshot=3008557056
		Virtual memory (bytes) snapshot=22615302144
		Total committed heap usage (bytes)=6751256576
	File Input Format Counters 
		Bytes Read=0
	File Output Format Counters 
		Bytes Written=320480671
18/03/27 18:42:16 INFO mapreduce.ImportJobBase: Transferred 305.6342 MB in 112.1111 seconds (2.7262 MB/sec)
18/03/27 18:42:16 INFO mapreduce.ImportJobBase: Retrieved 48364747 records.
Sqoop Import to History Load Successful for tb_shelfon_skucd_mapping .
Successfully imported the derived tables data
Starting Data-load process from raw tables to processed tables.
Initiating authentication
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.055 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327184242_4ae0f6bb-c136-480a-ac53-bb040cb3fd21): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184242_4ae0f6bb-c136-480a-ac53-bb040cb3fd21); Time taken: 0.137 seconds
INFO  : Executing command(queryId=hive_20180327184242_4ae0f6bb-c136-480a-ac53-bb040cb3fd21): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184242_4ae0f6bb-c136-480a-ac53-bb040cb3fd21); Time taken: 0.016 seconds
INFO  : OK
No rows affected (0.177 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.collected_corp_raw ;
INFO  : Compiling command(queryId=hive_20180327184242_58832104-bb59-4eda-b7bd-dddc1154375a): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.collected_corp_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184242_58832104-bb59-4eda-b7bd-dddc1154375a); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180327184242_58832104-bb59-4eda-b7bd-dddc1154375a): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.collected_corp_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184242_58832104-bb59-4eda-b7bd-dddc1154375a); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.107 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.collected_corp_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> corp_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> seller string,
. . . . . . . . . . . . . . . . . . . . . . .> name string,
. . . . . . . . . . . . . . . . . . . . . . .> delegate string,
. . . . . . . . . . . . . . . . . . . . . . .> addr string,
. . . . . . . . . . . . . . . . . . . . . . .> email string,
. . . . . . . . . . . . . . . . . . . . . . .> corp_number varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> cellular_phone1 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> cellular_phone2 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> cellular_phone3 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> corp_phone1 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> corp_phone2 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> fax varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> certified tinyint
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184242_a79e04b2-3add-4e5e-8699-a3e1346a39f7): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.collected_corp_raw
(
corp_seq bigint,
id varchar(32),
seller string,
name string,
delegate string,
addr string,
email string,
corp_number varchar(64),
cellular_phone1 varchar(24),
cellular_phone2 varchar(24),
cellular_phone3 varchar(24),
corp_phone1 varchar(24),
corp_phone2 varchar(24),
fax varchar(24),
rtime timestamp,
certified tinyint
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/collected_corp_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184242_a79e04b2-3add-4e5e-8699-a3e1346a39f7); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327184242_a79e04b2-3add-4e5e-8699-a3e1346a39f7): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.collected_corp_raw
(
corp_seq bigint,
id varchar(32),
seller string,
name string,
delegate string,
addr string,
email string,
corp_number varchar(64),
cellular_phone1 varchar(24),
cellular_phone2 varchar(24),
cellular_phone3 varchar(24),
corp_phone1 varchar(24),
corp_phone2 varchar(24),
fax varchar(24),
rtime timestamp,
certified tinyint
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/collected_corp_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184242_a79e04b2-3add-4e5e-8699-a3e1346a39f7); Time taken: 0.321 seconds
INFO  : OK
No rows affected (0.446 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.collected_corp_processed ;
INFO  : Compiling command(queryId=hive_20180327184242_6e8b69ec-533e-4eba-90da-de272c60036a): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.collected_corp_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184242_6e8b69ec-533e-4eba-90da-de272c60036a); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327184242_6e8b69ec-533e-4eba-90da-de272c60036a): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.collected_corp_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184242_6e8b69ec-533e-4eba-90da-de272c60036a); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.121 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.collected_corp_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> corp_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> seller string,
. . . . . . . . . . . . . . . . . . . . . . .> name string,
. . . . . . . . . . . . . . . . . . . . . . .> delegate string,
. . . . . . . . . . . . . . . . . . . . . . .> addr string,
. . . . . . . . . . . . . . . . . . . . . . .> email string,
. . . . . . . . . . . . . . . . . . . . . . .> corp_number varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> cellular_phone1 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> cellular_phone2 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> cellular_phone3 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> corp_phone1 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> corp_phone2 varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> fax varchar(24),
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> certified tinyint,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184242_248d9803-8df4-43ea-9a3b-3d33a3ef20d4): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.collected_corp_processed
(
corp_seq bigint,
id varchar(32),
seller string,
name string,
delegate string,
addr string,
email string,
corp_number varchar(64),
cellular_phone1 varchar(24),
cellular_phone2 varchar(24),
cellular_phone3 varchar(24),
corp_phone1 varchar(24),
corp_phone2 varchar(24),
fax varchar(24),
rtime timestamp,
certified tinyint,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/collected_corp_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184242_248d9803-8df4-43ea-9a3b-3d33a3ef20d4); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327184242_248d9803-8df4-43ea-9a3b-3d33a3ef20d4): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.collected_corp_processed
(
corp_seq bigint,
id varchar(32),
seller string,
name string,
delegate string,
addr string,
email string,
corp_number varchar(64),
cellular_phone1 varchar(24),
cellular_phone2 varchar(24),
cellular_phone3 varchar(24),
corp_phone1 varchar(24),
corp_phone2 varchar(24),
fax varchar(24),
rtime timestamp,
certified tinyint,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/collected_corp_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184242_248d9803-8df4-43ea-9a3b-3d33a3ef20d4); Time taken: 0.233 seconds
INFO  : OK
No rows affected (0.342 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.collected_corp_raw;
INFO  : Compiling command(queryId=hive_20180327184242_43ea1aa6-f00e-4af9-a5c5-2ff5ba973b56): MSCK REPAIR TABLE prd_ykdl_adhoc_db.collected_corp_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184242_43ea1aa6-f00e-4af9-a5c5-2ff5ba973b56); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327184242_43ea1aa6-f00e-4af9-a5c5-2ff5ba973b56): MSCK REPAIR TABLE prd_ykdl_adhoc_db.collected_corp_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184242_43ea1aa6-f00e-4af9-a5c5-2ff5ba973b56); Time taken: 0.081 seconds
INFO  : OK
No rows affected (0.182 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.collected_corp_processed PARTITION (ingestion_date , active _flag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .> r.corp_seq ,
. . . . . . . . . . . . . . . . . . . . . . .> r.id ,
. . . . . . . . . . . . . . . . . . . . . . .> r.seller ,
. . . . . . . . . . . . . . . . . . . . . . .> r.name ,
. . . . . . . . . . . . . . . . . . . . . . .> r.delegate ,
. . . . . . . . . . . . . . . . . . . . . . .> r.addr ,
. . . . . . . . . . . . . . . . . . . . . . .> r.email ,
. . . . . . . . . . . . . . . . . . . . . . .> r.corp_number ,
. . . . . . . . . . . . . . . . . . . . . . .> r.cellular_phone1 ,
. . . . . . . . . . . . . . . . . . . . . . .> r.cellular_phone2 ,
. . . . . . . . . . . . . . . . . . . . . . .> r.cellular_phone3 ,
. . . . . . . . . . . . . . . . . . . . . . .> r.corp_phone1 ,
. . . . . . . . . . . . . . . . . . . . . . .> r.corp_phone2 ,
. . . . . . . . . . . . . . . . . . . . . . .> r.fax ,
. . . . . . . . . . . . . . . . . . . . . . .> r.rtime ,
. . . . . . . . . . . . . . . . . . . . . . .> r.certified,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.collected_corp_raw r;
INFO  : Compiling command(queryId=hive_20180327184242_b8d01b98-b112-4cdb-a8cf-76cee9a30d7b): insert into table prd_ykdl_adhoc_db.collected_corp_processed PARTITION (ingestion_date , active_flag)
select
r.corp_seq ,
r.id ,
r.seller ,
r.name ,
r.delegate ,
r.addr ,
r.email ,
r.corp_number ,
r.cellular_phone1 ,
r.cellular_phone2 ,
r.cellular_phone3 ,
r.corp_phone1 ,
r.corp_phone2 ,
r.fax ,
r.rtime ,
r.certified,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.collected_corp_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.corp_seq, type:bigint, comment:null), FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.seller, type:string, comment:null), FieldSchema(name:r.name, type:string, comment:null), FieldSchema(name:r.delegate, type:string, comment:null), FieldSchema(name:r.addr, type:string, comment:null), FieldSchema(name:r.email, type:string, comment:null), FieldSchema(name:r.corp_number, type:varchar(64), comment:null), FieldSchema(name:r.cellular_phone1, type:varchar(24), comment:null), FieldSchema(name:r.cellular_phone2, type:varchar(24), comment:null), FieldSchema(name:r.cellular_phone3, type:varchar(24), comment:null), FieldSchema(name:r.corp_phone1, type:varchar(24), comment:null), FieldSchema(name:r.corp_phone2, type:varchar(24), comment:null), FieldSchema(name:r.fax, type:varchar(24), comment:null), FieldSchema(name:r.rtime, type:timestamp, comment:null), FieldSchema(name:r.certified, type:tinyint, comment:null), FieldSchema(name:_c16, type:string, comment:null), FieldSchema(name:_c17, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c19, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184242_b8d01b98-b112-4cdb-a8cf-76cee9a30d7b); Time taken: 0.211 seconds
INFO  : Executing command(queryId=hive_20180327184242_b8d01b98-b112-4cdb-a8cf-76cee9a30d7b): insert into table prd_ykdl_adhoc_db.collected_corp_processed PARTITION (ingestion_date , active_flag)
select
r.corp_seq ,
r.id ,
r.seller ,
r.name ,
r.delegate ,
r.addr ,
r.email ,
r.corp_number ,
r.cellular_phone1 ,
r.cellular_phone2 ,
r.cellular_phone3 ,
r.corp_phone1 ,
r.corp_phone2 ,
r.fax ,
r.rtime ,
r.certified,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.collected_corp_raw r
INFO  : Query ID = hive_20180327184242_b8d01b98-b112-4cdb-a8cf-76cee9a30d7b
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:2
INFO  : Submitting tokens for job: job_1521666602777_0927
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176143463, maxDate=1522780943463, sequenceNumber=40298, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176143508, maxDate=1522780943508, sequenceNumber=40299, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176143427, maxDate=1522780943427, sequenceNumber=27519, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0927/
INFO  : Starting Job = job_1521666602777_0927, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0927/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0927
INFO  : Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 0
INFO  : 2018-03-27 18:42:32,639 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:42:44,090 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 23.35 sec
INFO  : MapReduce Total cumulative CPU time: 23 seconds 350 msec
INFO  : Ended Job = job_1521666602777_0927
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is filtered out by condition resolver.
INFO  : Stage-3 is selected by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Launching Job 3 out of 3
INFO  : Starting task [Stage-3:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0928
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176166423, maxDate=1522780966423, sequenceNumber=40301, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176166378, maxDate=1522780966378, sequenceNumber=40300, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176166360, maxDate=1522780966360, sequenceNumber=27520, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0928/
INFO  : Starting Job = job_1521666602777_0928, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0928/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0928
INFO  : Hadoop job information for Stage-3: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 18:42:55,452 Stage-3 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:43:05,855 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 12.24 sec
INFO  : MapReduce Total cumulative CPU time: 12 seconds 240 msec
INFO  : Ended Job = job_1521666602777_0928
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.collected_corp_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/collected_corp_processed/.hive-staging_hive_2018-03-27_18-42-23_003_7579004263237226456-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 312
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.collected_corp_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=1, numRows=19223, totalSize=3836501, rawDataSize=346014]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 2   Cumulative CPU: 23.35 sec   HDFS Read: 2389632 HDFS Write: 3847416 SUCCESS
INFO  : Stage-Stage-3: Map: 1   Cumulative CPU: 12.24 sec   HDFS Read: 3858180 HDFS Write: 3836501 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 35 seconds 590 msec
INFO  : Completed executing command(queryId=hive_20180327184242_b8d01b98-b112-4cdb-a8cf-76cee9a30d7b); Time taken: 45.305 seconds
INFO  : OK
No rows affected (45.539 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.collected_corp_processed;
INFO  : Compiling command(queryId=hive_20180327184343_b0a78ad1-54d6-420b-90cd-713c9b20f78f): MSCK REPAIR TABLE prd_ykdl_adhoc_db.collected_corp_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_b0a78ad1-54d6-420b-90cd-713c9b20f78f); Time taken: 0.161 seconds
INFO  : Executing command(queryId=hive_20180327184343_b0a78ad1-54d6-420b-90cd-713c9b20f78f): MSCK REPAIR TABLE prd_ykdl_adhoc_db.collected_corp_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_b0a78ad1-54d6-420b-90cd-713c9b20f78f); Time taken: 0.057 seconds
INFO  : OK
No rows affected (0.227 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table collected_corp.
Moving raw data to archive location for table collected_corp.
collected_corp tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.052 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327184343_0d293169-fb2f-46b5-b1e6-7e5f828af514): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_0d293169-fb2f-46b5-b1e6-7e5f828af514); Time taken: 0.108 seconds
INFO  : Executing command(queryId=hive_20180327184343_0d293169-fb2f-46b5-b1e6-7e5f828af514): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_0d293169-fb2f-46b5-b1e6-7e5f828af514); Time taken: 0.011 seconds
INFO  : OK
No rows affected (0.128 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_category_raw ;
INFO  : Compiling command(queryId=hive_20180327184343_ca8d32d1-7df6-412a-9eb2-3b426d1050c5): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_category_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_ca8d32d1-7df6-412a-9eb2-3b426d1050c5); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180327184343_ca8d32d1-7df6-412a-9eb2-3b426d1050c5): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_category_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_ca8d32d1-7df6-412a-9eb2-3b426d1050c5); Time taken: 0.003 seconds
INFO  : OK
No rows affected (0.106 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_category_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> priceon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> pseq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> name string
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184343_169a0538-fc02-4812-a6e8-de4b453ad95f): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_category_raw
(
priceon_category_seq bigint,
id varchar(32),
pseq bigint,
name string
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_category_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_169a0538-fc02-4812-a6e8-de4b453ad95f); Time taken: 0.093 seconds
INFO  : Executing command(queryId=hive_20180327184343_169a0538-fc02-4812-a6e8-de4b453ad95f): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_category_raw
(
priceon_category_seq bigint,
id varchar(32),
pseq bigint,
name string
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_category_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_169a0538-fc02-4812-a6e8-de4b453ad95f); Time taken: 0.36 seconds
INFO  : OK
No rows affected (0.467 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_category_processed ;
INFO  : Compiling command(queryId=hive_20180327184343_162f75d0-2598-46bd-8d50-19c18e5f9c91): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_category_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_162f75d0-2598-46bd-8d50-19c18e5f9c91); Time taken: 0.111 seconds
INFO  : Executing command(queryId=hive_20180327184343_162f75d0-2598-46bd-8d50-19c18e5f9c91): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_category_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_162f75d0-2598-46bd-8d50-19c18e5f9c91); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.121 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_category_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> priceon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> pseq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> name string,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184343_36e9fccf-b2ce-4cc1-9038-c512ec73c9cd): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_category_processed
(
priceon_category_seq bigint,
id varchar(32),
pseq bigint,
name string,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_category_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_36e9fccf-b2ce-4cc1-9038-c512ec73c9cd); Time taken: 0.099 seconds
INFO  : Executing command(queryId=hive_20180327184343_36e9fccf-b2ce-4cc1-9038-c512ec73c9cd): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_category_processed
(
priceon_category_seq bigint,
id varchar(32),
pseq bigint,
name string,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_category_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_36e9fccf-b2ce-4cc1-9038-c512ec73c9cd); Time taken: 0.203 seconds
INFO  : OK
No rows affected (0.315 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_category_raw;
INFO  : Compiling command(queryId=hive_20180327184343_e619bace-6694-4db8-b486-ed432c8d2b02): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_category_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_e619bace-6694-4db8-b486-ed432c8d2b02); Time taken: 0.107 seconds
INFO  : Executing command(queryId=hive_20180327184343_e619bace-6694-4db8-b486-ed432c8d2b02): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_category_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_e619bace-6694-4db8-b486-ed432c8d2b02); Time taken: 0.078 seconds
INFO  : OK
No rows affected (0.19 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.priceon_category_processed PARTITION (ingestion_date , acti ve_flag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .> r.priceon_category_seq ,
. . . . . . . . . . . . . . . . . . . . . . .> r.id ,
. . . . . . . . . . . . . . . . . . . . . . .> r.pseq ,
. . . . . . . . . . . . . . . . . . . . . . .> r.name ,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.priceon_category_raw r;
INFO  : Compiling command(queryId=hive_20180327184343_8b1e6a20-a5ff-4340-8c86-c2f8630d7022): insert into table prd_ykdl_adhoc_db.priceon_category_processed PARTITION (ingestion_date , active_flag)
select
r.priceon_category_seq ,
r.id ,
r.pseq ,
r.name ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_category_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.priceon_category_seq, type:bigint, comment:null), FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.pseq, type:bigint, comment:null), FieldSchema(name:r.name, type:string, comment:null), FieldSchema(name:_c4, type:string, comment:null), FieldSchema(name:_c5, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c7, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_8b1e6a20-a5ff-4340-8c86-c2f8630d7022); Time taken: 0.207 seconds
INFO  : Executing command(queryId=hive_20180327184343_8b1e6a20-a5ff-4340-8c86-c2f8630d7022): insert into table prd_ykdl_adhoc_db.priceon_category_processed PARTITION (ingestion_date , active_flag)
select
r.priceon_category_seq ,
r.id ,
r.pseq ,
r.name ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_category_raw r
INFO  : Query ID = hive_20180327184343_8b1e6a20-a5ff-4340-8c86-c2f8630d7022
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0930
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176199905, maxDate=1522780999905, sequenceNumber=40303, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176199953, maxDate=1522780999953, sequenceNumber=40304, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176199885, maxDate=1522780999885, sequenceNumber=27522, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0930/
INFO  : Starting Job = job_1521666602777_0930, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0930/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0930
INFO  : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 18:43:29,023 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:43:39,436 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 8.13 sec
INFO  : MapReduce Total cumulative CPU time: 8 seconds 130 msec
INFO  : Ended Job = job_1521666602777_0930
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_category_processed/.hive-staging_hive_2018-03-27_18-43-19_510_7934685369614702891-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_category_processed/.hive-staging_hive_2018-03-27_18-43-19_510_7934685369614702891-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.priceon_category_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_category_processed/.hive-staging_hive_2018-03-27_18-43-19_510_7934685369614702891-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 106
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.priceon_category_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=1, numRows=473, totalSize=10742, rawDataSize=2838]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 1   Cumulative CPU: 8.13 sec   HDFS Read: 11752 HDFS Write: 10885 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 8 seconds 130 msec
INFO  : Completed executing command(queryId=hive_20180327184343_8b1e6a20-a5ff-4340-8c86-c2f8630d7022); Time taken: 22.189 seconds
INFO  : OK
No rows affected (22.419 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_category_processed;
INFO  : Compiling command(queryId=hive_20180327184343_df8a37b7-bd4e-49a8-b7f2-09968e093bd2): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_category_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_df8a37b7-bd4e-49a8-b7f2-09968e093bd2); Time taken: 0.098 seconds
INFO  : Executing command(queryId=hive_20180327184343_df8a37b7-bd4e-49a8-b7f2-09968e093bd2): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_category_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_df8a37b7-bd4e-49a8-b7f2-09968e093bd2); Time taken: 0.053 seconds
INFO  : OK
No rows affected (0.157 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table priceon_category.
Moving raw data to archive location for table priceon_category.
priceon_category tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.048 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327184343_c50abf36-7fe1-45d0-98dd-9883dc50aa06): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_c50abf36-7fe1-45d0-98dd-9883dc50aa06); Time taken: 0.106 seconds
INFO  : Executing command(queryId=hive_20180327184343_c50abf36-7fe1-45d0-98dd-9883dc50aa06): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_c50abf36-7fe1-45d0-98dd-9883dc50aa06); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.127 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_collected_card_price_raw ;
INFO  : Compiling command(queryId=hive_20180327184343_df6b2efc-0fd0-43c6-a056-4738d3cfe43b): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_collected_card_price_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_df6b2efc-0fd0-43c6-a056-4738d3cfe43b); Time taken: 0.091 seconds
INFO  : Executing command(queryId=hive_20180327184343_df6b2efc-0fd0-43c6-a056-4738d3cfe43b): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_collected_card_price_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_df6b2efc-0fd0-43c6-a056-4738d3cfe43b); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.102 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_collected_card_price_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> priceon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> unique_code varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> pid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> gid varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> history_code bigint,
. . . . . . . . . . . . . . . . . . . . . . .> entry_site varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> entry_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> market varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> market_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> option_name STRING,
. . . . . . . . . . . . . . . . . . . . . . .> url varchar(1024),
. . . . . . . . . . . . . . . . . . . . . . .> price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_discount decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_discount_ratio decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> delivery_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> delivery_charge_type tinyint,
. . . . . . . . . . . . . . . . . . . . . . .> price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> card_name STRING,
. . . . . . . . . . . . . . . . . . . . . . .> card_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> card_price_discount decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> card_price_discount_ratio decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> card_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> corp_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> additional_info varchar(256),
. . . . . . . . . . . . . . . . . . . . . . .> seq bigint
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184343_9868f1fe-ebfc-483f-9a49-8d9160145cf0): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_collected_card_price_raw
(
id varchar(32),
priceon_data_seq bigint,
unique_code varchar(64),
pid bigint,
gid varchar(64),
history_code bigint,
entry_site varchar(32),
entry_pid varchar(128),
market varchar(32),
market_pid varchar(128),
title STRING,
option_name STRING,
url varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sale_price_discount decimal(21,2),
sale_price_discount_ratio decimal(21,2),
delivery_price decimal(21,2),
delivery_charge_type tinyint,
price_appended_delivery decimal(21,2),
sale_price_appended_delivery decimal(21,2),
card_name STRING,
card_price decimal(21,2),
card_price_discount decimal(21,2),
card_price_discount_ratio decimal(21,2),
card_price_appended_delivery decimal(21,2),
corp_seq bigint,
rtime timestamp,
additional_info varchar(256),
seq bigint
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_card_price_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_9868f1fe-ebfc-483f-9a49-8d9160145cf0); Time taken: 0.093 seconds
INFO  : Executing command(queryId=hive_20180327184343_9868f1fe-ebfc-483f-9a49-8d9160145cf0): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_collected_card_price_raw
(
id varchar(32),
priceon_data_seq bigint,
unique_code varchar(64),
pid bigint,
gid varchar(64),
history_code bigint,
entry_site varchar(32),
entry_pid varchar(128),
market varchar(32),
market_pid varchar(128),
title STRING,
option_name STRING,
url varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sale_price_discount decimal(21,2),
sale_price_discount_ratio decimal(21,2),
delivery_price decimal(21,2),
delivery_charge_type tinyint,
price_appended_delivery decimal(21,2),
sale_price_appended_delivery decimal(21,2),
card_name STRING,
card_price decimal(21,2),
card_price_discount decimal(21,2),
card_price_discount_ratio decimal(21,2),
card_price_appended_delivery decimal(21,2),
corp_seq bigint,
rtime timestamp,
additional_info varchar(256),
seq bigint
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_card_price_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_9868f1fe-ebfc-483f-9a49-8d9160145cf0); Time taken: 0.075 seconds
INFO  : OK
No rows affected (0.184 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_collected_card_price_processed ;
INFO  : Compiling command(queryId=hive_20180327184343_59866644-530c-418e-9544-0ee6b2704372): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_collected_card_price_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_59866644-530c-418e-9544-0ee6b2704372); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327184343_59866644-530c-418e-9544-0ee6b2704372): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_collected_card_price_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_59866644-530c-418e-9544-0ee6b2704372); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.121 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_collected_card_price_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> priceon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> unique_code varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> pid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> gid varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> history_code bigint,
. . . . . . . . . . . . . . . . . . . . . . .> entry_site varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> entry_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> market varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> market_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> option_name STRING,
. . . . . . . . . . . . . . . . . . . . . . .> url varchar(1024),
. . . . . . . . . . . . . . . . . . . . . . .> price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_discount decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_discount_ratio decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> delivery_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> delivery_charge_type tinyint,
. . . . . . . . . . . . . . . . . . . . . . .> price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> card_name STRING,
. . . . . . . . . . . . . . . . . . . . . . .> card_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> card_price_discount decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> card_price_discount_ratio decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> card_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> corp_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> additional_info varchar(256),
. . . . . . . . . . . . . . . . . . . . . . .> seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, ACTIVE_FLAG STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184343_35df640c-804d-4fe6-b50f-accc28366f0a): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_collected_card_price_processed
(
id varchar(32),
priceon_data_seq bigint,
unique_code varchar(64),
pid bigint,
gid varchar(64),
history_code bigint,
entry_site varchar(32),
entry_pid varchar(128),
market varchar(32),
market_pid varchar(128),
title STRING,
option_name STRING,
url varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sale_price_discount decimal(21,2),
sale_price_discount_ratio decimal(21,2),
delivery_price decimal(21,2),
delivery_charge_type tinyint,
price_appended_delivery decimal(21,2),
sale_price_appended_delivery decimal(21,2),
card_name STRING,
card_price decimal(21,2),
card_price_discount decimal(21,2),
card_price_discount_ratio decimal(21,2),
card_price_appended_delivery decimal(21,2),
corp_seq bigint,
rtime timestamp,
additional_info varchar(256),
seq bigint,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, ACTIVE_FLAG STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_card_price_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_35df640c-804d-4fe6-b50f-accc28366f0a); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327184343_35df640c-804d-4fe6-b50f-accc28366f0a): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_collected_card_price_processed
(
id varchar(32),
priceon_data_seq bigint,
unique_code varchar(64),
pid bigint,
gid varchar(64),
history_code bigint,
entry_site varchar(32),
entry_pid varchar(128),
market varchar(32),
market_pid varchar(128),
title STRING,
option_name STRING,
url varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sale_price_discount decimal(21,2),
sale_price_discount_ratio decimal(21,2),
delivery_price decimal(21,2),
delivery_charge_type tinyint,
price_appended_delivery decimal(21,2),
sale_price_appended_delivery decimal(21,2),
card_name STRING,
card_price decimal(21,2),
card_price_discount decimal(21,2),
card_price_discount_ratio decimal(21,2),
card_price_appended_delivery decimal(21,2),
corp_seq bigint,
rtime timestamp,
additional_info varchar(256),
seq bigint,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, ACTIVE_FLAG STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_card_price_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_35df640c-804d-4fe6-b50f-accc28366f0a); Time taken: 0.235 seconds
INFO  : OK
No rows affected (0.346 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_collected_card_price_raw;
INFO  : Compiling command(queryId=hive_20180327184343_6d061ff1-ea9b-451c-9ebb-c1d3f8aa8c67): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_collected_card_price_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_6d061ff1-ea9b-451c-9ebb-c1d3f8aa8c67); Time taken: 0.091 seconds
INFO  : Executing command(queryId=hive_20180327184343_6d061ff1-ea9b-451c-9ebb-c1d3f8aa8c67): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_collected_card_price_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184343_6d061ff1-ea9b-451c-9ebb-c1d3f8aa8c67); Time taken: 0.082 seconds
INFO  : OK
No rows affected (0.179 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.priceon_collected_card_price_processed PARTITION (ingestion _date, ACTIVE_FLAG)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .>  r.id
. . . . . . . . . . . . . . . . . . . . . . .> , r.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.unique_code
. . . . . . . . . . . . . . . . . . . . . . .> , r.pid
. . . . . . . . . . . . . . . . . . . . . . .> , r.gid
. . . . . . . . . . . . . . . . . . . . . . .> , r.history_code
. . . . . . . . . . . . . . . . . . . . . . .> , r.entry_site
. . . . . . . . . . . . . . . . . . . . . . .> , r.entry_pid
. . . . . . . . . . . . . . . . . . . . . . .> , r.market
. . . . . . . . . . . . . . . . . . . . . . .> , r.market_pid
. . . . . . . . . . . . . . . . . . . . . . .> , r.title
. . . . . . . . . . . . . . . . . . . . . . .> , r.option_name
. . . . . . . . . . . . . . . . . . . . . . .> , r.url
. . . . . . . . . . . . . . . . . . . . . . .> , r.price
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price_discount
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price_discount_ratio
. . . . . . . . . . . . . . . . . . . . . . .> , r.delivery_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.delivery_charge_type
. . . . . . . . . . . . . . . . . . . . . . .> , r.price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.card_name
. . . . . . . . . . . . . . . . . . . . . . .> , r.card_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.card_price_discount
. . . . . . . . . . . . . . . . . . . . . . .> , r.card_price_discount_ratio
. . . . . . . . . . . . . . . . . . . . . . .> , r.card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.corp_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.rtime
. . . . . . . . . . . . . . . . . . . . . . .> , r.additional_info
. . . . . . . . . . . . . . . . . . . . . . .> , r.seq,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.priceon_collected_card_price_raw r;
INFO  : Compiling command(queryId=hive_20180327184343_29d004c4-b588-4082-a163-94143af2d1cc): insert into table prd_ykdl_adhoc_db.priceon_collected_card_price_processed PARTITION (ingestion_date, ACTIVE_FLAG)
select
r.id
, r.priceon_data_seq
, r.unique_code
, r.pid
, r.gid
, r.history_code
, r.entry_site
, r.entry_pid
, r.market
, r.market_pid
, r.title
, r.option_name
, r.url
, r.price
, r.sale_price
, r.sale_price_discount
, r.sale_price_discount_ratio
, r.delivery_price
, r.delivery_charge_type
, r.price_appended_delivery
, r.sale_price_appended_delivery
, r.card_name
, r.card_price
, r.card_price_discount
, r.card_price_discount_ratio
, r.card_price_appended_delivery
, r.corp_seq
, r.rtime
, r.additional_info
, r.seq,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_collected_card_price_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.priceon_data_seq, type:bigint, comment:null), FieldSchema(name:r.unique_code, type:varchar(64), comment:null), FieldSchema(name:r.pid, type:bigint, comment:null), FieldSchema(name:r.gid, type:varchar(64), comment:null), FieldSchema(name:r.history_code, type:bigint, comment:null), FieldSchema(name:r.entry_site, type:varchar(32), comment:null), FieldSchema(name:r.entry_pid, type:varchar(128), comment:null), FieldSchema(name:r.market, type:varchar(32), comment:null), FieldSchema(name:r.market_pid, type:varchar(128), comment:null), FieldSchema(name:r.title, type:string, comment:null), FieldSchema(name:r.option_name, type:string, comment:null), FieldSchema(name:r.url, type:varchar(1024), comment:null), FieldSchema(name:r.price, type:decimal(21,2), comment:null), FieldSchema(name:r.sale_price, type:decimal(21,2), comment:null), FieldSchema(name:r.sale_price_discount, type:decimal(21,2), comment:null), FieldSchema(name:r.sale_price_discount_ratio, type:decimal(21,2), comment:null), FieldSchema(name:r.delivery_price, type:decimal(21,2), comment:null), FieldSchema(name:r.delivery_charge_type, type:tinyint, comment:null), FieldSchema(name:r.price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.sale_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.card_name, type:string, comment:null), FieldSchema(name:r.card_price, type:decimal(21,2), comment:null), FieldSchema(name:r.card_price_discount, type:decimal(21,2), comment:null), FieldSchema(name:r.card_price_discount_ratio, type:decimal(21,2), comment:null), FieldSchema(name:r.card_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.corp_seq, type:bigint, comment:null), FieldSchema(name:r.rtime, type:timestamp, comment:null), FieldSchema(name:r.additional_info, type:varchar(256), comment:null), FieldSchema(name:r.seq, type:bigint, comment:null), FieldSchema(name:_c30, type:string, comment:null), FieldSchema(name:_c31, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c33, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184343_29d004c4-b588-4082-a163-94143af2d1cc); Time taken: 0.204 seconds
INFO  : Executing command(queryId=hive_20180327184343_29d004c4-b588-4082-a163-94143af2d1cc): insert into table prd_ykdl_adhoc_db.priceon_collected_card_price_processed PARTITION (ingestion_date, ACTIVE_FLAG)
select
r.id
, r.priceon_data_seq
, r.unique_code
, r.pid
, r.gid
, r.history_code
, r.entry_site
, r.entry_pid
, r.market
, r.market_pid
, r.title
, r.option_name
, r.url
, r.price
, r.sale_price
, r.sale_price_discount
, r.sale_price_discount_ratio
, r.delivery_price
, r.delivery_charge_type
, r.price_appended_delivery
, r.sale_price_appended_delivery
, r.card_name
, r.card_price
, r.card_price_discount
, r.card_price_discount_ratio
, r.card_price_appended_delivery
, r.corp_seq
, r.rtime
, r.additional_info
, r.seq,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_collected_card_price_raw r
INFO  : Query ID = hive_20180327184343_29d004c4-b588-4082-a163-94143af2d1cc
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:2
INFO  : Submitting tokens for job: job_1521666602777_0931
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176232906, maxDate=1522781032906, sequenceNumber=40305, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176232957, maxDate=1522781032957, sequenceNumber=40306, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176232885, maxDate=1522781032885, sequenceNumber=27523, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0931/
INFO  : Starting Job = job_1521666602777_0931, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0931/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0931
INFO  : Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 0
INFO  : 2018-03-27 18:44:02,076 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:44:19,736 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 22.02 sec
INFO  : 2018-03-27 18:44:21,819 Stage-1 map = 59%,  reduce = 0%, Cumulative CPU 48.58 sec
INFO  : 2018-03-27 18:44:23,896 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 52.7 sec
INFO  : MapReduce Total cumulative CPU time: 52 seconds 700 msec
INFO  : Ended Job = job_1521666602777_0931
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_card_price_processed/.hive-staging_hive_2018-03-27_18-43-52_509_9212365262372696387-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_card_price_processed/.hive-staging_hive_2018-03-27_18-43-52_509_9212365262372696387-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.priceon_collected_card_price_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_card_price_processed/.hive-staging_hive_2018-03-27_18-43-52_509_9212365262372696387-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 119
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.priceon_collected_card_price_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=2, numRows=472870, totalSize=110648757, rawDataSize=15131840]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 2   Cumulative CPU: 52.7 sec   HDFS Read: 105464235 HDFS Write: 110649079 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 52 seconds 700 msec
INFO  : Completed executing command(queryId=hive_20180327184343_29d004c4-b588-4082-a163-94143af2d1cc); Time taken: 33.697 seconds
INFO  : OK
No rows affected (33.924 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_collected_card_price_processed;
INFO  : Compiling command(queryId=hive_20180327184444_9b993bef-7ecc-472b-b2ae-9de88fc260c2): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_collected_card_price_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184444_9b993bef-7ecc-472b-b2ae-9de88fc260c2); Time taken: 0.097 seconds
INFO  : Executing command(queryId=hive_20180327184444_9b993bef-7ecc-472b-b2ae-9de88fc260c2): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_collected_card_price_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184444_9b993bef-7ecc-472b-b2ae-9de88fc260c2); Time taken: 0.059 seconds
INFO  : OK
No rows affected (0.162 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table priceon_collected_card_price.
Moving raw data to archive location for table priceon_collected_card_price.
priceon_collected_card_price tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 2ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.052 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327184444_e20a6a55-8754-458c-8ce0-535b70b0eb4c): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184444_e20a6a55-8754-458c-8ce0-535b70b0eb4c); Time taken: 0.106 seconds
INFO  : Executing command(queryId=hive_20180327184444_e20a6a55-8754-458c-8ce0-535b70b0eb4c): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184444_e20a6a55-8754-458c-8ce0-535b70b0eb4c); Time taken: 0.009 seconds
INFO  : OK
No rows affected (0.126 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_collected_price_raw;
INFO  : Compiling command(queryId=hive_20180327184444_de9f6b13-8df3-40e9-981f-1c4acf5d3155): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_collected_price_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184444_de9f6b13-8df3-40e9-981f-1c4acf5d3155); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327184444_de9f6b13-8df3-40e9-981f-1c4acf5d3155): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_collected_price_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184444_de9f6b13-8df3-40e9-981f-1c4acf5d3155); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.106 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_collected_price_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> priceon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> unique_code varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> pid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> gid varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> history_code bigint,
. . . . . . . . . . . . . . . . . . . . . . .> entry_site varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> entry_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> market varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> market_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> title STRING ,
. . . . . . . . . . . . . . . . . . . . . . .> option_name STRING ,
. . . . . . . . . . . . . . . . . . . . . . .> url varchar(1024),
. . . . . . . . . . . . . . . . . . . . . . .> price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_discount decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_discount_ratio decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> delivery_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> delivery_charge_type tinyint,
. . . . . . . . . . . . . . . . . . . . . . .> price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> corp_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> additional_info varchar(256),
. . . . . . . . . . . . . . . . . . . . . . .> seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> coupon_price decimal(21,2)
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184444_bfd89f41-64fa-4bb8-b407-504b5cda7d23): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_collected_price_raw
(
id varchar(32),
priceon_data_seq bigint,
unique_code varchar(64),
pid bigint,
gid varchar(64),
history_code bigint,
entry_site varchar(32),
entry_pid varchar(128),
market varchar(32),
market_pid varchar(128),
title STRING ,
option_name STRING ,
url varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sale_price_discount decimal(21,2),
sale_price_discount_ratio decimal(21,2),
delivery_price decimal(21,2),
delivery_charge_type tinyint,
price_appended_delivery decimal(21,2),
sale_price_appended_delivery decimal(21,2),
corp_seq bigint,
rtime timestamp,
additional_info varchar(256),
seq bigint,
coupon_price decimal(21,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_price_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184444_bfd89f41-64fa-4bb8-b407-504b5cda7d23); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327184444_bfd89f41-64fa-4bb8-b407-504b5cda7d23): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_collected_price_raw
(
id varchar(32),
priceon_data_seq bigint,
unique_code varchar(64),
pid bigint,
gid varchar(64),
history_code bigint,
entry_site varchar(32),
entry_pid varchar(128),
market varchar(32),
market_pid varchar(128),
title STRING ,
option_name STRING ,
url varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sale_price_discount decimal(21,2),
sale_price_discount_ratio decimal(21,2),
delivery_price decimal(21,2),
delivery_charge_type tinyint,
price_appended_delivery decimal(21,2),
sale_price_appended_delivery decimal(21,2),
corp_seq bigint,
rtime timestamp,
additional_info varchar(256),
seq bigint,
coupon_price decimal(21,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_price_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184444_bfd89f41-64fa-4bb8-b407-504b5cda7d23); Time taken: 0.119 seconds
INFO  : OK
No rows affected (0.229 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_collected_price_processed ;
INFO  : Compiling command(queryId=hive_20180327184444_74e06ec7-69e9-49c4-9df8-253ce95d9c3c): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_collected_price_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184444_74e06ec7-69e9-49c4-9df8-253ce95d9c3c); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327184444_74e06ec7-69e9-49c4-9df8-253ce95d9c3c): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_collected_price_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184444_74e06ec7-69e9-49c4-9df8-253ce95d9c3c); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.121 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_collected_price_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> priceon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> unique_code varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> pid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> gid varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> history_code bigint,
. . . . . . . . . . . . . . . . . . . . . . .> entry_site varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> entry_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> market varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> market_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> title STRING ,
. . . . . . . . . . . . . . . . . . . . . . .> option_name STRING ,
. . . . . . . . . . . . . . . . . . . . . . .> url varchar(1024),
. . . . . . . . . . . . . . . . . . . . . . .> price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_discount decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_discount_ratio decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> delivery_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> delivery_charge_type tinyint,
. . . . . . . . . . . . . . . . . . . . . . .> price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> corp_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> additional_info varchar(256),
. . . . . . . . . . . . . . . . . . . . . . .> seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> coupon_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184444_87fd7350-5c4b-40fa-b69c-8603a49fd9ed): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_collected_price_processed
(
id varchar(32),
priceon_data_seq bigint,
unique_code varchar(64),
pid bigint,
gid varchar(64),
history_code bigint,
entry_site varchar(32),
entry_pid varchar(128),
market varchar(32),
market_pid varchar(128),
title STRING ,
option_name STRING ,
url varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sale_price_discount decimal(21,2),
sale_price_discount_ratio decimal(21,2),
delivery_price decimal(21,2),
delivery_charge_type tinyint,
price_appended_delivery decimal(21,2),
sale_price_appended_delivery decimal(21,2),
corp_seq bigint,
rtime timestamp,
additional_info varchar(256),
seq bigint,
coupon_price decimal(21,2),
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_price_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184444_87fd7350-5c4b-40fa-b69c-8603a49fd9ed); Time taken: 0.09 seconds
INFO  : Executing command(queryId=hive_20180327184444_87fd7350-5c4b-40fa-b69c-8603a49fd9ed): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_collected_price_processed
(
id varchar(32),
priceon_data_seq bigint,
unique_code varchar(64),
pid bigint,
gid varchar(64),
history_code bigint,
entry_site varchar(32),
entry_pid varchar(128),
market varchar(32),
market_pid varchar(128),
title STRING ,
option_name STRING ,
url varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sale_price_discount decimal(21,2),
sale_price_discount_ratio decimal(21,2),
delivery_price decimal(21,2),
delivery_charge_type tinyint,
price_appended_delivery decimal(21,2),
sale_price_appended_delivery decimal(21,2),
corp_seq bigint,
rtime timestamp,
additional_info varchar(256),
seq bigint,
coupon_price decimal(21,2),
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_price_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184444_87fd7350-5c4b-40fa-b69c-8603a49fd9ed); Time taken: 0.243 seconds
INFO  : OK
No rows affected (0.348 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_collected_price_raw;
INFO  : Compiling command(queryId=hive_20180327184444_a1b0cbe4-1eb9-4922-945c-b577d76a4aa4): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_collected_price_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184444_a1b0cbe4-1eb9-4922-945c-b577d76a4aa4); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180327184444_a1b0cbe4-1eb9-4922-945c-b577d76a4aa4): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_collected_price_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184444_a1b0cbe4-1eb9-4922-945c-b577d76a4aa4); Time taken: 0.078 seconds
INFO  : OK
No rows affected (0.177 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.priceon_collected_price_processed PARTITION (ingestion_date  , active_flag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .>  r.id
. . . . . . . . . . . . . . . . . . . . . . .> , r.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.unique_code
. . . . . . . . . . . . . . . . . . . . . . .> , r.pid
. . . . . . . . . . . . . . . . . . . . . . .> , r.gid
. . . . . . . . . . . . . . . . . . . . . . .> , r.history_code
. . . . . . . . . . . . . . . . . . . . . . .> , r.entry_site
. . . . . . . . . . . . . . . . . . . . . . .> , r.entry_pid
. . . . . . . . . . . . . . . . . . . . . . .> , r.market
. . . . . . . . . . . . . . . . . . . . . . .> , r.market_pid
. . . . . . . . . . . . . . . . . . . . . . .> , r.title
. . . . . . . . . . . . . . . . . . . . . . .> , r.option_name
. . . . . . . . . . . . . . . . . . . . . . .> , r.url
. . . . . . . . . . . . . . . . . . . . . . .> , r.price
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price_discount
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price_discount_ratio
. . . . . . . . . . . . . . . . . . . . . . .> , r.delivery_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.delivery_charge_type
. . . . . . . . . . . . . . . . . . . . . . .> , r.price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.corp_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.rtime
. . . . . . . . . . . . . . . . . . . . . . .> , r.additional_info
. . . . . . . . . . . . . . . . . . . . . . .> , r.seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.coupon_price ,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.priceon_collected_price_raw r;
INFO  : Compiling command(queryId=hive_20180327184444_09486e94-62de-4e05-a43c-5fe622ed4881): insert into table prd_ykdl_adhoc_db.priceon_collected_price_processed PARTITION (ingestion_date , active_flag)
select
r.id
, r.priceon_data_seq
, r.unique_code
, r.pid
, r.gid
, r.history_code
, r.entry_site
, r.entry_pid
, r.market
, r.market_pid
, r.title
, r.option_name
, r.url
, r.price
, r.sale_price
, r.sale_price_discount
, r.sale_price_discount_ratio
, r.delivery_price
, r.delivery_charge_type
, r.price_appended_delivery
, r.sale_price_appended_delivery
, r.corp_seq
, r.rtime
, r.additional_info
, r.seq
, r.coupon_price ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_collected_price_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.priceon_data_seq, type:bigint, comment:null), FieldSchema(name:r.unique_code, type:varchar(64), comment:null), FieldSchema(name:r.pid, type:bigint, comment:null), FieldSchema(name:r.gid, type:varchar(64), comment:null), FieldSchema(name:r.history_code, type:bigint, comment:null), FieldSchema(name:r.entry_site, type:varchar(32), comment:null), FieldSchema(name:r.entry_pid, type:varchar(128), comment:null), FieldSchema(name:r.market, type:varchar(32), comment:null), FieldSchema(name:r.market_pid, type:varchar(128), comment:null), FieldSchema(name:r.title, type:string, comment:null), FieldSchema(name:r.option_name, type:string, comment:null), FieldSchema(name:r.url, type:varchar(1024), comment:null), FieldSchema(name:r.price, type:decimal(21,2), comment:null), FieldSchema(name:r.sale_price, type:decimal(21,2), comment:null), FieldSchema(name:r.sale_price_discount, type:decimal(21,2), comment:null), FieldSchema(name:r.sale_price_discount_ratio, type:decimal(21,2), comment:null), FieldSchema(name:r.delivery_price, type:decimal(21,2), comment:null), FieldSchema(name:r.delivery_charge_type, type:tinyint, comment:null), FieldSchema(name:r.price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.sale_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.corp_seq, type:bigint, comment:null), FieldSchema(name:r.rtime, type:timestamp, comment:null), FieldSchema(name:r.additional_info, type:varchar(256), comment:null), FieldSchema(name:r.seq, type:bigint, comment:null), FieldSchema(name:r.coupon_price, type:decimal(21,2), comment:null), FieldSchema(name:_c26, type:string, comment:null), FieldSchema(name:_c27, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c29, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184444_09486e94-62de-4e05-a43c-5fe622ed4881); Time taken: 0.212 seconds
INFO  : Executing command(queryId=hive_20180327184444_09486e94-62de-4e05-a43c-5fe622ed4881): insert into table prd_ykdl_adhoc_db.priceon_collected_price_processed PARTITION (ingestion_date , active_flag)
select
r.id
, r.priceon_data_seq
, r.unique_code
, r.pid
, r.gid
, r.history_code
, r.entry_site
, r.entry_pid
, r.market
, r.market_pid
, r.title
, r.option_name
, r.url
, r.price
, r.sale_price
, r.sale_price_discount
, r.sale_price_discount_ratio
, r.delivery_price
, r.delivery_charge_type
, r.price_appended_delivery
, r.sale_price_appended_delivery
, r.corp_seq
, r.rtime
, r.additional_info
, r.seq
, r.coupon_price ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_collected_price_raw r
INFO  : Query ID = hive_20180327184444_09486e94-62de-4e05-a43c-5fe622ed4881
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:4
INFO  : Submitting tokens for job: job_1521666602777_0932
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176277459, maxDate=1522781077459, sequenceNumber=40308, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176277408, maxDate=1522781077408, sequenceNumber=40307, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176277387, maxDate=1522781077387, sequenceNumber=27524, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0932/
INFO  : Starting Job = job_1521666602777_0932, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0932/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0932
INFO  : Hadoop job information for Stage-1: number of mappers: 4; number of reducers: 0
INFO  : 2018-03-27 18:44:45,521 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:45:45,664 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 323.64 sec
INFO  : 2018-03-27 18:46:46,622 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 676.39 sec
INFO  : 2018-03-27 18:46:57,994 Stage-1 map = 25%,  reduce = 0%, Cumulative CPU 746.97 sec
INFO  : 2018-03-27 18:46:59,029 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 750.74 sec
INFO  : 2018-03-27 18:47:12,489 Stage-1 map = 75%,  reduce = 0%, Cumulative CPU 792.91 sec
INFO  : 2018-03-27 18:47:25,990 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 819.61 sec
INFO  : MapReduce Total cumulative CPU time: 13 minutes 39 seconds 610 msec
INFO  : Ended Job = job_1521666602777_0932
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_price_processed/.hive-staging_hive_2018-03-27_18-44-37_003_3977981844253452212-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_price_processed/.hive-staging_hive_2018-03-27_18-44-37_003_3977981844253452212-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.priceon_collected_price_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_collected_price_processed/.hive-staging_hive_2018-03-27_18-44-37_003_3977981844253452212-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 121
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.priceon_collected_price_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=4, numRows=18239730, totalSize=5476978039, rawDataSize=510712440]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 4   Cumulative CPU: 819.61 sec   HDFS Read: 4533116502 HDFS Write: 5476978675 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 13 minutes 39 seconds 610 msec
INFO  : Completed executing command(queryId=hive_20180327184444_09486e94-62de-4e05-a43c-5fe622ed4881); Time taken: 170.263 seconds
INFO  : OK
No rows affected (170.496 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_collected_price_processed;
INFO  : Compiling command(queryId=hive_20180327184747_ef8a6f26-dfd8-4b24-b6fb-cfc96bd24a0a): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_collected_price_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184747_ef8a6f26-dfd8-4b24-b6fb-cfc96bd24a0a); Time taken: 0.123 seconds
INFO  : Executing command(queryId=hive_20180327184747_ef8a6f26-dfd8-4b24-b6fb-cfc96bd24a0a): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_collected_price_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184747_ef8a6f26-dfd8-4b24-b6fb-cfc96bd24a0a); Time taken: 0.058 seconds
INFO  : OK
No rows affected (0.185 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table priceon_collected_price.
Moving raw data to archive location for table priceon_collected_price.
priceon_collected_price tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.056 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327184747_24fa6576-5fd8-406e-a2ab-c8e88dae8b46): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184747_24fa6576-5fd8-406e-a2ab-c8e88dae8b46); Time taken: 0.108 seconds
INFO  : Executing command(queryId=hive_20180327184747_24fa6576-5fd8-406e-a2ab-c8e88dae8b46): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184747_24fa6576-5fd8-406e-a2ab-c8e88dae8b46); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.129 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_piece_unit_raw ;
INFO  : Compiling command(queryId=hive_20180327184747_981ba1c2-15e1-4e8d-8579-fa2399a70650): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_piece_unit_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184747_981ba1c2-15e1-4e8d-8579-fa2399a70650); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180327184747_981ba1c2-15e1-4e8d-8579-fa2399a70650): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_piece_unit_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184747_981ba1c2-15e1-4e8d-8579-fa2399a70650); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.107 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_piece_unit_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> priceon_piece_unit_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> priceon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> pid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> gid varchar(64) ,
. . . . . . . . . . . . . . . . . . . . . . .> pakcage_count int,
. . . . . . . . . . . . . . . . . . . . . . .> piece_count int,
. . . . . . . . . . . . . . . . . . . . . . .> piece_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_card_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_sale_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_card_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> total_piece int,
. . . . . . . . . . . . . . . . . . . . . . .> unit_base_size int,
. . . . . . . . . . . . . . . . . . . . . . .> unit_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_card_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_sale_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_card_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> total_unit int,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> isLowestPrice char(1),
. . . . . . . . . . . . . . . . . . . . . . .> extra_count int,
. . . . . . . . . . . . . . . . . . . . . . .> piece_coupon_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_coupon_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_coupon_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_coupon_price_appended_delivery decimal(21,2), 
. . . . . . . . . . . . . . . . . . . . . . .> certifiedLowest STRING,
. . . . . . . . . . . . . . . . . . . . . . .> uncertifiedLowest STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184747_51556b17-100f-4918-b95f-4a33273bcc5f): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_piece_unit_raw
(
priceon_piece_unit_seq bigint,
priceon_data_seq bigint,
id varchar(32) ,
pid bigint,
gid varchar(64) ,
pakcage_count int,
piece_count int,
piece_price decimal(21,2),
piece_sale_price decimal(21,2),
piece_card_price decimal(21,2),
piece_price_appended_delivery decimal(21,2),
piece_sale_price_appended_delivery decimal(21,2),
piece_card_price_appended_delivery decimal(21,2),
total_piece int,
unit_base_size int,
unit_price decimal(21,2),
unit_sale_price decimal(21,2),
unit_card_price decimal(21,2),
unit_price_appended_delivery decimal(21,2),
unit_sale_price_appended_delivery decimal(21,2),
unit_card_price_appended_delivery decimal(21,2),
total_unit int,
rtime timestamp,
isLowestPrice char(1),
extra_count int,
piece_coupon_price decimal(21,2),
piece_coupon_price_appended_delivery decimal(21,2),
unit_coupon_price decimal(21,2),
unit_coupon_price_appended_delivery decimal(21,2),
certifiedLowest STRING,
uncertifiedLowest STRING
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_piece_unit_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184747_51556b17-100f-4918-b95f-4a33273bcc5f); Time taken: 0.116 seconds
INFO  : Executing command(queryId=hive_20180327184747_51556b17-100f-4918-b95f-4a33273bcc5f): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_piece_unit_raw
(
priceon_piece_unit_seq bigint,
priceon_data_seq bigint,
id varchar(32) ,
pid bigint,
gid varchar(64) ,
pakcage_count int,
piece_count int,
piece_price decimal(21,2),
piece_sale_price decimal(21,2),
piece_card_price decimal(21,2),
piece_price_appended_delivery decimal(21,2),
piece_sale_price_appended_delivery decimal(21,2),
piece_card_price_appended_delivery decimal(21,2),
total_piece int,
unit_base_size int,
unit_price decimal(21,2),
unit_sale_price decimal(21,2),
unit_card_price decimal(21,2),
unit_price_appended_delivery decimal(21,2),
unit_sale_price_appended_delivery decimal(21,2),
unit_card_price_appended_delivery decimal(21,2),
total_unit int,
rtime timestamp,
isLowestPrice char(1),
extra_count int,
piece_coupon_price decimal(21,2),
piece_coupon_price_appended_delivery decimal(21,2),
unit_coupon_price decimal(21,2),
unit_coupon_price_appended_delivery decimal(21,2),
certifiedLowest STRING,
uncertifiedLowest STRING
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_piece_unit_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184747_51556b17-100f-4918-b95f-4a33273bcc5f); Time taken: 0.469 seconds
INFO  : OK
No rows affected (0.599 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_piece_unit_processed ; 
INFO  : Compiling command(queryId=hive_20180327184747_09057a7f-56e4-4ee2-9b73-52ff452cc0b8): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_piece_unit_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184747_09057a7f-56e4-4ee2-9b73-52ff452cc0b8); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327184747_09057a7f-56e4-4ee2-9b73-52ff452cc0b8): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_piece_unit_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184747_09057a7f-56e4-4ee2-9b73-52ff452cc0b8); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.12 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_piece_unit_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> priceon_piece_unit_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> priceon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> pid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> gid varchar(64) ,
. . . . . . . . . . . . . . . . . . . . . . .> pakcage_count int,
. . . . . . . . . . . . . . . . . . . . . . .> piece_count int,
. . . . . . . . . . . . . . . . . . . . . . .> piece_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_card_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_sale_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_card_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> total_piece int,
. . . . . . . . . . . . . . . . . . . . . . .> unit_base_size int,
. . . . . . . . . . . . . . . . . . . . . . .> unit_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_card_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_sale_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_card_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> total_unit int,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> isLowestPrice char(1),
. . . . . . . . . . . . . . . . . . . . . . .> extra_count int,
. . . . . . . . . . . . . . . . . . . . . . .> piece_coupon_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> piece_coupon_price_appended_delivery decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_coupon_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> unit_coupon_price_appended_delivery decimal(21,2), 
. . . . . . . . . . . . . . . . . . . . . . .> certifiedLowest STRING,
. . . . . . . . . . . . . . . . . . . . . . .> uncertifiedLowest STRING,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184747_b77c4879-4c46-407e-a288-c6698a2c0671): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_piece_unit_processed
(
priceon_piece_unit_seq bigint,
priceon_data_seq bigint,
id varchar(32) ,
pid bigint,
gid varchar(64) ,
pakcage_count int,
piece_count int,
piece_price decimal(21,2),
piece_sale_price decimal(21,2),
piece_card_price decimal(21,2),
piece_price_appended_delivery decimal(21,2),
piece_sale_price_appended_delivery decimal(21,2),
piece_card_price_appended_delivery decimal(21,2),
total_piece int,
unit_base_size int,
unit_price decimal(21,2),
unit_sale_price decimal(21,2),
unit_card_price decimal(21,2),
unit_price_appended_delivery decimal(21,2),
unit_sale_price_appended_delivery decimal(21,2),
unit_card_price_appended_delivery decimal(21,2),
total_unit int,
rtime timestamp,
isLowestPrice char(1),
extra_count int,
piece_coupon_price decimal(21,2),
piece_coupon_price_appended_delivery decimal(21,2),
unit_coupon_price decimal(21,2),
unit_coupon_price_appended_delivery decimal(21,2),
certifiedLowest STRING,
uncertifiedLowest STRING,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_piece_unit_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184747_b77c4879-4c46-407e-a288-c6698a2c0671); Time taken: 0.097 seconds
INFO  : Executing command(queryId=hive_20180327184747_b77c4879-4c46-407e-a288-c6698a2c0671): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_piece_unit_processed
(
priceon_piece_unit_seq bigint,
priceon_data_seq bigint,
id varchar(32) ,
pid bigint,
gid varchar(64) ,
pakcage_count int,
piece_count int,
piece_price decimal(21,2),
piece_sale_price decimal(21,2),
piece_card_price decimal(21,2),
piece_price_appended_delivery decimal(21,2),
piece_sale_price_appended_delivery decimal(21,2),
piece_card_price_appended_delivery decimal(21,2),
total_piece int,
unit_base_size int,
unit_price decimal(21,2),
unit_sale_price decimal(21,2),
unit_card_price decimal(21,2),
unit_price_appended_delivery decimal(21,2),
unit_sale_price_appended_delivery decimal(21,2),
unit_card_price_appended_delivery decimal(21,2),
total_unit int,
rtime timestamp,
isLowestPrice char(1),
extra_count int,
piece_coupon_price decimal(21,2),
piece_coupon_price_appended_delivery decimal(21,2),
unit_coupon_price decimal(21,2),
unit_coupon_price_appended_delivery decimal(21,2),
certifiedLowest STRING,
uncertifiedLowest STRING,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_piece_unit_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184747_b77c4879-4c46-407e-a288-c6698a2c0671); Time taken: 0.228 seconds
INFO  : OK
No rows affected (0.339 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_piece_unit_raw;
INFO  : Compiling command(queryId=hive_20180327184747_9ef64f2f-c771-4d5e-9820-a8c65c331ca8): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_piece_unit_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184747_9ef64f2f-c771-4d5e-9820-a8c65c331ca8); Time taken: 0.09 seconds
INFO  : Executing command(queryId=hive_20180327184747_9ef64f2f-c771-4d5e-9820-a8c65c331ca8): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_piece_unit_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184747_9ef64f2f-c771-4d5e-9820-a8c65c331ca8); Time taken: 0.08 seconds
INFO  : OK
No rows affected (0.175 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.003 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.priceon_piece_unit_processed PARTITION (ingestion_date , ac tive_flag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .>  r.priceon_piece_unit_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.id
. . . . . . . . . . . . . . . . . . . . . . .> , r.pid
. . . . . . . . . . . . . . . . . . . . . . .> , r.gid
. . . . . . . . . . . . . . . . . . . . . . .> , r.pakcage_count
. . . . . . . . . . . . . . . . . . . . . . .> , r.piece_count
. . . . . . . . . . . . . . . . . . . . . . .> , r.piece_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.piece_sale_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.piece_card_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.piece_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.piece_sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.piece_card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.total_piece
. . . . . . . . . . . . . . . . . . . . . . .> , r.unit_base_size
. . . . . . . . . . . . . . . . . . . . . . .> , r.unit_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.unit_sale_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.unit_card_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.unit_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.unit_sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.unit_card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.total_unit
. . . . . . . . . . . . . . . . . . . . . . .> , r.rtime
. . . . . . . . . . . . . . . . . . . . . . .> , r.isLowestPrice
. . . . . . . . . . . . . . . . . . . . . . .> , r.extra_count
. . . . . . . . . . . . . . . . . . . . . . .> , r.piece_coupon_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.piece_coupon_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.unit_coupon_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.unit_coupon_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , r.certifiedLowest
. . . . . . . . . . . . . . . . . . . . . . .> , r.uncertifiedLowest ,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.priceon_piece_unit_raw r;
INFO  : Compiling command(queryId=hive_20180327184747_d5520052-5ff0-4f46-bc87-e9776767890f): insert into table prd_ykdl_adhoc_db.priceon_piece_unit_processed PARTITION (ingestion_date , active_flag)
select
r.priceon_piece_unit_seq
, r.priceon_data_seq
, r.id
, r.pid
, r.gid
, r.pakcage_count
, r.piece_count
, r.piece_price
, r.piece_sale_price
, r.piece_card_price
, r.piece_price_appended_delivery
, r.piece_sale_price_appended_delivery
, r.piece_card_price_appended_delivery
, r.total_piece
, r.unit_base_size
, r.unit_price
, r.unit_sale_price
, r.unit_card_price
, r.unit_price_appended_delivery
, r.unit_sale_price_appended_delivery
, r.unit_card_price_appended_delivery
, r.total_unit
, r.rtime
, r.isLowestPrice
, r.extra_count
, r.piece_coupon_price
, r.piece_coupon_price_appended_delivery
, r.unit_coupon_price
, r.unit_coupon_price_appended_delivery
, r.certifiedLowest
, r.uncertifiedLowest ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_piece_unit_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.priceon_piece_unit_seq, type:bigint, comment:null), FieldSchema(name:r.priceon_data_seq, type:bigint, comment:null), FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.pid, type:bigint, comment:null), FieldSchema(name:r.gid, type:varchar(64), comment:null), FieldSchema(name:r.pakcage_count, type:int, comment:null), FieldSchema(name:r.piece_count, type:int, comment:null), FieldSchema(name:r.piece_price, type:decimal(21,2), comment:null), FieldSchema(name:r.piece_sale_price, type:decimal(21,2), comment:null), FieldSchema(name:r.piece_card_price, type:decimal(21,2), comment:null), FieldSchema(name:r.piece_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.piece_sale_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.piece_card_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.total_piece, type:int, comment:null), FieldSchema(name:r.unit_base_size, type:int, comment:null), FieldSchema(name:r.unit_price, type:decimal(21,2), comment:null), FieldSchema(name:r.unit_sale_price, type:decimal(21,2), comment:null), FieldSchema(name:r.unit_card_price, type:decimal(21,2), comment:null), FieldSchema(name:r.unit_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.unit_sale_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.unit_card_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.total_unit, type:int, comment:null), FieldSchema(name:r.rtime, type:timestamp, comment:null), FieldSchema(name:r.islowestprice, type:char(1), comment:null), FieldSchema(name:r.extra_count, type:int, comment:null), FieldSchema(name:r.piece_coupon_price, type:decimal(21,2), comment:null), FieldSchema(name:r.piece_coupon_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.unit_coupon_price, type:decimal(21,2), comment:null), FieldSchema(name:r.unit_coupon_price_appended_delivery, type:decimal(21,2), comment:null), FieldSchema(name:r.certifiedlowest, type:string, comment:null), FieldSchema(name:r.uncertifiedlowest, type:string, comment:null), FieldSchema(name:_c31, type:string, comment:null), FieldSchema(name:_c32, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c34, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184747_d5520052-5ff0-4f46-bc87-e9776767890f); Time taken: 0.202 seconds
INFO  : Executing command(queryId=hive_20180327184747_d5520052-5ff0-4f46-bc87-e9776767890f): insert into table prd_ykdl_adhoc_db.priceon_piece_unit_processed PARTITION (ingestion_date , active_flag)
select
r.priceon_piece_unit_seq
, r.priceon_data_seq
, r.id
, r.pid
, r.gid
, r.pakcage_count
, r.piece_count
, r.piece_price
, r.piece_sale_price
, r.piece_card_price
, r.piece_price_appended_delivery
, r.piece_sale_price_appended_delivery
, r.piece_card_price_appended_delivery
, r.total_piece
, r.unit_base_size
, r.unit_price
, r.unit_sale_price
, r.unit_card_price
, r.unit_price_appended_delivery
, r.unit_sale_price_appended_delivery
, r.unit_card_price_appended_delivery
, r.total_unit
, r.rtime
, r.isLowestPrice
, r.extra_count
, r.piece_coupon_price
, r.piece_coupon_price_appended_delivery
, r.unit_coupon_price
, r.unit_coupon_price_appended_delivery
, r.certifiedLowest
, r.uncertifiedLowest ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_piece_unit_raw r
INFO  : Query ID = hive_20180327184747_d5520052-5ff0-4f46-bc87-e9776767890f
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:3
INFO  : Submitting tokens for job: job_1521666602777_0933
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176458909, maxDate=1522781258909, sequenceNumber=40309, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176458957, maxDate=1522781258957, sequenceNumber=40310, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176458888, maxDate=1522781258888, sequenceNumber=27525, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0933/
INFO  : Starting Job = job_1521666602777_0933, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0933/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0933
INFO  : Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 0
INFO  : 2018-03-27 18:47:48,131 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:48:03,856 Stage-1 map = 33%,  reduce = 0%, Cumulative CPU 25.0 sec
INFO  : 2018-03-27 18:48:14,248 Stage-1 map = 49%,  reduce = 0%, Cumulative CPU 100.35 sec
INFO  : 2018-03-27 18:48:19,452 Stage-1 map = 83%,  reduce = 0%, Cumulative CPU 108.5 sec
INFO  : 2018-03-27 18:48:23,603 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 126.74 sec
INFO  : MapReduce Total cumulative CPU time: 2 minutes 6 seconds 740 msec
INFO  : Ended Job = job_1521666602777_0933
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_piece_unit_processed/.hive-staging_hive_2018-03-27_18-47-38_503_4165283191016992158-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_piece_unit_processed/.hive-staging_hive_2018-03-27_18-47-38_503_4165283191016992158-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.priceon_piece_unit_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_piece_unit_processed/.hive-staging_hive_2018-03-27_18-47-38_503_4165283191016992158-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 126
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.priceon_piece_unit_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=3, numRows=2310202, totalSize=420372244, rawDataSize=76236666]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 3   Cumulative CPU: 126.74 sec   HDFS Read: 114752383 HDFS Write: 420372700 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 2 minutes 6 seconds 740 msec
INFO  : Completed executing command(queryId=hive_20180327184747_d5520052-5ff0-4f46-bc87-e9776767890f); Time taken: 47.428 seconds
INFO  : OK
No rows affected (47.652 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_piece_unit_processed;
INFO  : Compiling command(queryId=hive_20180327184848_fa574fc3-f818-4727-b8ce-b49ba00a2c2b): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_piece_unit_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184848_fa574fc3-f818-4727-b8ce-b49ba00a2c2b); Time taken: 0.103 seconds
INFO  : Executing command(queryId=hive_20180327184848_fa574fc3-f818-4727-b8ce-b49ba00a2c2b): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_piece_unit_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184848_fa574fc3-f818-4727-b8ce-b49ba00a2c2b); Time taken: 0.058 seconds
INFO  : OK
No rows affected (0.166 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table priceon_piece_unit.
Moving raw data to archive location for table priceon_piece_unit.
priceon_piece_unit tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.056 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327184848_577e9b1d-1d48-4b69-983a-f249489ebcfb): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184848_577e9b1d-1d48-4b69-983a-f249489ebcfb); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327184848_577e9b1d-1d48-4b69-983a-f249489ebcfb): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184848_577e9b1d-1d48-4b69-983a-f249489ebcfb); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.131 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_sku_raw ;
INFO  : Compiling command(queryId=hive_20180327184848_cdcb9e1a-2c9d-4993-af65-f51350a3d5ec): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_sku_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184848_cdcb9e1a-2c9d-4993-af65-f51350a3d5ec); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180327184848_cdcb9e1a-2c9d-4993-af65-f51350a3d5ec): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_sku_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184848_cdcb9e1a-2c9d-4993-af65-f51350a3d5ec); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.106 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_sku_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> pid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> customer_code STRING,
. . . . . . . . . . . . . . . . . . . . . . .> title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> priceon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184848_5d40e708-df5c-4811-bc59-00b947385ecc): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_sku_raw
(
id varchar(32),
pid bigint,
customer_code STRING,
title STRING,
priceon_category_seq bigint,
rtime timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_sku_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184848_5d40e708-df5c-4811-bc59-00b947385ecc); Time taken: 0.158 seconds
INFO  : Executing command(queryId=hive_20180327184848_5d40e708-df5c-4811-bc59-00b947385ecc): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_sku_raw
(
id varchar(32),
pid bigint,
customer_code STRING,
title STRING,
priceon_category_seq bigint,
rtime timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_sku_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184848_5d40e708-df5c-4811-bc59-00b947385ecc); Time taken: 0.336 seconds
INFO  : OK
No rows affected (0.507 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.priceon_sku_processed ;
INFO  : Compiling command(queryId=hive_20180327184848_929ee270-ee4d-4dd1-95c6-eec78102ae29): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_sku_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184848_929ee270-ee4d-4dd1-95c6-eec78102ae29); Time taken: 0.113 seconds
INFO  : Executing command(queryId=hive_20180327184848_929ee270-ee4d-4dd1-95c6-eec78102ae29): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.priceon_sku_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184848_929ee270-ee4d-4dd1-95c6-eec78102ae29); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.123 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.priceon_sku_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> pid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> customer_code STRING,
. . . . . . . . . . . . . . . . . . . . . . .> title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> priceon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184848_14055607-22b4-44c6-9b5e-9bbdaf207d6b): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_sku_processed
(
id varchar(32),
pid bigint,
customer_code STRING,
title STRING,
priceon_category_seq bigint,
rtime timestamp,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_sku_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184848_14055607-22b4-44c6-9b5e-9bbdaf207d6b); Time taken: 0.09 seconds
INFO  : Executing command(queryId=hive_20180327184848_14055607-22b4-44c6-9b5e-9bbdaf207d6b): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.priceon_sku_processed
(
id varchar(32),
pid bigint,
customer_code STRING,
title STRING,
priceon_category_seq bigint,
rtime timestamp,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_sku_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184848_14055607-22b4-44c6-9b5e-9bbdaf207d6b); Time taken: 0.241 seconds
INFO  : OK
No rows affected (0.343 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_sku_raw;
INFO  : Compiling command(queryId=hive_20180327184848_425fa407-30f4-4ca0-8d0d-9b7f1bb7a4e6): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_sku_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184848_425fa407-30f4-4ca0-8d0d-9b7f1bb7a4e6); Time taken: 0.099 seconds
INFO  : Executing command(queryId=hive_20180327184848_425fa407-30f4-4ca0-8d0d-9b7f1bb7a4e6): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_sku_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184848_425fa407-30f4-4ca0-8d0d-9b7f1bb7a4e6); Time taken: 0.078 seconds
INFO  : OK
No rows affected (0.183 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert overwrite table ${hivedb}.priceon_sku_processed PARTITION (ingestion_date, activ e_flag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .> r.id ,
. . . . . . . . . . . . . . . . . . . . . . .> r.pid ,
. . . . . . . . . . . . . . . . . . . . . . .> r.customer_code ,
. . . . . . . . . . . . . . . . . . . . . . .> r.title ,
. . . . . . . . . . . . . . . . . . . . . . .> r.priceon_category_seq ,
. . . . . . . . . . . . . . . . . . . . . . .> r.rtime , 
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.priceon_sku_raw r;
INFO  : Compiling command(queryId=hive_20180327184848_ded37f90-633d-486a-b403-02cfba1471cc): insert overwrite table prd_ykdl_adhoc_db.priceon_sku_processed PARTITION (ingestion_date, active_flag)
select
r.id ,
r.pid ,
r.customer_code ,
r.title ,
r.priceon_category_seq ,
r.rtime ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_sku_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.pid, type:bigint, comment:null), FieldSchema(name:r.customer_code, type:string, comment:null), FieldSchema(name:r.title, type:string, comment:null), FieldSchema(name:r.priceon_category_seq, type:bigint, comment:null), FieldSchema(name:r.rtime, type:timestamp, comment:null), FieldSchema(name:_c6, type:string, comment:null), FieldSchema(name:_c7, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c9, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184848_ded37f90-633d-486a-b403-02cfba1471cc); Time taken: 0.183 seconds
INFO  : Executing command(queryId=hive_20180327184848_ded37f90-633d-486a-b403-02cfba1471cc): insert overwrite table prd_ykdl_adhoc_db.priceon_sku_processed PARTITION (ingestion_date, active_flag)
select
r.id ,
r.pid ,
r.customer_code ,
r.title ,
r.priceon_category_seq ,
r.rtime ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.priceon_sku_raw r
INFO  : Query ID = hive_20180327184848_ded37f90-633d-486a-b403-02cfba1471cc
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0934
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176517378, maxDate=1522781317378, sequenceNumber=40311, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176517429, maxDate=1522781317429, sequenceNumber=40312, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176517358, maxDate=1522781317358, sequenceNumber=27526, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0934/
INFO  : Starting Job = job_1521666602777_0934, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0934/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0934
INFO  : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 18:48:46,480 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:48:56,887 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 7.75 sec
INFO  : MapReduce Total cumulative CPU time: 7 seconds 750 msec
INFO  : Ended Job = job_1521666602777_0934
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_sku_processed/.hive-staging_hive_2018-03-27_18-48-36_999_513756189358650938-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_sku_processed/.hive-staging_hive_2018-03-27_18-48-36_999_513756189358650938-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.priceon_sku_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_sku_processed/.hive-staging_hive_2018-03-27_18-48-36_999_513756189358650938-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 106
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.priceon_sku_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=1, numRows=222, totalSize=17340, rawDataSize=1776]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 1   Cumulative CPU: 7.75 sec   HDFS Read: 14579 HDFS Write: 17478 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 7 seconds 750 msec
INFO  : Completed executing command(queryId=hive_20180327184848_ded37f90-633d-486a-b403-02cfba1471cc); Time taken: 21.143 seconds
INFO  : OK
No rows affected (21.35 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.priceon_sku_processed;
INFO  : Compiling command(queryId=hive_20180327184848_305552d0-be74-456c-8327-211a802e739a): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_sku_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184848_305552d0-be74-456c-8327-211a802e739a); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180327184848_305552d0-be74-456c-8327-211a802e739a): MSCK REPAIR TABLE prd_ykdl_adhoc_db.priceon_sku_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184848_305552d0-be74-456c-8327-211a802e739a); Time taken: 0.056 seconds
INFO  : OK
No rows affected (0.157 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table priceon_sku.
Moving raw data to archive location for table priceon_sku.
priceon_sku tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 2ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.047 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327184949_966bb3f1-b8de-46de-9684-57d4e80b4ba5): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184949_966bb3f1-b8de-46de-9684-57d4e80b4ba5); Time taken: 0.12 seconds
INFO  : Executing command(queryId=hive_20180327184949_966bb3f1-b8de-46de-9684-57d4e80b4ba5): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184949_966bb3f1-b8de-46de-9684-57d4e80b4ba5); Time taken: 0.011 seconds
INFO  : OK
No rows affected (0.139 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_attr_raw ; 
INFO  : Compiling command(queryId=hive_20180327184949_25e61cc6-c98c-42fd-ad1f-a35d66c68bac): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_attr_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184949_25e61cc6-c98c-42fd-ad1f-a35d66c68bac); Time taken: 0.099 seconds
INFO  : Executing command(queryId=hive_20180327184949_25e61cc6-c98c-42fd-ad1f-a35d66c68bac): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_attr_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184949_25e61cc6-c98c-42fd-ad1f-a35d66c68bac); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.109 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_attr_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_attr_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> title string,
. . . . . . . . . . . . . . . . . . . . . . .> hashcode varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> category string,
. . . . . . . . . . . . . . . . . . . . . . .> madeby string,
. . . . . . . . . . . . . . . . . . . . . . .> brand string,
. . . . . . . . . . . . . . . . . . . . . . .> subbrand string,
. . . . . . . . . . . . . . . . . . . . . . .> option_name string
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184949_5f9c55bd-4e49-4c0f-a7b7-0df3c0d2a882): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_attr_raw
(
shelfon_attr_seq bigint,
id varchar(32),
title string,
hashcode varchar(32),
category string,
madeby string,
brand string,
subbrand string,
option_name string
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_attr_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184949_5f9c55bd-4e49-4c0f-a7b7-0df3c0d2a882); Time taken: 0.098 seconds
INFO  : Executing command(queryId=hive_20180327184949_5f9c55bd-4e49-4c0f-a7b7-0df3c0d2a882): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_attr_raw
(
shelfon_attr_seq bigint,
id varchar(32),
title string,
hashcode varchar(32),
category string,
madeby string,
brand string,
subbrand string,
option_name string
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_attr_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184949_5f9c55bd-4e49-4c0f-a7b7-0df3c0d2a882); Time taken: 0.208 seconds
INFO  : OK
No rows affected (0.318 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_attr_processed ;
INFO  : Compiling command(queryId=hive_20180327184949_b6835e87-080e-485d-9643-9660caa8d8a8): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_attr_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184949_b6835e87-080e-485d-9643-9660caa8d8a8); Time taken: 0.115 seconds
INFO  : Executing command(queryId=hive_20180327184949_b6835e87-080e-485d-9643-9660caa8d8a8): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_attr_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184949_b6835e87-080e-485d-9643-9660caa8d8a8); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.126 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_attr_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_attr_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> title string,
. . . . . . . . . . . . . . . . . . . . . . .> hashcode varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> category string,
. . . . . . . . . . . . . . . . . . . . . . .> madeby string,
. . . . . . . . . . . . . . . . . . . . . . .> brand string,
. . . . . . . . . . . . . . . . . . . . . . .> subbrand string,
. . . . . . . . . . . . . . . . . . . . . . .> option_name string,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327184949_07164e99-f1da-4a71-a557-ebb1164e797b): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_attr_processed
(
shelfon_attr_seq bigint,
id varchar(32),
title string,
hashcode varchar(32),
category string,
madeby string,
brand string,
subbrand string,
option_name string,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_attr_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184949_07164e99-f1da-4a71-a557-ebb1164e797b); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327184949_07164e99-f1da-4a71-a557-ebb1164e797b): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_attr_processed
(
shelfon_attr_seq bigint,
id varchar(32),
title string,
hashcode varchar(32),
category string,
madeby string,
brand string,
subbrand string,
option_name string,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_attr_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184949_07164e99-f1da-4a71-a557-ebb1164e797b); Time taken: 0.232 seconds
INFO  : OK
No rows affected (0.339 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from RAW table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_attr_raw;
INFO  : Compiling command(queryId=hive_20180327184949_c5523207-a78e-4b1a-a5f9-59252cf1e888): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_attr_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184949_c5523207-a78e-4b1a-a5f9-59252cf1e888); Time taken: 0.098 seconds
INFO  : Executing command(queryId=hive_20180327184949_c5523207-a78e-4b1a-a5f9-59252cf1e888): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_attr_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184949_c5523207-a78e-4b1a-a5f9-59252cf1e888); Time taken: 0.083 seconds
INFO  : OK
No rows affected (0.184 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.003 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.shelfon_attr_processed PARTITION (ingestion_date , active_f lag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .> r.shelfon_attr_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.id
. . . . . . . . . . . . . . . . . . . . . . .> , r.title
. . . . . . . . . . . . . . . . . . . . . . .> , r.hashcode
. . . . . . . . . . . . . . . . . . . . . . .> , r.category
. . . . . . . . . . . . . . . . . . . . . . .> , r.madeby
. . . . . . . . . . . . . . . . . . . . . . .> , r.brand
. . . . . . . . . . . . . . . . . . . . . . .> , r.subbrand
. . . . . . . . . . . . . . . . . . . . . . .> , r.option_name,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.shelfon_attr_raw r;
INFO  : Compiling command(queryId=hive_20180327184949_262b77bf-8f25-4f6d-ac43-615344886978): insert into table prd_ykdl_adhoc_db.shelfon_attr_processed PARTITION (ingestion_date , active_flag)
select
r.shelfon_attr_seq
, r.id
, r.title
, r.hashcode
, r.category
, r.madeby
, r.brand
, r.subbrand
, r.option_name,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_attr_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.shelfon_attr_seq, type:bigint, comment:null), FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.title, type:string, comment:null), FieldSchema(name:r.hashcode, type:varchar(32), comment:null), FieldSchema(name:r.category, type:string, comment:null), FieldSchema(name:r.madeby, type:string, comment:null), FieldSchema(name:r.brand, type:string, comment:null), FieldSchema(name:r.subbrand, type:string, comment:null), FieldSchema(name:r.option_name, type:string, comment:null), FieldSchema(name:_c9, type:string, comment:null), FieldSchema(name:_c10, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c12, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184949_262b77bf-8f25-4f6d-ac43-615344886978); Time taken: 0.215 seconds
INFO  : Executing command(queryId=hive_20180327184949_262b77bf-8f25-4f6d-ac43-615344886978): insert into table prd_ykdl_adhoc_db.shelfon_attr_processed PARTITION (ingestion_date , active_flag)
select
r.shelfon_attr_seq
, r.id
, r.title
, r.hashcode
, r.category
, r.madeby
, r.brand
, r.subbrand
, r.option_name,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_attr_raw r
INFO  : Query ID = hive_20180327184949_262b77bf-8f25-4f6d-ac43-615344886978
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:4
INFO  : Submitting tokens for job: job_1521666602777_0935
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176549403, maxDate=1522781349403, sequenceNumber=40313, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176549450, maxDate=1522781349450, sequenceNumber=40314, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176549383, maxDate=1522781349383, sequenceNumber=27527, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0935/
INFO  : Starting Job = job_1521666602777_0935, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0935/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0935
INFO  : Hadoop job information for Stage-1: number of mappers: 4; number of reducers: 0
INFO  : 2018-03-27 18:49:18,507 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:49:39,359 Stage-1 map = 25%,  reduce = 0%, Cumulative CPU 102.84 sec
INFO  : 2018-03-27 18:49:42,473 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 108.15 sec
INFO  : 2018-03-27 18:49:48,686 Stage-1 map = 75%,  reduce = 0%, Cumulative CPU 132.38 sec
INFO  : 2018-03-27 18:49:54,899 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 146.61 sec
INFO  : MapReduce Total cumulative CPU time: 2 minutes 26 seconds 610 msec
INFO  : Ended Job = job_1521666602777_0935
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_attr_processed/.hive-staging_hive_2018-03-27_18-49-09_002_1349590549816635830-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_attr_processed/.hive-staging_hive_2018-03-27_18-49-09_002_1349590549816635830-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.shelfon_attr_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_attr_processed/.hive-staging_hive_2018-03-27_18-49-09_002_1349590549816635830-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 115
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.shelfon_attr_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=4, numRows=7022374, totalSize=920040039, rawDataSize=77246114]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 4   Cumulative CPU: 146.61 sec   HDFS Read: 421531881 HDFS Write: 920040626 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 2 minutes 26 seconds 610 msec
INFO  : Completed executing command(queryId=hive_20180327184949_262b77bf-8f25-4f6d-ac43-615344886978); Time taken: 47.167 seconds
INFO  : OK
No rows affected (47.404 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_attr_processed;
INFO  : Compiling command(queryId=hive_20180327184949_5b3adad4-3ead-4762-9c43-8d6bfff99a70): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_attr_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327184949_5b3adad4-3ead-4762-9c43-8d6bfff99a70); Time taken: 0.101 seconds
INFO  : Executing command(queryId=hive_20180327184949_5b3adad4-3ead-4762-9c43-8d6bfff99a70): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_attr_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327184949_5b3adad4-3ead-4762-9c43-8d6bfff99a70); Time taken: 0.057 seconds
INFO  : OK
No rows affected (0.165 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table shelfon_attr.
Moving raw data to archive location for table shelfon_attr.
shelfon_attr tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.058 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327185050_dd94fb96-2055-47a3-b976-7f65a45ee3b0): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_dd94fb96-2055-47a3-b976-7f65a45ee3b0); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327185050_dd94fb96-2055-47a3-b976-7f65a45ee3b0): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_dd94fb96-2055-47a3-b976-7f65a45ee3b0); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.13 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_category_raw ;
INFO  : Compiling command(queryId=hive_20180327185050_9e0d38ff-621f-4c5f-9ef4-e37e10d1c8bd): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_category_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_9e0d38ff-621f-4c5f-9ef4-e37e10d1c8bd); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180327185050_9e0d38ff-621f-4c5f-9ef4-e37e10d1c8bd): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_category_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_9e0d38ff-621f-4c5f-9ef4-e37e10d1c8bd); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.106 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_category_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> pseq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> name string
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185050_58bdc26b-5f94-424c-a101-7f613cf9a657): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_category_raw
(
shelfon_category_seq bigint,
id varchar(32),
pseq bigint,
name string
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_category_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_58bdc26b-5f94-424c-a101-7f613cf9a657); Time taken: 0.091 seconds
INFO  : Executing command(queryId=hive_20180327185050_58bdc26b-5f94-424c-a101-7f613cf9a657): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_category_raw
(
shelfon_category_seq bigint,
id varchar(32),
pseq bigint,
name string
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_category_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_58bdc26b-5f94-424c-a101-7f613cf9a657); Time taken: 0.074 seconds
INFO  : OK
No rows affected (0.179 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_category_processed ; 
INFO  : Compiling command(queryId=hive_20180327185050_bc05202f-ec6d-43b4-b2ba-056bff538049): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_category_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_bc05202f-ec6d-43b4-b2ba-056bff538049); Time taken: 0.106 seconds
INFO  : Executing command(queryId=hive_20180327185050_bc05202f-ec6d-43b4-b2ba-056bff538049): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_category_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_bc05202f-ec6d-43b4-b2ba-056bff538049); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.117 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_category_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> pseq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> name string,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185050_d9d2a9a3-5934-4f1e-8bda-eaf95d748ebf): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_category_processed
(
shelfon_category_seq bigint,
id varchar(32),
pseq bigint,
name string,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_category_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_d9d2a9a3-5934-4f1e-8bda-eaf95d748ebf); Time taken: 0.092 seconds
INFO  : Executing command(queryId=hive_20180327185050_d9d2a9a3-5934-4f1e-8bda-eaf95d748ebf): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_category_processed
(
shelfon_category_seq bigint,
id varchar(32),
pseq bigint,
name string,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_category_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_d9d2a9a3-5934-4f1e-8bda-eaf95d748ebf); Time taken: 0.252 seconds
INFO  : OK
No rows affected (0.357 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_category_raw;
INFO  : Compiling command(queryId=hive_20180327185050_5412de17-3846-482f-9e32-58051b22cae6): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_category_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_5412de17-3846-482f-9e32-58051b22cae6); Time taken: 0.093 seconds
INFO  : Executing command(queryId=hive_20180327185050_5412de17-3846-482f-9e32-58051b22cae6): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_category_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_5412de17-3846-482f-9e32-58051b22cae6); Time taken: 0.079 seconds
INFO  : OK
No rows affected (0.176 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.003 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.shelfon_category_processed PARTITION (ingestion_date , acti ve_flag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .> r.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.id
. . . . . . . . . . . . . . . . . . . . . . .> , r.pseq
. . . . . . . . . . . . . . . . . . . . . . .> , r.name ,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.shelfon_category_raw r;
INFO  : Compiling command(queryId=hive_20180327185050_77d1fe79-5bec-4cc5-b824-be28356fcf4d): insert into table prd_ykdl_adhoc_db.shelfon_category_processed PARTITION (ingestion_date , active_flag)
select
r.shelfon_category_seq
, r.id
, r.pseq
, r.name ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_category_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.shelfon_category_seq, type:bigint, comment:null), FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.pseq, type:bigint, comment:null), FieldSchema(name:r.name, type:string, comment:null), FieldSchema(name:_c4, type:string, comment:null), FieldSchema(name:_c5, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c7, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_77d1fe79-5bec-4cc5-b824-be28356fcf4d); Time taken: 0.207 seconds
INFO  : Executing command(queryId=hive_20180327185050_77d1fe79-5bec-4cc5-b824-be28356fcf4d): insert into table prd_ykdl_adhoc_db.shelfon_category_processed PARTITION (ingestion_date , active_flag)
select
r.shelfon_category_seq
, r.id
, r.pseq
, r.name ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_category_raw r
INFO  : Query ID = hive_20180327185050_77d1fe79-5bec-4cc5-b824-be28356fcf4d
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:2
INFO  : Submitting tokens for job: job_1521666602777_0936
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176607459, maxDate=1522781407459, sequenceNumber=40316, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176607406, maxDate=1522781407406, sequenceNumber=40315, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176607386, maxDate=1522781407386, sequenceNumber=27528, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0936/
INFO  : Starting Job = job_1521666602777_0936, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0936/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0936
INFO  : Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 0
INFO  : 2018-03-27 18:50:16,527 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:50:25,920 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 6.46 sec
INFO  : 2018-03-27 18:50:26,963 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 14.31 sec
INFO  : MapReduce Total cumulative CPU time: 14 seconds 310 msec
INFO  : Ended Job = job_1521666602777_0936
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_category_processed/.hive-staging_hive_2018-03-27_18-50-06_999_5709043172763498871-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_category_processed/.hive-staging_hive_2018-03-27_18-50-06_999_5709043172763498871-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.shelfon_category_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_category_processed/.hive-staging_hive_2018-03-27_18-50-06_999_5709043172763498871-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 117
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.shelfon_category_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=1, numRows=30, totalSize=1685, rawDataSize=180]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 2   Cumulative CPU: 14.31 sec   HDFS Read: 12876 HDFS Write: 1828 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 14 seconds 310 msec
INFO  : Completed executing command(queryId=hive_20180327185050_77d1fe79-5bec-4cc5-b824-be28356fcf4d); Time taken: 21.224 seconds
INFO  : OK
No rows affected (21.456 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_category_processed;
INFO  : Compiling command(queryId=hive_20180327185050_83f29060-455d-4c3e-82df-854973cdef16): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_category_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_83f29060-455d-4c3e-82df-854973cdef16); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180327185050_83f29060-455d-4c3e-82df-854973cdef16): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_category_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_83f29060-455d-4c3e-82df-854973cdef16); Time taken: 0.055 seconds
INFO  : OK
No rows affected (0.155 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table shelfon_category.
Moving raw data to archive location for table shelfon_category.
shelfon_category tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.048 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327185050_41f6f67f-0e0b-47a5-bdca-b9dfc2fb9ad7): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_41f6f67f-0e0b-47a5-bdca-b9dfc2fb9ad7); Time taken: 0.107 seconds
INFO  : Executing command(queryId=hive_20180327185050_41f6f67f-0e0b-47a5-bdca-b9dfc2fb9ad7): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_41f6f67f-0e0b-47a5-bdca-b9dfc2fb9ad7); Time taken: 0.011 seconds
INFO  : OK
No rows affected (0.127 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_collected_option_data_raw ;  
INFO  : Compiling command(queryId=hive_20180327185050_339707e3-a90d-4e35-8a86-b727dff60925): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_collected_option_data_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_339707e3-a90d-4e35-8a86-b727dff60925); Time taken: 0.097 seconds
INFO  : Executing command(queryId=hive_20180327185050_339707e3-a90d-4e35-8a86-b727dff60925): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_collected_option_data_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_339707e3-a90d-4e35-8a86-b727dff60925); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.106 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_collected_option_data_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_option_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> npid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> ngid varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> npgid varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> site varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> site_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> option_name varchar(1024),
. . . . . . . . . . . . . . . . . . . . . . .> price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sold_out tinyint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185050_eb66b4d3-5b1d-42e8-b5a5-e4e79444840a): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_collected_option_data_raw
(
shelfon_option_data_seq bigint,
shelfon_data_seq bigint,
id varchar(32),
npid bigint,
ngid varchar(64),
npgid varchar(32),
site varchar(32),
site_pid varchar(128),
option_name varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sold_out tinyint,
rtime timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_option_data_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_eb66b4d3-5b1d-42e8-b5a5-e4e79444840a); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327185050_eb66b4d3-5b1d-42e8-b5a5-e4e79444840a): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_collected_option_data_raw
(
shelfon_option_data_seq bigint,
shelfon_data_seq bigint,
id varchar(32),
npid bigint,
ngid varchar(64),
npgid varchar(32),
site varchar(32),
site_pid varchar(128),
option_name varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sold_out tinyint,
rtime timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_option_data_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_eb66b4d3-5b1d-42e8-b5a5-e4e79444840a); Time taken: 0.557 seconds
INFO  : OK
No rows affected (0.665 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_collected_option_data_processed ;
INFO  : Compiling command(queryId=hive_20180327185050_d3b959ba-8321-4d39-8136-e4391682ed94): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_collected_option_data_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_d3b959ba-8321-4d39-8136-e4391682ed94); Time taken: 0.107 seconds
INFO  : Executing command(queryId=hive_20180327185050_d3b959ba-8321-4d39-8136-e4391682ed94): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_collected_option_data_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_d3b959ba-8321-4d39-8136-e4391682ed94); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.117 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_collected_option_data_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_option_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> npid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> ngid varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> npgid varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> site varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> site_pid varchar(128),
. . . . . . . . . . . . . . . . . . . . . . .> option_name varchar(1024),
. . . . . . . . . . . . . . . . . . . . . . .> price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> sold_out tinyint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185050_b173b526-414a-46ce-9bfa-37b6825d29b0): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_collected_option_data_processed
(
shelfon_option_data_seq bigint,
shelfon_data_seq bigint,
id varchar(32),
npid bigint,
ngid varchar(64),
npgid varchar(32),
site varchar(32),
site_pid varchar(128),
option_name varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sold_out tinyint,
rtime timestamp,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_option_data_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_b173b526-414a-46ce-9bfa-37b6825d29b0); Time taken: 0.159 seconds
INFO  : Executing command(queryId=hive_20180327185050_b173b526-414a-46ce-9bfa-37b6825d29b0): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_collected_option_data_processed
(
shelfon_option_data_seq bigint,
shelfon_data_seq bigint,
id varchar(32),
npid bigint,
ngid varchar(64),
npgid varchar(32),
site varchar(32),
site_pid varchar(128),
option_name varchar(1024),
price decimal(21,2),
sale_price decimal(21,2),
sold_out tinyint,
rtime timestamp,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_option_data_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_b173b526-414a-46ce-9bfa-37b6825d29b0); Time taken: 0.177 seconds
INFO  : OK
No rows affected (0.349 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_collected_option_data_raw;
INFO  : Compiling command(queryId=hive_20180327185050_8b192fe3-62dc-47ec-8fb6-037d548cdc21): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_collected_option_data_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_8b192fe3-62dc-47ec-8fb6-037d548cdc21); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180327185050_8b192fe3-62dc-47ec-8fb6-037d548cdc21): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_collected_option_data_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185050_8b192fe3-62dc-47ec-8fb6-037d548cdc21); Time taken: 0.08 seconds
INFO  : OK
No rows affected (0.182 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.shelfon_collected_option_data_processed PARTITION (ingestio n_date , active_flag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .>  r.shelfon_option_data_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.id
. . . . . . . . . . . . . . . . . . . . . . .> , r.npid
. . . . . . . . . . . . . . . . . . . . . . .> , r.ngid
. . . . . . . . . . . . . . . . . . . . . . .> , r.npgid
. . . . . . . . . . . . . . . . . . . . . . .> , r.site
. . . . . . . . . . . . . . . . . . . . . . .> , r.site_pid
. . . . . . . . . . . . . . . . . . . . . . .> , r.option_name
. . . . . . . . . . . . . . . . . . . . . . .> , r.price
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.sold_out
. . . . . . . . . . . . . . . . . . . . . . .> , r.rtime ,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.shelfon_collected_option_data_raw r;
INFO  : Compiling command(queryId=hive_20180327185050_6a1744ab-5db0-4087-9f09-aa7a45a455ae): insert into table prd_ykdl_adhoc_db.shelfon_collected_option_data_processed PARTITION (ingestion_date , active_flag)
select
r.shelfon_option_data_seq
, r.shelfon_data_seq
, r.id
, r.npid
, r.ngid
, r.npgid
, r.site
, r.site_pid
, r.option_name
, r.price
, r.sale_price
, r.sold_out
, r.rtime ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_collected_option_data_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.shelfon_option_data_seq, type:bigint, comment:null), FieldSchema(name:r.shelfon_data_seq, type:bigint, comment:null), FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.npid, type:bigint, comment:null), FieldSchema(name:r.ngid, type:varchar(64), comment:null), FieldSchema(name:r.npgid, type:varchar(32), comment:null), FieldSchema(name:r.site, type:varchar(32), comment:null), FieldSchema(name:r.site_pid, type:varchar(128), comment:null), FieldSchema(name:r.option_name, type:varchar(1024), comment:null), FieldSchema(name:r.price, type:decimal(21,2), comment:null), FieldSchema(name:r.sale_price, type:decimal(21,2), comment:null), FieldSchema(name:r.sold_out, type:tinyint, comment:null), FieldSchema(name:r.rtime, type:timestamp, comment:null), FieldSchema(name:_c13, type:string, comment:null), FieldSchema(name:_c14, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c16, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185050_6a1744ab-5db0-4087-9f09-aa7a45a455ae); Time taken: 0.223 seconds
INFO  : Executing command(queryId=hive_20180327185050_6a1744ab-5db0-4087-9f09-aa7a45a455ae): insert into table prd_ykdl_adhoc_db.shelfon_collected_option_data_processed PARTITION (ingestion_date , active_flag)
select
r.shelfon_option_data_seq
, r.shelfon_data_seq
, r.id
, r.npid
, r.ngid
, r.npgid
, r.site
, r.site_pid
, r.option_name
, r.price
, r.sale_price
, r.sold_out
, r.rtime ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_collected_option_data_raw r
INFO  : Query ID = hive_20180327185050_6a1744ab-5db0-4087-9f09-aa7a45a455ae
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:8
INFO  : Submitting tokens for job: job_1521666602777_0937
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176639907, maxDate=1522781439907, sequenceNumber=40317, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176639954, maxDate=1522781439954, sequenceNumber=40318, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176639887, maxDate=1522781439887, sequenceNumber=27529, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0937/
INFO  : Starting Job = job_1521666602777_0937, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0937/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0937
INFO  : Hadoop job information for Stage-1: number of mappers: 8; number of reducers: 0
INFO  : 2018-03-27 18:50:49,002 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:51:40,879 Stage-1 map = 1%,  reduce = 0%, Cumulative CPU 530.67 sec
INFO  : 2018-03-27 18:51:47,097 Stage-1 map = 3%,  reduce = 0%, Cumulative CPU 609.27 sec
INFO  : 2018-03-27 18:52:47,132 Stage-1 map = 3%,  reduce = 0%, Cumulative CPU 1224.71 sec
INFO  : 2018-03-27 18:53:03,674 Stage-1 map = 16%,  reduce = 0%, Cumulative CPU 1427.75 sec
INFO  : 2018-03-27 18:54:04,640 Stage-1 map = 16%,  reduce = 0%, Cumulative CPU 2011.09 sec
INFO  : 2018-03-27 18:55:05,589 Stage-1 map = 16%,  reduce = 0%, Cumulative CPU 2622.29 sec
INFO  : 2018-03-27 18:55:31,419 Stage-1 map = 28%,  reduce = 0%, Cumulative CPU 2861.47 sec
INFO  : 2018-03-27 18:55:32,451 Stage-1 map = 41%,  reduce = 0%, Cumulative CPU 2903.08 sec
INFO  : 2018-03-27 18:55:38,647 Stage-1 map = 53%,  reduce = 0%, Cumulative CPU 2952.7 sec
INFO  : 2018-03-27 18:55:39,685 Stage-1 map = 66%,  reduce = 0%, Cumulative CPU 2954.78 sec
INFO  : 2018-03-27 18:55:41,757 Stage-1 map = 78%,  reduce = 0%, Cumulative CPU 2958.93 sec
INFO  : 2018-03-27 18:56:07,579 Stage-1 map = 89%,  reduce = 0%, Cumulative CPU 3038.5 sec
INFO  : 2018-03-27 18:56:14,819 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 3055.74 sec
INFO  : MapReduce Total cumulative CPU time: 50 minutes 55 seconds 740 msec
INFO  : Ended Job = job_1521666602777_0937
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_option_data_processed/.hive-staging_hive_2018-03-27_18-50-39_495_4004175150873104776-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_option_data_processed/.hive-staging_hive_2018-03-27_18-50-39_495_4004175150873104776-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.shelfon_collected_option_data_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_option_data_processed/.hive-staging_hive_2018-03-27_18-50-39_495_4004175150873104776-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 160
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.shelfon_collected_option_data_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=8, numRows=141532004, totalSize=12981580520, rawDataSize=2122980060]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 8   Cumulative CPU: 3055.74 sec   HDFS Read: 4775195781 HDFS Write: 12981581847 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 50 minutes 55 seconds 740 msec
INFO  : Completed executing command(queryId=hive_20180327185050_6a1744ab-5db0-4087-9f09-aa7a45a455ae); Time taken: 336.684 seconds
INFO  : OK
No rows affected (336.927 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_collected_option_data_processed;
INFO  : Compiling command(queryId=hive_20180327185656_ed977743-d2a4-4250-a05b-aa04497d0ab8): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_collected_option_data_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185656_ed977743-d2a4-4250-a05b-aa04497d0ab8); Time taken: 0.121 seconds
INFO  : Executing command(queryId=hive_20180327185656_ed977743-d2a4-4250-a05b-aa04497d0ab8): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_collected_option_data_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185656_ed977743-d2a4-4250-a05b-aa04497d0ab8); Time taken: 0.057 seconds
INFO  : OK
No rows affected (0.183 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table shelfon_collected_option_data.
Moving raw data to archive location for table shelfon_collected_option_data.
shelfon_collected_option_data tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 2ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.056 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327185656_0e6d51c0-e711-4ecd-a7c7-aacc4de6e911): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185656_0e6d51c0-e711-4ecd-a7c7-aacc4de6e911); Time taken: 0.109 seconds
INFO  : Executing command(queryId=hive_20180327185656_0e6d51c0-e711-4ecd-a7c7-aacc4de6e911): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185656_0e6d51c0-e711-4ecd-a7c7-aacc4de6e911); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.129 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_item_raw ;
INFO  : Compiling command(queryId=hive_20180327185656_d94d98e8-990b-4991-a198-f1ade6828700): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_item_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185656_d94d98e8-990b-4991-a198-f1ade6828700); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180327185656_d94d98e8-990b-4991-a198-f1ade6828700): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_item_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185656_d94d98e8-990b-4991-a198-f1ade6828700); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.103 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_item_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> npid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185656_04e44052-29e6-4a9d-aeb9-22dc1c47f33e): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_item_raw
(
id varchar(32),
npid bigint,
title STRING,
shelfon_category_seq bigint,
rtime timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185656_04e44052-29e6-4a9d-aeb9-22dc1c47f33e); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327185656_04e44052-29e6-4a9d-aeb9-22dc1c47f33e): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_item_raw
(
id varchar(32),
npid bigint,
title STRING,
shelfon_category_seq bigint,
rtime timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185656_04e44052-29e6-4a9d-aeb9-22dc1c47f33e); Time taken: 0.192 seconds
INFO  : OK
No rows affected (0.316 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_item_processed ;
INFO  : Compiling command(queryId=hive_20180327185656_017d1991-2407-428d-bf55-4e1d38357bab): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_item_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185656_017d1991-2407-428d-bf55-4e1d38357bab); Time taken: 0.113 seconds
INFO  : Executing command(queryId=hive_20180327185656_017d1991-2407-428d-bf55-4e1d38357bab): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_item_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185656_017d1991-2407-428d-bf55-4e1d38357bab); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.123 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_item_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> npid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, ACTIVE_FLAG STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185656_1c8645ec-ebc9-4581-a630-0762244dbc76): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_item_processed
(
id varchar(32),
npid bigint,
title STRING,
shelfon_category_seq bigint,
rtime timestamp,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, ACTIVE_FLAG STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185656_1c8645ec-ebc9-4581-a630-0762244dbc76); Time taken: 0.098 seconds
INFO  : Executing command(queryId=hive_20180327185656_1c8645ec-ebc9-4581-a630-0762244dbc76): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_item_processed
(
id varchar(32),
npid bigint,
title STRING,
shelfon_category_seq bigint,
rtime timestamp,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, ACTIVE_FLAG STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185656_1c8645ec-ebc9-4581-a630-0762244dbc76); Time taken: 0.241 seconds
INFO  : OK
No rows affected (0.352 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_item_raw;
INFO  : Compiling command(queryId=hive_20180327185656_40b72aef-6cd5-4370-8ad2-b10a394ef5a6): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_item_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185656_40b72aef-6cd5-4370-8ad2-b10a394ef5a6); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327185656_40b72aef-6cd5-4370-8ad2-b10a394ef5a6): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_item_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185656_40b72aef-6cd5-4370-8ad2-b10a394ef5a6); Time taken: 0.074 seconds
INFO  : OK
No rows affected (0.174 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.shelfon_item_processed PARTITION (ingestion_date , active_f lag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .>  r.id
. . . . . . . . . . . . . . . . . . . . . . .> , r.npid
. . . . . . . . . . . . . . . . . . . . . . .> , r.title
. . . . . . . . . . . . . . . . . . . . . . .> , r.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.rtime ,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.shelfon_item_raw r;
INFO  : Compiling command(queryId=hive_20180327185656_58f3f814-e315-4bd4-8cd8-d3342df69517): insert into table prd_ykdl_adhoc_db.shelfon_item_processed PARTITION (ingestion_date , active_flag)
select
r.id
, r.npid
, r.title
, r.shelfon_category_seq
, r.rtime ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_item_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.npid, type:bigint, comment:null), FieldSchema(name:r.title, type:string, comment:null), FieldSchema(name:r.shelfon_category_seq, type:bigint, comment:null), FieldSchema(name:r.rtime, type:timestamp, comment:null), FieldSchema(name:_c5, type:string, comment:null), FieldSchema(name:_c6, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c8, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185656_58f3f814-e315-4bd4-8cd8-d3342df69517); Time taken: 0.212 seconds
INFO  : Executing command(queryId=hive_20180327185656_58f3f814-e315-4bd4-8cd8-d3342df69517): insert into table prd_ykdl_adhoc_db.shelfon_item_processed PARTITION (ingestion_date , active_flag)
select
r.id
, r.npid
, r.title
, r.shelfon_category_seq
, r.rtime ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_item_raw r
INFO  : Query ID = hive_20180327185656_58f3f814-e315-4bd4-8cd8-d3342df69517
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:2
INFO  : Submitting tokens for job: job_1521666602777_0938
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176987480, maxDate=1522781787480, sequenceNumber=40320, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522176987428, maxDate=1522781787428, sequenceNumber=40319, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522176987407, maxDate=1522781787407, sequenceNumber=27530, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0938/
INFO  : Starting Job = job_1521666602777_0938, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0938/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0938
INFO  : Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 0
INFO  : 2018-03-27 18:56:36,543 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:56:46,959 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 14.3 sec
INFO  : MapReduce Total cumulative CPU time: 14 seconds 300 msec
INFO  : Ended Job = job_1521666602777_0938
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is filtered out by condition resolver.
INFO  : Stage-3 is selected by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Launching Job 3 out of 3
INFO  : Starting task [Stage-3:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0939
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177009246, maxDate=1522781809246, sequenceNumber=40321, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177009292, maxDate=1522781809292, sequenceNumber=40322, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177009226, maxDate=1522781809226, sequenceNumber=27531, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0939/
INFO  : Starting Job = job_1521666602777_0939, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0939/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0939
INFO  : Hadoop job information for Stage-3: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 18:56:58,320 Stage-3 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:57:07,674 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 7.41 sec
INFO  : MapReduce Total cumulative CPU time: 7 seconds 410 msec
INFO  : Ended Job = job_1521666602777_0939
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.shelfon_item_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_processed/.hive-staging_hive_2018-03-27_18-56-26_992_3139974176785515678-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 109
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.shelfon_item_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=1, numRows=177, totalSize=10177, rawDataSize=1239]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 2   Cumulative CPU: 14.3 sec   HDFS Read: 17030 HDFS Write: 11573 SUCCESS
INFO  : Stage-Stage-3: Map: 1   Cumulative CPU: 7.41 sec   HDFS Read: 17712 HDFS Write: 10177 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 21 seconds 710 msec
INFO  : Completed executing command(queryId=hive_20180327185656_58f3f814-e315-4bd4-8cd8-d3342df69517); Time taken: 42.938 seconds
INFO  : OK
No rows affected (43.173 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_item_processed;
INFO  : Compiling command(queryId=hive_20180327185757_e1ecced0-6e69-4b4f-8eb5-ddda36a807af): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_item_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_e1ecced0-6e69-4b4f-8eb5-ddda36a807af); Time taken: 0.101 seconds
INFO  : Executing command(queryId=hive_20180327185757_e1ecced0-6e69-4b4f-8eb5-ddda36a807af): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_item_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_e1ecced0-6e69-4b4f-8eb5-ddda36a807af); Time taken: 0.056 seconds
INFO  : OK
No rows affected (0.163 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table shelfon_item.
Moving raw data to archive location for table shelfon_item.
shelfon_item tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.048 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327185757_385a2553-e6e1-42c3-ae65-eb08aa58f423): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_385a2553-e6e1-42c3-ae65-eb08aa58f423); Time taken: 0.108 seconds
INFO  : Executing command(queryId=hive_20180327185757_385a2553-e6e1-42c3-ae65-eb08aa58f423): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_385a2553-e6e1-42c3-ae65-eb08aa58f423); Time taken: 0.011 seconds
INFO  : OK
No rows affected (0.128 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Raw table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_item_channel_raw ;
INFO  : Compiling command(queryId=hive_20180327185757_e178b124-ef75-49ad-b37b-292a4829eafe): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_item_channel_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_e178b124-ef75-49ad-b37b-292a4829eafe); Time taken: 0.097 seconds
INFO  : Executing command(queryId=hive_20180327185757_e178b124-ef75-49ad-b37b-292a4829eafe): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_item_channel_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_e178b124-ef75-49ad-b37b-292a4829eafe); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.107 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_item_channel_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> npid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> ngid varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> site varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> query_type varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> query_params string,
. . . . . . . . . . . . . . . . . . . . . . .> sale_type varchar(16),
. . . . . . . . . . . . . . . . . . . . . . .> help string,
. . . . . . . . . . . . . . . . . . . . . . .> limits int,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185757_211e8738-0d61-404f-9e7c-c619c2d26e15): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_item_channel_raw
(
id varchar(32),
npid bigint,
ngid varchar(64),
site varchar(32),
query_type varchar(32),
query_params string,
sale_type varchar(16),
help string,
limits int,
rtime timestamp,
shelfon_category_seq bigint
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_channel_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_211e8738-0d61-404f-9e7c-c619c2d26e15); Time taken: 0.154 seconds
INFO  : Executing command(queryId=hive_20180327185757_211e8738-0d61-404f-9e7c-c619c2d26e15): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_item_channel_raw
(
id varchar(32),
npid bigint,
ngid varchar(64),
site varchar(32),
query_type varchar(32),
query_params string,
sale_type varchar(16),
help string,
limits int,
rtime timestamp,
shelfon_category_seq bigint
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_channel_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_211e8738-0d61-404f-9e7c-c619c2d26e15); Time taken: 0.439 seconds
INFO  : OK
No rows affected (0.606 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_item_channel_processed ;
INFO  : Compiling command(queryId=hive_20180327185757_4a9b0e52-1144-44fb-b315-67d3e93f35ee): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_item_channel_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_4a9b0e52-1144-44fb-b315-67d3e93f35ee); Time taken: 0.112 seconds
INFO  : Executing command(queryId=hive_20180327185757_4a9b0e52-1144-44fb-b315-67d3e93f35ee): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_item_channel_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_4a9b0e52-1144-44fb-b315-67d3e93f35ee); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.122 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_item_channel_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> npid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> ngid varchar(64),
. . . . . . . . . . . . . . . . . . . . . . .> site varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> query_type varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> query_params string,
. . . . . . . . . . . . . . . . . . . . . . .> sale_type varchar(16),
. . . . . . . . . . . . . . . . . . . . . . .> help string,
. . . . . . . . . . . . . . . . . . . . . . .> limits int,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185757_ba0622b8-9af7-46f7-83bf-e2341feb5bd2): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_item_channel_processed
(
id varchar(32),
npid bigint,
ngid varchar(64),
site varchar(32),
query_type varchar(32),
query_params string,
sale_type varchar(16),
help string,
limits int,
rtime timestamp,
shelfon_category_seq bigint,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_channel_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_ba0622b8-9af7-46f7-83bf-e2341feb5bd2); Time taken: 0.099 seconds
INFO  : Executing command(queryId=hive_20180327185757_ba0622b8-9af7-46f7-83bf-e2341feb5bd2): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_item_channel_processed
(
id varchar(32),
npid bigint,
ngid varchar(64),
site varchar(32),
query_type varchar(32),
query_params string,
sale_type varchar(16),
help string,
limits int,
rtime timestamp,
shelfon_category_seq bigint,
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_channel_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_ba0622b8-9af7-46f7-83bf-e2341feb5bd2); Time taken: 0.225 seconds
INFO  : OK
No rows affected (0.337 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from raw table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_item_channel_raw;
INFO  : Compiling command(queryId=hive_20180327185757_86b515ba-4e8e-4480-acd9-f0e94afee040): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_item_channel_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_86b515ba-4e8e-4480-acd9-f0e94afee040); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327185757_86b515ba-4e8e-4480-acd9-f0e94afee040): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_item_channel_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_86b515ba-4e8e-4480-acd9-f0e94afee040); Time taken: 0.077 seconds
INFO  : OK
No rows affected (0.179 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.003 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.shelfon_item_channel_processed PARTITION (ingestion_date ,  active_flag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .>  r.id
. . . . . . . . . . . . . . . . . . . . . . .> , r.npid
. . . . . . . . . . . . . . . . . . . . . . .> , r.ngid
. . . . . . . . . . . . . . . . . . . . . . .> , r.site
. . . . . . . . . . . . . . . . . . . . . . .> , r.query_type
. . . . . . . . . . . . . . . . . . . . . . .> , r.query_params
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_type
. . . . . . . . . . . . . . . . . . . . . . .> , r.help
. . . . . . . . . . . . . . . . . . . . . . .> , r.limits
. . . . . . . . . . . . . . . . . . . . . . .> , r.rtime
. . . . . . . . . . . . . . . . . . . . . . .> , r.shelfon_category_seq ,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.shelfon_item_channel_raw r;
INFO  : Compiling command(queryId=hive_20180327185757_36489b58-ceed-4e15-8a4f-445e888ea70e): insert into table prd_ykdl_adhoc_db.shelfon_item_channel_processed PARTITION (ingestion_date , active_flag)
select
r.id
, r.npid
, r.ngid
, r.site
, r.query_type
, r.query_params
, r.sale_type
, r.help
, r.limits
, r.rtime
, r.shelfon_category_seq ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_item_channel_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.id, type:varchar(32), comment:null), FieldSchema(name:r.npid, type:bigint, comment:null), FieldSchema(name:r.ngid, type:varchar(64), comment:null), FieldSchema(name:r.site, type:varchar(32), comment:null), FieldSchema(name:r.query_type, type:varchar(32), comment:null), FieldSchema(name:r.query_params, type:string, comment:null), FieldSchema(name:r.sale_type, type:varchar(16), comment:null), FieldSchema(name:r.help, type:string, comment:null), FieldSchema(name:r.limits, type:int, comment:null), FieldSchema(name:r.rtime, type:timestamp, comment:null), FieldSchema(name:r.shelfon_category_seq, type:bigint, comment:null), FieldSchema(name:_c11, type:string, comment:null), FieldSchema(name:_c12, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null), FieldSchema(name:_c14, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_36489b58-ceed-4e15-8a4f-445e888ea70e); Time taken: 0.207 seconds
INFO  : Executing command(queryId=hive_20180327185757_36489b58-ceed-4e15-8a4f-445e888ea70e): insert into table prd_ykdl_adhoc_db.shelfon_item_channel_processed PARTITION (ingestion_date , active_flag)
select
r.id
, r.npid
, r.ngid
, r.site
, r.query_type
, r.query_params
, r.sale_type
, r.help
, r.limits
, r.rtime
, r.shelfon_category_seq ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_item_channel_raw r
INFO  : Query ID = hive_20180327185757_36489b58-ceed-4e15-8a4f-445e888ea70e
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0940
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177041429, maxDate=1522781841429, sequenceNumber=40324, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177041384, maxDate=1522781841384, sequenceNumber=40323, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177041366, maxDate=1522781841366, sequenceNumber=27532, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0940/
INFO  : Starting Job = job_1521666602777_0940, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0940/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0940
INFO  : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 18:57:35,481 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:57:45,908 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 10.1 sec
INFO  : MapReduce Total cumulative CPU time: 10 seconds 100 msec
INFO  : Ended Job = job_1521666602777_0940
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_channel_processed/.hive-staging_hive_2018-03-27_18-57-20_996_8481977445989759923-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_channel_processed/.hive-staging_hive_2018-03-27_18-57-20_996_8481977445989759923-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.shelfon_item_channel_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_item_channel_processed/.hive-staging_hive_2018-03-27_18-57-20_996_8481977445989759923-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 110
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.shelfon_item_channel_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=1, numRows=2982, totalSize=117046, rawDataSize=38766]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 1   Cumulative CPU: 10.1 sec   HDFS Read: 65695 HDFS Write: 117195 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 10 seconds 100 msec
INFO  : Completed executing command(queryId=hive_20180327185757_36489b58-ceed-4e15-8a4f-445e888ea70e); Time taken: 26.149 seconds
INFO  : OK
No rows affected (26.379 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_item_channel_processed;
INFO  : Compiling command(queryId=hive_20180327185757_91dfd772-75f2-4fc3-892b-f6337605c414): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_item_channel_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_91dfd772-75f2-4fc3-892b-f6337605c414); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180327185757_91dfd772-75f2-4fc3-892b-f6337605c414): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_item_channel_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_91dfd772-75f2-4fc3-892b-f6337605c414); Time taken: 0.054 seconds
INFO  : OK
No rows affected (0.153 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table shelfon_item_channel.
Moving raw data to archive location for table shelfon_item_channel.
shelfon_item_channel tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 2ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.049 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327185757_1c266b77-8437-45e8-a399-d460ae0f93a1): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_1c266b77-8437-45e8-a399-d460ae0f93a1); Time taken: 0.108 seconds
INFO  : Executing command(queryId=hive_20180327185757_1c266b77-8437-45e8-a399-d460ae0f93a1): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_1c266b77-8437-45e8-a399-d460ae0f93a1); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.128 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_attentive_sku_raw ;
INFO  : Compiling command(queryId=hive_20180327185757_11c913d0-462b-4a05-ae44-b609d06c9cef): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_attentive_sku_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_11c913d0-462b-4a05-ae44-b609d06c9cef); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180327185757_11c913d0-462b-4a05-ae44-b609d06c9cef): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_attentive_sku_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_11c913d0-462b-4a05-ae44-b609d06c9cef); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.106 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE ${hivedb}.tb_attentive_sku_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> classification STRING,
. . . . . . . . . . . . . . . . . . . . . . .> classification_purpose STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185757_65100dd8-ed83-45b9-b8d7-b94e04bf07a0): CREATE EXTERNAL TABLE prd_ykdl_adhoc_db.tb_attentive_sku_raw
(
seq bigint,
sku_cd bigint,
classification STRING,
classification_purpose STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_attentive_sku_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_65100dd8-ed83-45b9-b8d7-b94e04bf07a0); Time taken: 0.092 seconds
INFO  : Executing command(queryId=hive_20180327185757_65100dd8-ed83-45b9-b8d7-b94e04bf07a0): CREATE EXTERNAL TABLE prd_ykdl_adhoc_db.tb_attentive_sku_raw
(
seq bigint,
sku_cd bigint,
classification STRING,
classification_purpose STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_attentive_sku_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_65100dd8-ed83-45b9-b8d7-b94e04bf07a0); Time taken: 0.186 seconds
INFO  : OK
No rows affected (0.29 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_attentive_sku_processed ;
INFO  : Compiling command(queryId=hive_20180327185757_43ffa139-4111-406d-b21c-6d72d9e20b95): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_attentive_sku_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_43ffa139-4111-406d-b21c-6d72d9e20b95); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327185757_43ffa139-4111-406d-b21c-6d72d9e20b95): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_attentive_sku_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_43ffa139-4111-406d-b21c-6d72d9e20b95); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.121 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_attentive_sku_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> classification STRING,
. . . . . . . . . . . . . . . . . . . . . . .> classification_purpose STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185757_a0116c46-c7f2-469b-be8b-7891359451d9): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_attentive_sku_processed
(
seq bigint,
sku_cd bigint,
classification STRING,
classification_purpose STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_attentive_sku_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_a0116c46-c7f2-469b-be8b-7891359451d9); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180327185757_a0116c46-c7f2-469b-be8b-7891359451d9): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_attentive_sku_processed
(
seq bigint,
sku_cd bigint,
classification STRING,
classification_purpose STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_attentive_sku_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_a0116c46-c7f2-469b-be8b-7891359451d9); Time taken: 0.238 seconds
INFO  : OK
No rows affected (0.345 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.003 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_attentive_sku_raw;
INFO  : Compiling command(queryId=hive_20180327185757_aace0034-d287-4ed3-b46e-3d6c4eb60fdd): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_attentive_sku_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_aace0034-d287-4ed3-b46e-3d6c4eb60fdd); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180327185757_aace0034-d287-4ed3-b46e-3d6c4eb60fdd): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_attentive_sku_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185757_aace0034-d287-4ed3-b46e-3d6c4eb60fdd); Time taken: 0.082 seconds
INFO  : OK
No rows affected (0.181 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.tb_attentive_sku_processed PARTITION (ingestion_date)
. . . . . . . . . . . . . . . . . . . . . . .> select
. . . . . . . . . . . . . . . . . . . . . . .> r.seq,
. . . . . . . . . . . . . . . . . . . . . . .> r.sku_cd,
. . . . . . . . . . . . . . . . . . . . . . .> r.classification,
. . . . . . . . . . . . . . . . . . . . . . .> r.classification_purpose,
. . . . . . . . . . . . . . . . . . . . . . .> r.use_yn,
. . . . . . . . . . . . . . . . . . . . . . .> r.mod_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.reg_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.tb_attentive_sku_raw r;
INFO  : Compiling command(queryId=hive_20180327185757_8ec7b350-6254-40f2-98cb-c1ae43d5c307): insert into table prd_ykdl_adhoc_db.tb_attentive_sku_processed PARTITION (ingestion_date)
select
r.seq,
r.sku_cd,
r.classification,
r.classification_purpose,
r.use_yn,
r.mod_date,
r.reg_date,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_attentive_sku_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.seq, type:bigint, comment:null), FieldSchema(name:r.sku_cd, type:bigint, comment:null), FieldSchema(name:r.classification, type:string, comment:null), FieldSchema(name:r.classification_purpose, type:string, comment:null), FieldSchema(name:r.use_yn, type:char(1), comment:null), FieldSchema(name:r.mod_date, type:timestamp, comment:null), FieldSchema(name:r.reg_date, type:timestamp, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185757_8ec7b350-6254-40f2-98cb-c1ae43d5c307); Time taken: 0.21 seconds
INFO  : Executing command(queryId=hive_20180327185757_8ec7b350-6254-40f2-98cb-c1ae43d5c307): insert into table prd_ykdl_adhoc_db.tb_attentive_sku_processed PARTITION (ingestion_date)
select
r.seq,
r.sku_cd,
r.classification,
r.classification_purpose,
r.use_yn,
r.mod_date,
r.reg_date,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_attentive_sku_raw r
INFO  : Query ID = hive_20180327185757_8ec7b350-6254-40f2-98cb-c1ae43d5c307
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:2
INFO  : Submitting tokens for job: job_1521666602777_0941
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177078471, maxDate=1522781878471, sequenceNumber=40326, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177078421, maxDate=1522781878421, sequenceNumber=40325, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177078401, maxDate=1522781878401, sequenceNumber=27533, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0941/
INFO  : Starting Job = job_1521666602777_0941, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0941/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0941
INFO  : Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 0
INFO  : 2018-03-27 18:58:07,526 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:58:17,943 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 14.93 sec
INFO  : MapReduce Total cumulative CPU time: 14 seconds 930 msec
INFO  : Ended Job = job_1521666602777_0941
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is filtered out by condition resolver.
INFO  : Stage-3 is selected by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Launching Job 3 out of 3
INFO  : Starting task [Stage-3:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0942
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177099259, maxDate=1522781899259, sequenceNumber=40327, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177099310, maxDate=1522781899310, sequenceNumber=40328, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177099239, maxDate=1522781899239, sequenceNumber=27534, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0942/
INFO  : Starting Job = job_1521666602777_0942, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0942/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0942
INFO  : Hadoop job information for Stage-3: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 18:58:28,409 Stage-3 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:58:39,859 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 7.62 sec
INFO  : MapReduce Total cumulative CPU time: 7 seconds 620 msec
INFO  : Ended Job = job_1521666602777_0942
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.tb_attentive_sku_processed partition (ingestion_date=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_attentive_sku_processed/.hive-staging_hive_2018-03-27_18-57-57_995_6448793829172533717-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 108
INFO  : 	Loading partition {ingestion_date=19990101}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.tb_attentive_sku_processed{ingestion_date=19990101} stats: [numFiles=1, numRows=240, totalSize=6074, rawDataSize=1680]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 2   Cumulative CPU: 14.93 sec   HDFS Read: 16240 HDFS Write: 7724 SUCCESS
INFO  : Stage-Stage-3: Map: 1   Cumulative CPU: 7.62 sec   HDFS Read: 13951 HDFS Write: 6074 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 22 seconds 550 msec
INFO  : Completed executing command(queryId=hive_20180327185757_8ec7b350-6254-40f2-98cb-c1ae43d5c307); Time taken: 43.092 seconds
INFO  : OK
No rows affected (43.325 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_attentive_sku_processed;
INFO  : Compiling command(queryId=hive_20180327185858_d373331b-2119-4bc1-b3f9-c77230ad23e9): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_attentive_sku_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185858_d373331b-2119-4bc1-b3f9-c77230ad23e9); Time taken: 0.09 seconds
INFO  : Executing command(queryId=hive_20180327185858_d373331b-2119-4bc1-b3f9-c77230ad23e9): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_attentive_sku_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185858_d373331b-2119-4bc1-b3f9-c77230ad23e9); Time taken: 0.054 seconds
INFO  : OK
No rows affected (0.15 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table tb_attentive_sku.
Moving raw data to archive location for table tb_attentive_sku.
tb_attentive_sku tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 2ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.062 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327185858_44237493-ad0c-4b0c-a120-a72c64949d4d): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185858_44237493-ad0c-4b0c-a120-a72c64949d4d); Time taken: 0.111 seconds
INFO  : Executing command(queryId=hive_20180327185858_44237493-ad0c-4b0c-a120-a72c64949d4d): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185858_44237493-ad0c-4b0c-a120-a72c64949d4d); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.132 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_online_dpsm_d_list_raw; 
INFO  : Compiling command(queryId=hive_20180327185858_0cc5dff1-80f2-4a47-9619-fbc7876b4cf5): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_d_list_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185858_0cc5dff1-80f2-4a47-9619-fbc7876b4cf5); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327185858_0cc5dff1-80f2-4a47-9619-fbc7876b4cf5): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_d_list_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185858_0cc5dff1-80f2-4a47-9619-fbc7876b4cf5); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.107 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE ${hivedb}.tb_online_dpsm_d_list_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd BIGINT,
. . . . . . . . . . . . . . . . . . . . . . .> classification STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn CHAR(1) ,
. . . . . . . . . . . . . . . . . . . . . . .> mod_date TIMESTAMP,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date TIMESTAMP, 
. . . . . . . . . . . . . . . . . . . . . . .> year_src INT      COMMENT 'appending src with in source column name', 
. . . . . . . . . . . . . . . . . . . . . . .> month_src int  COMMENT 'appending src with in source column name' ,
. . . . . . . . . . . . . . . . . . . . . . .> target decimal(10,2)
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185858_dd6f2585-41f4-4291-8056-43df5fadf370): CREATE EXTERNAL TABLE prd_ykdl_adhoc_db.tb_online_dpsm_d_list_raw
(
sku_cd BIGINT,
classification STRING,
use_yn CHAR(1) ,
mod_date TIMESTAMP,
reg_date TIMESTAMP,
year_src INT      COMMENT 'appending src with in source column name',
month_src int  COMMENT 'appending src with in source column name' ,
target decimal(10,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_d_list_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185858_dd6f2585-41f4-4291-8056-43df5fadf370); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180327185858_dd6f2585-41f4-4291-8056-43df5fadf370): CREATE EXTERNAL TABLE prd_ykdl_adhoc_db.tb_online_dpsm_d_list_raw
(
sku_cd BIGINT,
classification STRING,
use_yn CHAR(1) ,
mod_date TIMESTAMP,
reg_date TIMESTAMP,
year_src INT      COMMENT 'appending src with in source column name',
month_src int  COMMENT 'appending src with in source column name' ,
target decimal(10,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_d_list_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185858_dd6f2585-41f4-4291-8056-43df5fadf370); Time taken: 0.454 seconds
INFO  : OK
No rows affected (0.562 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_online_dpsm_d_list_processed ;
INFO  : Compiling command(queryId=hive_20180327185858_9a63e638-1acc-4a99-bed6-469d79e7b986): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185858_9a63e638-1acc-4a99-bed6-469d79e7b986); Time taken: 0.115 seconds
INFO  : Executing command(queryId=hive_20180327185858_9a63e638-1acc-4a99-bed6-469d79e7b986): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185858_9a63e638-1acc-4a99-bed6-469d79e7b986); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.124 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_online_dpsm_d_list_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd BIGINT,
. . . . . . . . . . . . . . . . . . . . . . .> classification STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn CHAR(1) ,
. . . . . . . . . . . . . . . . . . . . . . .> mod_date TIMESTAMP,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date TIMESTAMP, 
. . . . . . . . . . . . . . . . . . . . . . .> year_src INT      COMMENT 'appending src with in source column name', 
. . . . . . . . . . . . . . . . . . . . . . .> month_src int  COMMENT 'appending src with in source column name' ,
. . . . . . . . . . . . . . . . . . . . . . .> target decimal(10,2)
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185858_d2bec466-8e9e-4940-9e34-0bb75d9587c1): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed
(
sku_cd BIGINT,
classification STRING,
use_yn CHAR(1) ,
mod_date TIMESTAMP,
reg_date TIMESTAMP,
year_src INT      COMMENT 'appending src with in source column name',
month_src int  COMMENT 'appending src with in source column name' ,
target decimal(10,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_d_list_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185858_d2bec466-8e9e-4940-9e34-0bb75d9587c1); Time taken: 0.098 seconds
INFO  : Executing command(queryId=hive_20180327185858_d2bec466-8e9e-4940-9e34-0bb75d9587c1): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed
(
sku_cd BIGINT,
classification STRING,
use_yn CHAR(1) ,
mod_date TIMESTAMP,
reg_date TIMESTAMP,
year_src INT      COMMENT 'appending src with in source column name',
month_src int  COMMENT 'appending src with in source column name' ,
target decimal(10,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_d_list_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185858_d2bec466-8e9e-4940-9e34-0bb75d9587c1); Time taken: 0.233 seconds
INFO  : OK
No rows affected (0.343 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_online_dpsm_d_list_raw;
INFO  : Compiling command(queryId=hive_20180327185858_2bd07a54-13a0-411d-8b0f-f96aacd7d94e): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_d_list_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185858_2bd07a54-13a0-411d-8b0f-f96aacd7d94e); Time taken: 0.093 seconds
INFO  : Executing command(queryId=hive_20180327185858_2bd07a54-13a0-411d-8b0f-f96aacd7d94e): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_d_list_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185858_2bd07a54-13a0-411d-8b0f-f96aacd7d94e); Time taken: 0.076 seconds
INFO  : OK
No rows affected (0.175 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.003 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.tb_online_dpsm_d_list_processed PARTITION (ingestion_date)
. . . . . . . . . . . . . . . . . . . . . . .> select
. . . . . . . . . . . . . . . . . . . . . . .> r.sku_cd,
. . . . . . . . . . . . . . . . . . . . . . .> r.classification,
. . . . . . . . . . . . . . . . . . . . . . .> r.use_yn,
. . . . . . . . . . . . . . . . . . . . . . .> r.mod_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.reg_date, 
. . . . . . . . . . . . . . . . . . . . . . .> r.year_src, 
. . . . . . . . . . . . . . . . . . . . . . .> r.month_src,
. . . . . . . . . . . . . . . . . . . . . . .> r.target,
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.tb_online_dpsm_d_list_raw r;
INFO  : Compiling command(queryId=hive_20180327185858_4d681f50-4d96-49c2-ac1e-9cd0b62d999e): insert into table prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed PARTITION (ingestion_date)
select
r.sku_cd,
r.classification,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_online_dpsm_d_list_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.sku_cd, type:bigint, comment:null), FieldSchema(name:r.classification, type:string, comment:null), FieldSchema(name:r.use_yn, type:char(1), comment:null), FieldSchema(name:r.mod_date, type:timestamp, comment:null), FieldSchema(name:r.reg_date, type:timestamp, comment:null), FieldSchema(name:r.year_src, type:int, comment:null), FieldSchema(name:r.month_src, type:int, comment:null), FieldSchema(name:r.target, type:decimal(10,2), comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185858_4d681f50-4d96-49c2-ac1e-9cd0b62d999e); Time taken: 0.217 seconds
INFO  : Executing command(queryId=hive_20180327185858_4d681f50-4d96-49c2-ac1e-9cd0b62d999e): insert into table prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed PARTITION (ingestion_date)
select
r.sku_cd,
r.classification,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_online_dpsm_d_list_raw r
INFO  : Query ID = hive_20180327185858_4d681f50-4d96-49c2-ac1e-9cd0b62d999e
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0943
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177132959, maxDate=1522781932959, sequenceNumber=40330, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177132904, maxDate=1522781932904, sequenceNumber=40329, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177132882, maxDate=1522781932882, sequenceNumber=27535, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0943/
INFO  : Starting Job = job_1521666602777_0943, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0943/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0943
INFO  : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 18:59:02,039 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:59:12,457 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 7.87 sec
INFO  : MapReduce Total cumulative CPU time: 7 seconds 870 msec
INFO  : Ended Job = job_1521666602777_0943
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_d_list_processed/.hive-staging_hive_2018-03-27_18-58-52_488_5005390353564222170-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_d_list_processed/.hive-staging_hive_2018-03-27_18-58-52_488_5005390353564222170-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed partition (ingestion_date=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_d_list_processed/.hive-staging_hive_2018-03-27_18-58-52_488_5005390353564222170-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 106
INFO  : 	Loading partition {ingestion_date=19990101}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed{ingestion_date=19990101} stats: [numFiles=1, numRows=341, totalSize=4208, rawDataSize=2728]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 1   Cumulative CPU: 7.87 sec   HDFS Read: 10206 HDFS Write: 4342 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 7 seconds 870 msec
INFO  : Completed executing command(queryId=hive_20180327185858_4d681f50-4d96-49c2-ac1e-9cd0b62d999e); Time taken: 21.186 seconds
INFO  : OK
No rows affected (21.424 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_online_dpsm_d_list_processed;
INFO  : Compiling command(queryId=hive_20180327185959_62107270-cd3a-4bbc-a836-b966b45bf47d): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_62107270-cd3a-4bbc-a836-b966b45bf47d); Time taken: 0.103 seconds
INFO  : Executing command(queryId=hive_20180327185959_62107270-cd3a-4bbc-a836-b966b45bf47d): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_d_list_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_62107270-cd3a-4bbc-a836-b966b45bf47d); Time taken: 0.054 seconds
INFO  : OK
No rows affected (0.163 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table tb_online_dpsm_d_list.
Moving raw data to archive location for table tb_online_dpsm_d_list.
tb_online_dpsm_d_list tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.048 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327185959_c2fa593f-8878-42bf-a5ff-2f7c610fafd9): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_c2fa593f-8878-42bf-a5ff-2f7c610fafd9); Time taken: 0.114 seconds
INFO  : Executing command(queryId=hive_20180327185959_c2fa593f-8878-42bf-a5ff-2f7c610fafd9): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_c2fa593f-8878-42bf-a5ff-2f7c610fafd9); Time taken: 0.009 seconds
INFO  : OK
No rows affected (0.135 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_online_dpsm_m_list_new_raw;
INFO  : Compiling command(queryId=hive_20180327185959_3c67ac99-d4e3-4290-ad37-e3d33ed8cf1c): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_3c67ac99-d4e3-4290-ad37-e3d33ed8cf1c); Time taken: 0.099 seconds
INFO  : Executing command(queryId=hive_20180327185959_3c67ac99-d4e3-4290-ad37-e3d33ed8cf1c): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_3c67ac99-d4e3-4290-ad37-e3d33ed8cf1c); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.109 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_online_dpsm_m_list_new_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> year_src int,
. . . . . . . . . . . . . . . . . . . . . . .> month_src int,
. . . . . . . . . . . . . . . . . . . . . . .> target int
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185959_aff3a415-5d30-4370-b31b-d847ab3404e5): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_raw
(
shelfon_category_seq bigint,
depth_fullname STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_m_list_new_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_aff3a415-5d30-4370-b31b-d847ab3404e5); Time taken: 0.098 seconds
INFO  : Executing command(queryId=hive_20180327185959_aff3a415-5d30-4370-b31b-d847ab3404e5): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_raw
(
shelfon_category_seq bigint,
depth_fullname STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_m_list_new_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_aff3a415-5d30-4370-b31b-d847ab3404e5); Time taken: 0.125 seconds
INFO  : OK
No rows affected (0.236 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_online_dpsm_m_list_new_processed;
INFO  : Compiling command(queryId=hive_20180327185959_e109f032-8f49-4630-a407-421448d1a7f1): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_e109f032-8f49-4630-a407-421448d1a7f1); Time taken: 0.159 seconds
INFO  : Executing command(queryId=hive_20180327185959_e109f032-8f49-4630-a407-421448d1a7f1): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_e109f032-8f49-4630-a407-421448d1a7f1); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.17 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_online_dpsm_m_list_new_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> year_src int,
. . . . . . . . . . . . . . . . . . . . . . .> month_src int,
. . . . . . . . . . . . . . . . . . . . . . .> target int
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185959_c34741ba-6684-4e74-ac76-318eecbe5a5f): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed
(
shelfon_category_seq bigint,
depth_fullname STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_m_list_new_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_c34741ba-6684-4e74-ac76-318eecbe5a5f); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180327185959_c34741ba-6684-4e74-ac76-318eecbe5a5f): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed
(
shelfon_category_seq bigint,
depth_fullname STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_m_list_new_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_c34741ba-6684-4e74-ac76-318eecbe5a5f); Time taken: 0.196 seconds
INFO  : OK
No rows affected (0.306 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_online_dpsm_m_list_new_raw;
INFO  : Compiling command(queryId=hive_20180327185959_024fa175-4254-4e95-955e-1f0bbfdc31b7): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_024fa175-4254-4e95-955e-1f0bbfdc31b7); Time taken: 0.098 seconds
INFO  : Executing command(queryId=hive_20180327185959_024fa175-4254-4e95-955e-1f0bbfdc31b7): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_024fa175-4254-4e95-955e-1f0bbfdc31b7); Time taken: 0.081 seconds
INFO  : OK
No rows affected (0.186 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.003 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.tb_online_dpsm_m_list_new_processed PARTITION (ingestion_da te)
. . . . . . . . . . . . . . . . . . . . . . .> select
. . . . . . . . . . . . . . . . . . . . . . .> r.shelfon_category_seq,
. . . . . . . . . . . . . . . . . . . . . . .> r.depth_fullname,
. . . . . . . . . . . . . . . . . . . . . . .> r.use_yn,
. . . . . . . . . . . . . . . . . . . . . . .> r.mod_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.reg_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.year_src,
. . . . . . . . . . . . . . . . . . . . . . .> r.month_src,
. . . . . . . . . . . . . . . . . . . . . . .> r.target,
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.tb_online_dpsm_m_list_new_raw r;
INFO  : Compiling command(queryId=hive_20180327185959_8d88b209-5ef4-4746-8f47-445757ec978b): insert into table prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed PARTITION (ingestion_date)
select
r.shelfon_category_seq,
r.depth_fullname,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.shelfon_category_seq, type:bigint, comment:null), FieldSchema(name:r.depth_fullname, type:string, comment:null), FieldSchema(name:r.use_yn, type:char(1), comment:null), FieldSchema(name:r.mod_date, type:timestamp, comment:null), FieldSchema(name:r.reg_date, type:timestamp, comment:null), FieldSchema(name:r.year_src, type:int, comment:null), FieldSchema(name:r.month_src, type:int, comment:null), FieldSchema(name:r.target, type:int, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_8d88b209-5ef4-4746-8f47-445757ec978b); Time taken: 0.203 seconds
INFO  : Executing command(queryId=hive_20180327185959_8d88b209-5ef4-4746-8f47-445757ec978b): insert into table prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed PARTITION (ingestion_date)
select
r.shelfon_category_seq,
r.depth_fullname,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_raw r
INFO  : Query ID = hive_20180327185959_8d88b209-5ef4-4746-8f47-445757ec978b
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0945
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177164973, maxDate=1522781964973, sequenceNumber=40333, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177164923, maxDate=1522781964923, sequenceNumber=40332, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177164886, maxDate=1522781964886, sequenceNumber=27537, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0945/
INFO  : Starting Job = job_1521666602777_0945, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0945/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0945
INFO  : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 18:59:34,038 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 18:59:44,442 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 7.7 sec
INFO  : MapReduce Total cumulative CPU time: 7 seconds 700 msec
INFO  : Ended Job = job_1521666602777_0945
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_m_list_new_processed/.hive-staging_hive_2018-03-27_18-59-24_513_18855086310367776-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_m_list_new_processed/.hive-staging_hive_2018-03-27_18-59-24_513_18855086310367776-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed partition (ingestion_date=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_m_list_new_processed/.hive-staging_hive_2018-03-27_18-59-24_513_18855086310367776-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 100
INFO  : 	Loading partition {ingestion_date=19990101}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed{ingestion_date=19990101} stats: [numFiles=1, numRows=264, totalSize=3127, rawDataSize=2112]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 1   Cumulative CPU: 7.7 sec   HDFS Read: 9599 HDFS Write: 3265 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 7 seconds 700 msec
INFO  : Completed executing command(queryId=hive_20180327185959_8d88b209-5ef4-4746-8f47-445757ec978b); Time taken: 21.141 seconds
INFO  : OK
No rows affected (21.368 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_online_dpsm_m_list_new_processed;
INFO  : Compiling command(queryId=hive_20180327185959_17a8e417-0604-4603-b931-bfb83b51125d): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_17a8e417-0604-4603-b931-bfb83b51125d); Time taken: 0.097 seconds
INFO  : Executing command(queryId=hive_20180327185959_17a8e417-0604-4603-b931-bfb83b51125d): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_m_list_new_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_17a8e417-0604-4603-b931-bfb83b51125d); Time taken: 0.052 seconds
INFO  : OK
No rows affected (0.155 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table tb_online_dpsm_m_list_new.
Moving raw data to archive location for table tb_online_dpsm_m_list_new.
tb_online_dpsm_m_list_new tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 2ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.051 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327185959_6df5a8d3-5117-486d-a4a1-d2f39707e8e9): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_6df5a8d3-5117-486d-a4a1-d2f39707e8e9); Time taken: 0.113 seconds
INFO  : Executing command(queryId=hive_20180327185959_6df5a8d3-5117-486d-a4a1-d2f39707e8e9): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_6df5a8d3-5117-486d-a4a1-d2f39707e8e9); Time taken: 0.011 seconds
INFO  : OK
No rows affected (0.134 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_online_dpsm_p_list_raw ;
INFO  : Compiling command(queryId=hive_20180327185959_1033c833-97d0-4598-9e04-d97405737a67): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_p_list_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_1033c833-97d0-4598-9e04-d97405737a67); Time taken: 0.104 seconds
INFO  : Executing command(queryId=hive_20180327185959_1033c833-97d0-4598-9e04-d97405737a67): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_p_list_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_1033c833-97d0-4598-9e04-d97405737a67); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.115 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_online_dpsm_p_list_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> competitor_product_name string ,
. . . . . . . . . . . . . . . . . . . . . . .> mapped_sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> year_src int,
. . . . . . . . . . . . . . . . . . . . . . .> month_src int,
. . . . . . . . . . . . . . . . . . . . . . .> target int
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185959_cd88f2f6-1a4e-427d-b386-875d4573870d): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_p_list_raw
(
competitor_product_name string ,
mapped_sku_cd bigint,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_p_list_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_cd88f2f6-1a4e-427d-b386-875d4573870d); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327185959_cd88f2f6-1a4e-427d-b386-875d4573870d): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_p_list_raw
(
competitor_product_name string ,
mapped_sku_cd bigint,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_p_list_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_cd88f2f6-1a4e-427d-b386-875d4573870d); Time taken: 0.123 seconds
INFO  : OK
No rows affected (0.231 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_online_dpsm_p_list_processed ;
INFO  : Compiling command(queryId=hive_20180327185959_42702ab9-2e94-44a6-8e98-b485730a378a): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_42702ab9-2e94-44a6-8e98-b485730a378a); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327185959_42702ab9-2e94-44a6-8e98-b485730a378a): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_42702ab9-2e94-44a6-8e98-b485730a378a); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.119 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_online_dpsm_p_list_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> competitor_product_name string ,
. . . . . . . . . . . . . . . . . . . . . . .> mapped_sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> year_src int,
. . . . . . . . . . . . . . . . . . . . . . .> month_src int,
. . . . . . . . . . . . . . . . . . . . . . .> target int
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327185959_a19d193d-2fc0-4127-9fc1-d6ef61281305): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed
(
competitor_product_name string ,
mapped_sku_cd bigint,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_p_list_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_a19d193d-2fc0-4127-9fc1-d6ef61281305); Time taken: 0.098 seconds
INFO  : Executing command(queryId=hive_20180327185959_a19d193d-2fc0-4127-9fc1-d6ef61281305): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed
(
competitor_product_name string ,
mapped_sku_cd bigint,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_p_list_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_a19d193d-2fc0-4127-9fc1-d6ef61281305); Time taken: 0.245 seconds
INFO  : OK
No rows affected (0.356 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_online_dpsm_p_list_raw;
INFO  : Compiling command(queryId=hive_20180327185959_14597b30-64d3-4642-925d-3370551057ca): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_p_list_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_14597b30-64d3-4642-925d-3370551057ca); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327185959_14597b30-64d3-4642-925d-3370551057ca): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_p_list_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327185959_14597b30-64d3-4642-925d-3370551057ca); Time taken: 0.078 seconds
INFO  : OK
No rows affected (0.18 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.tb_online_dpsm_p_list_processed PARTITION (ingestion_date)
. . . . . . . . . . . . . . . . . . . . . . .> select
. . . . . . . . . . . . . . . . . . . . . . .> r.competitor_product_name ,
. . . . . . . . . . . . . . . . . . . . . . .> r.mapped_sku_cd,
. . . . . . . . . . . . . . . . . . . . . . .> r.use_yn,
. . . . . . . . . . . . . . . . . . . . . . .> r.mod_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.reg_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.year_src,
. . . . . . . . . . . . . . . . . . . . . . .> r.month_src,
. . . . . . . . . . . . . . . . . . . . . . .> r.target,
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.tb_online_dpsm_p_list_raw r;
INFO  : Compiling command(queryId=hive_20180327185959_f9ecc7cf-37f7-41dc-8c10-125ba4283614): insert into table prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed PARTITION (ingestion_date)
select
r.competitor_product_name ,
r.mapped_sku_cd,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_online_dpsm_p_list_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.competitor_product_name, type:string, comment:null), FieldSchema(name:r.mapped_sku_cd, type:bigint, comment:null), FieldSchema(name:r.use_yn, type:char(1), comment:null), FieldSchema(name:r.mod_date, type:timestamp, comment:null), FieldSchema(name:r.reg_date, type:timestamp, comment:null), FieldSchema(name:r.year_src, type:int, comment:null), FieldSchema(name:r.month_src, type:int, comment:null), FieldSchema(name:r.target, type:int, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327185959_f9ecc7cf-37f7-41dc-8c10-125ba4283614); Time taken: 0.212 seconds
INFO  : Executing command(queryId=hive_20180327185959_f9ecc7cf-37f7-41dc-8c10-125ba4283614): insert into table prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed PARTITION (ingestion_date)
select
r.competitor_product_name ,
r.mapped_sku_cd,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_online_dpsm_p_list_raw r
INFO  : Query ID = hive_20180327185959_f9ecc7cf-37f7-41dc-8c10-125ba4283614
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0947
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177196951, maxDate=1522781996951, sequenceNumber=40336, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177196903, maxDate=1522781996903, sequenceNumber=40335, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177196880, maxDate=1522781996880, sequenceNumber=27539, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0947/
INFO  : Starting Job = job_1521666602777_0947, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0947/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0947
INFO  : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 19:00:06,006 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 19:00:16,453 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 7.6 sec
INFO  : MapReduce Total cumulative CPU time: 7 seconds 600 msec
INFO  : Ended Job = job_1521666602777_0947
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_p_list_processed/.hive-staging_hive_2018-03-27_18-59-56_494_6869127741653593711-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_p_list_processed/.hive-staging_hive_2018-03-27_18-59-56_494_6869127741653593711-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed partition (ingestion_date=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_p_list_processed/.hive-staging_hive_2018-03-27_18-59-56_494_6869127741653593711-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 105
INFO  : 	Loading partition {ingestion_date=19990101}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed{ingestion_date=19990101} stats: [numFiles=1, numRows=161, totalSize=2790, rawDataSize=1288]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 1   Cumulative CPU: 7.6 sec   HDFS Read: 8849 HDFS Write: 2924 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 7 seconds 600 msec
INFO  : Completed executing command(queryId=hive_20180327185959_f9ecc7cf-37f7-41dc-8c10-125ba4283614); Time taken: 21.176 seconds
INFO  : OK
No rows affected (21.41 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_online_dpsm_p_list_processed ;
INFO  : Compiling command(queryId=hive_20180327190000_e5cd4914-ec3a-4c48-b154-c780f1ed555e): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190000_e5cd4914-ec3a-4c48-b154-c780f1ed555e); Time taken: 0.151 seconds
INFO  : Executing command(queryId=hive_20180327190000_e5cd4914-ec3a-4c48-b154-c780f1ed555e): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_p_list_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190000_e5cd4914-ec3a-4c48-b154-c780f1ed555e); Time taken: 0.056 seconds
INFO  : OK
No rows affected (0.212 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table tb_online_dpsm_p_list.
Moving raw data to archive location for table tb_online_dpsm_p_list.
tb_online_dpsm_p_list tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 2ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.048 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327190000_9cac41d3-a677-4301-9caf-5842776d13b0): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190000_9cac41d3-a677-4301-9caf-5842776d13b0); Time taken: 0.111 seconds
INFO  : Executing command(queryId=hive_20180327190000_9cac41d3-a677-4301-9caf-5842776d13b0): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190000_9cac41d3-a677-4301-9caf-5842776d13b0); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.131 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_online_dpsm_s_list_new_raw ;
INFO  : Compiling command(queryId=hive_20180327190000_98137356-f5fd-4081-af42-f8f9ef5c2d7d): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190000_98137356-f5fd-4081-af42-f8f9ef5c2d7d); Time taken: 0.102 seconds
INFO  : Executing command(queryId=hive_20180327190000_98137356-f5fd-4081-af42-f8f9ef5c2d7d): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190000_98137356-f5fd-4081-af42-f8f9ef5c2d7d); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.111 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_online_dpsm_s_list_new_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname STRING,
. . . . . . . . . . . . . . . . . . . . . . .> item_title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> year_src int,
. . . . . . . . . . . . . . . . . . . . . . .> month_src int,
. . . . . . . . . . . . . . . . . . . . . . .> target int
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327190000_9b559630-426a-4c80-80af-7cc387bb2f0c): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_raw
(
shelfon_category_seq bigint,
depth_fullname STRING,
item_title STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_s_list_new_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190000_9b559630-426a-4c80-80af-7cc387bb2f0c); Time taken: 0.097 seconds
INFO  : Executing command(queryId=hive_20180327190000_9b559630-426a-4c80-80af-7cc387bb2f0c): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_raw
(
shelfon_category_seq bigint,
depth_fullname STRING,
item_title STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_s_list_new_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190000_9b559630-426a-4c80-80af-7cc387bb2f0c); Time taken: 0.281 seconds
INFO  : OK
No rows affected (0.39 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_online_dpsm_s_list_new_processed ;
INFO  : Compiling command(queryId=hive_20180327190000_baeb36d5-05ed-4015-aa6d-d35bae5f3d5a): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190000_baeb36d5-05ed-4015-aa6d-d35bae5f3d5a); Time taken: 0.119 seconds
INFO  : Executing command(queryId=hive_20180327190000_baeb36d5-05ed-4015-aa6d-d35bae5f3d5a): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190000_baeb36d5-05ed-4015-aa6d-d35bae5f3d5a); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.129 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE TABLE IF NOT EXISTS ${hivedb}.tb_online_dpsm_s_list_new_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_category_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname STRING,
. . . . . . . . . . . . . . . . . . . . . . .> item_title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> year_src int,
. . . . . . . . . . . . . . . . . . . . . . .> month_src int,
. . . . . . . . . . . . . . . . . . . . . . .> target int
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327190000_5d403c79-252f-4109-a890-14c4096bb6d4): CREATE TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed
(
shelfon_category_seq bigint,
depth_fullname STRING,
item_title STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_s_list_new_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190000_5d403c79-252f-4109-a890-14c4096bb6d4); Time taken: 0.1 seconds
INFO  : Executing command(queryId=hive_20180327190000_5d403c79-252f-4109-a890-14c4096bb6d4): CREATE TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed
(
shelfon_category_seq bigint,
depth_fullname STRING,
item_title STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target int
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_s_list_new_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190000_5d403c79-252f-4109-a890-14c4096bb6d4); Time taken: 0.234 seconds
INFO  : OK
No rows affected (0.345 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_online_dpsm_s_list_new_raw ;
INFO  : Compiling command(queryId=hive_20180327190000_dc8a20bf-d8cc-414b-92e9-88fdfe142474): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190000_dc8a20bf-d8cc-414b-92e9-88fdfe142474); Time taken: 0.101 seconds
INFO  : Executing command(queryId=hive_20180327190000_dc8a20bf-d8cc-414b-92e9-88fdfe142474): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190000_dc8a20bf-d8cc-414b-92e9-88fdfe142474); Time taken: 0.072 seconds
INFO  : OK
No rows affected (0.179 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.tb_online_dpsm_s_list_new_processed PARTITION (ingestion_da te)
. . . . . . . . . . . . . . . . . . . . . . .> select
. . . . . . . . . . . . . . . . . . . . . . .> r.shelfon_category_seq,
. . . . . . . . . . . . . . . . . . . . . . .> r.depth_fullname,
. . . . . . . . . . . . . . . . . . . . . . .> r.item_title,
. . . . . . . . . . . . . . . . . . . . . . .> r.use_yn,
. . . . . . . . . . . . . . . . . . . . . . .> r.mod_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.reg_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.year_src,
. . . . . . . . . . . . . . . . . . . . . . .> r.month_src,
. . . . . . . . . . . . . . . . . . . . . . .> r.target,
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.tb_online_dpsm_s_list_new_raw r;
INFO  : Compiling command(queryId=hive_20180327190000_4ea07f8b-ce35-45ae-8078-c45df9ec7b0a): insert into table prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed PARTITION (ingestion_date)
select
r.shelfon_category_seq,
r.depth_fullname,
r.item_title,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.shelfon_category_seq, type:bigint, comment:null), FieldSchema(name:r.depth_fullname, type:string, comment:null), FieldSchema(name:r.item_title, type:string, comment:null), FieldSchema(name:r.use_yn, type:char(1), comment:null), FieldSchema(name:r.mod_date, type:timestamp, comment:null), FieldSchema(name:r.reg_date, type:timestamp, comment:null), FieldSchema(name:r.year_src, type:int, comment:null), FieldSchema(name:r.month_src, type:int, comment:null), FieldSchema(name:r.target, type:int, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190000_4ea07f8b-ce35-45ae-8078-c45df9ec7b0a); Time taken: 0.217 seconds
INFO  : Executing command(queryId=hive_20180327190000_4ea07f8b-ce35-45ae-8078-c45df9ec7b0a): insert into table prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed PARTITION (ingestion_date)
select
r.shelfon_category_seq,
r.depth_fullname,
r.item_title,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_raw r
INFO  : Query ID = hive_20180327190000_4ea07f8b-ce35-45ae-8078-c45df9ec7b0a
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:2
INFO  : Submitting tokens for job: job_1521666602777_0948
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177228943, maxDate=1522782028943, sequenceNumber=40338, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177228897, maxDate=1522782028897, sequenceNumber=40337, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177228878, maxDate=1522782028878, sequenceNumber=27540, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0948/
INFO  : Starting Job = job_1521666602777_0948, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0948/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0948
INFO  : Hadoop job information for Stage-1: number of mappers: 2; number of reducers: 0
INFO  : 2018-03-27 19:00:38,015 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 19:00:48,420 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 14.51 sec
INFO  : MapReduce Total cumulative CPU time: 14 seconds 510 msec
INFO  : Ended Job = job_1521666602777_0948
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is filtered out by condition resolver.
INFO  : Stage-3 is selected by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Launching Job 3 out of 3
INFO  : Starting task [Stage-3:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0949
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177250697, maxDate=1522782050697, sequenceNumber=40339, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177250742, maxDate=1522782050742, sequenceNumber=40340, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177250677, maxDate=1522782050677, sequenceNumber=27541, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0949/
INFO  : Starting Job = job_1521666602777_0949, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0949/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0949
INFO  : Hadoop job information for Stage-3: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 19:01:00,794 Stage-3 map = 0%,  reduce = 0%
INFO  : 2018-03-27 19:01:10,160 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 7.62 sec
INFO  : MapReduce Total cumulative CPU time: 7 seconds 620 msec
INFO  : Ended Job = job_1521666602777_0949
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed partition (ingestion_date=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_online_dpsm_s_list_new_processed/.hive-staging_hive_2018-03-27_19-00-28_494_8056984949244140515-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 154
INFO  : 	Loading partition {ingestion_date=19990101}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed{ingestion_date=19990101} stats: [numFiles=1, numRows=33, totalSize=1880, rawDataSize=297]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 2   Cumulative CPU: 14.51 sec   HDFS Read: 13810 HDFS Write: 3743 SUCCESS
INFO  : Stage-Stage-3: Map: 1   Cumulative CPU: 7.62 sec   HDFS Read: 10847 HDFS Write: 1880 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 22 seconds 130 msec
INFO  : Completed executing command(queryId=hive_20180327190000_4ea07f8b-ce35-45ae-8078-c45df9ec7b0a); Time taken: 42.917 seconds
INFO  : OK
No rows affected (43.157 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_online_dpsm_s_list_new_processed;
INFO  : Compiling command(queryId=hive_20180327190101_d5d5b0d3-3a2d-4e9e-b700-bd743606ef2a): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190101_d5d5b0d3-3a2d-4e9e-b700-bd743606ef2a); Time taken: 0.1 seconds
INFO  : Executing command(queryId=hive_20180327190101_d5d5b0d3-3a2d-4e9e-b700-bd743606ef2a): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_online_dpsm_s_list_new_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190101_d5d5b0d3-3a2d-4e9e-b700-bd743606ef2a); Time taken: 0.051 seconds
INFO  : OK
No rows affected (0.158 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table tb_online_dpsm_s_list_new.
Moving raw data to archive location for table tb_online_dpsm_s_list_new.
tb_online_dpsm_s_list_new tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 2ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.055 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327190101_d7dd0fca-28af-4741-80d5-60bfd4e11110): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190101_d7dd0fca-28af-4741-80d5-60bfd4e11110); Time taken: 0.136 seconds
INFO  : Executing command(queryId=hive_20180327190101_d7dd0fca-28af-4741-80d5-60bfd4e11110): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190101_d7dd0fca-28af-4741-80d5-60bfd4e11110); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.157 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_penetration_list_raw ;
INFO  : Compiling command(queryId=hive_20180327190101_1d716f16-2a15-49c1-9638-621b0e910be5): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_penetration_list_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190101_1d716f16-2a15-49c1-9638-621b0e910be5); Time taken: 0.099 seconds
INFO  : Executing command(queryId=hive_20180327190101_1d716f16-2a15-49c1-9638-621b0e910be5): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_penetration_list_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190101_1d716f16-2a15-49c1-9638-621b0e910be5); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.109 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_penetration_list_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> classification STRING,
. . . . . . . . . . . . . . . . . . . . . . .> classification2 STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> year_src int,
. . . . . . . . . . . . . . . . . . . . . . .> month_src int,
. . . . . . . . . . . . . . . . . . . . . . .> target decimal(10,2)
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327190101_4edc9028-2e3b-46de-ab6d-eb2102700eed): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_penetration_list_raw
(
sku_cd bigint,
classification STRING,
classification2 STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target decimal(10,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_penetration_list_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190101_4edc9028-2e3b-46de-ab6d-eb2102700eed); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180327190101_4edc9028-2e3b-46de-ab6d-eb2102700eed): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_penetration_list_raw
(
sku_cd bigint,
classification STRING,
classification2 STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target decimal(10,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_penetration_list_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190101_4edc9028-2e3b-46de-ab6d-eb2102700eed); Time taken: 0.383 seconds
INFO  : OK
No rows affected (0.489 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_penetration_list_processed ;
INFO  : Compiling command(queryId=hive_20180327190101_b71e4d59-601b-4b78-9094-bd458c2d923c): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_penetration_list_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190101_b71e4d59-601b-4b78-9094-bd458c2d923c); Time taken: 0.118 seconds
INFO  : Executing command(queryId=hive_20180327190101_b71e4d59-601b-4b78-9094-bd458c2d923c): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_penetration_list_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190101_b71e4d59-601b-4b78-9094-bd458c2d923c); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.128 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_penetration_list_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> classification STRING,
. . . . . . . . . . . . . . . . . . . . . . .> classification2 STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mod_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> year_src int,
. . . . . . . . . . . . . . . . . . . . . . .> month_src int,
. . . . . . . . . . . . . . . . . . . . . . .> target decimal(10,2)
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327190101_1d20a37c-881e-443e-bf99-e6904e56f58c): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_penetration_list_processed
(
sku_cd bigint,
classification STRING,
classification2 STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target decimal(10,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_penetration_list_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190101_1d20a37c-881e-443e-bf99-e6904e56f58c); Time taken: 0.147 seconds
INFO  : Executing command(queryId=hive_20180327190101_1d20a37c-881e-443e-bf99-e6904e56f58c): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_penetration_list_processed
(
sku_cd bigint,
classification STRING,
classification2 STRING,
use_yn char(1),
mod_date timestamp,
reg_date timestamp,
year_src int,
month_src int,
target decimal(10,2)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_penetration_list_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190101_1d20a37c-881e-443e-bf99-e6904e56f58c); Time taken: 0.18 seconds
INFO  : OK
No rows affected (0.34 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_penetration_list_raw;
INFO  : Compiling command(queryId=hive_20180327190101_766bef69-6ced-4e01-bb1a-e8f73c2aa52c): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_penetration_list_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190101_766bef69-6ced-4e01-bb1a-e8f73c2aa52c); Time taken: 0.097 seconds
INFO  : Executing command(queryId=hive_20180327190101_766bef69-6ced-4e01-bb1a-e8f73c2aa52c): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_penetration_list_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190101_766bef69-6ced-4e01-bb1a-e8f73c2aa52c); Time taken: 0.081 seconds
INFO  : OK
No rows affected (0.183 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.tb_penetration_list_processed PARTITION (ingestion_date)
. . . . . . . . . . . . . . . . . . . . . . .> select
. . . . . . . . . . . . . . . . . . . . . . .> r.sku_cd,
. . . . . . . . . . . . . . . . . . . . . . .> r.classification,
. . . . . . . . . . . . . . . . . . . . . . .> r.classification2,
. . . . . . . . . . . . . . . . . . . . . . .> r.use_yn,
. . . . . . . . . . . . . . . . . . . . . . .> r.mod_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.reg_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.year_src,
. . . . . . . . . . . . . . . . . . . . . . .> r.month_src ,
. . . . . . . . . . . . . . . . . . . . . . .> r.target,
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.tb_penetration_list_raw r;
INFO  : Compiling command(queryId=hive_20180327190101_d120b838-2c46-4aeb-baf2-1802a83a9ac9): insert into table prd_ykdl_adhoc_db.tb_penetration_list_processed PARTITION (ingestion_date)
select
r.sku_cd,
r.classification,
r.classification2,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src ,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_penetration_list_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.sku_cd, type:bigint, comment:null), FieldSchema(name:r.classification, type:string, comment:null), FieldSchema(name:r.classification2, type:string, comment:null), FieldSchema(name:r.use_yn, type:char(1), comment:null), FieldSchema(name:r.mod_date, type:timestamp, comment:null), FieldSchema(name:r.reg_date, type:timestamp, comment:null), FieldSchema(name:r.year_src, type:int, comment:null), FieldSchema(name:r.month_src, type:int, comment:null), FieldSchema(name:r.target, type:decimal(10,2), comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190101_d120b838-2c46-4aeb-baf2-1802a83a9ac9); Time taken: 0.212 seconds
INFO  : Executing command(queryId=hive_20180327190101_d120b838-2c46-4aeb-baf2-1802a83a9ac9): insert into table prd_ykdl_adhoc_db.tb_penetration_list_processed PARTITION (ingestion_date)
select
r.sku_cd,
r.classification,
r.classification2,
r.use_yn,
r.mod_date,
r.reg_date,
r.year_src,
r.month_src ,
r.target,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_penetration_list_raw r
INFO  : Query ID = hive_20180327190101_d120b838-2c46-4aeb-baf2-1802a83a9ac9
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:3
INFO  : Submitting tokens for job: job_1521666602777_0950
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177282950, maxDate=1522782082950, sequenceNumber=40342, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177282898, maxDate=1522782082898, sequenceNumber=40341, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177282877, maxDate=1522782082877, sequenceNumber=27542, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0950/
INFO  : Starting Job = job_1521666602777_0950, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0950/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0950
INFO  : Hadoop job information for Stage-1: number of mappers: 3; number of reducers: 0
INFO  : 2018-03-27 19:01:32,014 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 19:01:43,465 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 25.5 sec
INFO  : MapReduce Total cumulative CPU time: 25 seconds 500 msec
INFO  : Ended Job = job_1521666602777_0950
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is filtered out by condition resolver.
INFO  : Stage-3 is selected by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Launching Job 3 out of 3
INFO  : Starting task [Stage-3:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0951
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177304709, maxDate=1522782104709, sequenceNumber=40343, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177304761, maxDate=1522782104761, sequenceNumber=40344, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177304690, maxDate=1522782104690, sequenceNumber=27543, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0951/
INFO  : Starting Job = job_1521666602777_0951, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0951/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0951
INFO  : Hadoop job information for Stage-3: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 19:01:53,835 Stage-3 map = 0%,  reduce = 0%
INFO  : 2018-03-27 19:02:04,214 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 8.36 sec
INFO  : MapReduce Total cumulative CPU time: 8 seconds 360 msec
INFO  : Ended Job = job_1521666602777_0951
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.tb_penetration_list_processed partition (ingestion_date=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_penetration_list_processed/.hive-staging_hive_2018-03-27_19-01-22_496_4420720839208027046-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 99
INFO  : 	Loading partition {ingestion_date=19990101}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.tb_penetration_list_processed{ingestion_date=19990101} stats: [numFiles=1, numRows=1542, totalSize=14933, rawDataSize=13878]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 3   Cumulative CPU: 25.5 sec   HDFS Read: 36156 HDFS Write: 18751 SUCCESS
INFO  : Stage-Stage-3: Map: 1   Cumulative CPU: 8.36 sec   HDFS Read: 27714 HDFS Write: 14933 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 33 seconds 860 msec
INFO  : Completed executing command(queryId=hive_20180327190101_d120b838-2c46-4aeb-baf2-1802a83a9ac9); Time taken: 43.97 seconds
INFO  : OK
No rows affected (44.205 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_penetration_list_processed;
INFO  : Compiling command(queryId=hive_20180327190202_115deb9d-a567-4ec9-b3af-5f5107157a45): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_penetration_list_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_115deb9d-a567-4ec9-b3af-5f5107157a45); Time taken: 0.09 seconds
INFO  : Executing command(queryId=hive_20180327190202_115deb9d-a567-4ec9-b3af-5f5107157a45): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_penetration_list_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_115deb9d-a567-4ec9-b3af-5f5107157a45); Time taken: 0.049 seconds
INFO  : OK
No rows affected (0.144 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table tb_penetration_list.
Moving raw data to archive location for table tb_penetration_list.
tb_penetration_list tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.046 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327190202_cf2271af-619f-41ff-9cb1-3aa1417deea0): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_cf2271af-619f-41ff-9cb1-3aa1417deea0); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327190202_cf2271af-619f-41ff-9cb1-3aa1417deea0): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_cf2271af-619f-41ff-9cb1-3aa1417deea0); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.129 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_sku_master_raw ;
INFO  : Compiling command(queryId=hive_20180327190202_71980047-badd-44d0-8ec0-aa7426daace8): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_sku_master_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_71980047-badd-44d0-8ec0-aa7426daace8); Time taken: 0.093 seconds
INFO  : Executing command(queryId=hive_20180327190202_71980047-badd-44d0-8ec0-aa7426daace8): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_sku_master_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_71980047-badd-44d0-8ec0-aa7426daace8); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.102 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_sku_master_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> product_cd varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> product_name STRING,
. . . . . . . . . . . . . . . . . . . . . . .> biz_category STRING,
. . . . . . . . . . . . . . . . . . . . . . .> product_category_cd varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> product_category_name varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> brand_cd varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> brand_name varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> sub_brand_cd varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> sub_brand_name varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> ean13 varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> ean14 varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> main_vision varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> primary_division varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> secondary_division varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> work_group STRING,
. . . . . . . . . . . . . . . . . . . . . . .> ctg varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> vision_category varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> vlt varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> factorial_mart STRING,
. . . . . . . . . . . . . . . . . . . . . . .> sub_category varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> comment_src STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mode_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> product_name_eng varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> second_product_name STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327190202_41601bc7-9dee-49f8-878b-b78d4c97c265): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_sku_master_raw
(
sku_cd bigint,
product_cd varchar(150),
product_name STRING,
biz_category STRING,
product_category_cd varchar(150),
product_category_name varchar(150),
brand_cd varchar(150),
brand_name varchar(150),
sub_brand_cd varchar(150),
sub_brand_name varchar(150),
ean13 varchar(150),
ean14 varchar(150),
main_vision varchar(150),
primary_division varchar(150),
secondary_division varchar(150),
work_group STRING,
ctg varchar(150),
vision_category varchar(150),
vlt varchar(150),
factorial_mart STRING,
sub_category varchar(150),
comment_src STRING,
use_yn char(1),
mode_date timestamp,
reg_date timestamp,
product_name_eng varchar(150),
second_product_name STRING
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_sku_master_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_41601bc7-9dee-49f8-878b-b78d4c97c265); Time taken: 0.11 seconds
INFO  : Executing command(queryId=hive_20180327190202_41601bc7-9dee-49f8-878b-b78d4c97c265): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_sku_master_raw
(
sku_cd bigint,
product_cd varchar(150),
product_name STRING,
biz_category STRING,
product_category_cd varchar(150),
product_category_name varchar(150),
brand_cd varchar(150),
brand_name varchar(150),
sub_brand_cd varchar(150),
sub_brand_name varchar(150),
ean13 varchar(150),
ean14 varchar(150),
main_vision varchar(150),
primary_division varchar(150),
secondary_division varchar(150),
work_group STRING,
ctg varchar(150),
vision_category varchar(150),
vlt varchar(150),
factorial_mart STRING,
sub_category varchar(150),
comment_src STRING,
use_yn char(1),
mode_date timestamp,
reg_date timestamp,
product_name_eng varchar(150),
second_product_name STRING
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_sku_master_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_41601bc7-9dee-49f8-878b-b78d4c97c265); Time taken: 0.517 seconds
INFO  : OK
No rows affected (0.642 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.tb_sku_master_processed ;
INFO  : Compiling command(queryId=hive_20180327190202_f06e33bd-530f-4a87-91a8-6b23a62d0df2): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_sku_master_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_f06e33bd-530f-4a87-91a8-6b23a62d0df2); Time taken: 0.107 seconds
INFO  : Executing command(queryId=hive_20180327190202_f06e33bd-530f-4a87-91a8-6b23a62d0df2): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.tb_sku_master_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_f06e33bd-530f-4a87-91a8-6b23a62d0df2); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.118 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.tb_sku_master_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> product_cd varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> product_name STRING,
. . . . . . . . . . . . . . . . . . . . . . .> biz_category STRING,
. . . . . . . . . . . . . . . . . . . . . . .> product_category_cd varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> product_category_name varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> brand_cd varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> brand_name varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> sub_brand_cd varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> sub_brand_name varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> ean13 varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> ean14 varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> main_vision varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> primary_division varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> secondary_division varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> work_group STRING,
. . . . . . . . . . . . . . . . . . . . . . .> ctg varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> vision_category varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> vlt varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> factorial_mart STRING,
. . . . . . . . . . . . . . . . . . . . . . .> sub_category varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> comment_src STRING,
. . . . . . . . . . . . . . . . . . . . . . .> use_yn char(1),
. . . . . . . . . . . . . . . . . . . . . . .> mode_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> product_name_eng varchar(150),
. . . . . . . . . . . . . . . . . . . . . . .> second_product_name STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327190202_25fe43f5-a56e-45e8-9468-9a9d381c75dc): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_sku_master_processed
(
sku_cd bigint,
product_cd varchar(150),
product_name STRING,
biz_category STRING,
product_category_cd varchar(150),
product_category_name varchar(150),
brand_cd varchar(150),
brand_name varchar(150),
sub_brand_cd varchar(150),
sub_brand_name varchar(150),
ean13 varchar(150),
ean14 varchar(150),
main_vision varchar(150),
primary_division varchar(150),
secondary_division varchar(150),
work_group STRING,
ctg varchar(150),
vision_category varchar(150),
vlt varchar(150),
factorial_mart STRING,
sub_category varchar(150),
comment_src STRING,
use_yn char(1),
mode_date timestamp,
reg_date timestamp,
product_name_eng varchar(150),
second_product_name STRING
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_sku_master_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_25fe43f5-a56e-45e8-9468-9a9d381c75dc); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327190202_25fe43f5-a56e-45e8-9468-9a9d381c75dc): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.tb_sku_master_processed
(
sku_cd bigint,
product_cd varchar(150),
product_name STRING,
biz_category STRING,
product_category_cd varchar(150),
product_category_name varchar(150),
brand_cd varchar(150),
brand_name varchar(150),
sub_brand_cd varchar(150),
sub_brand_name varchar(150),
ean13 varchar(150),
ean14 varchar(150),
main_vision varchar(150),
primary_division varchar(150),
secondary_division varchar(150),
work_group STRING,
ctg varchar(150),
vision_category varchar(150),
vlt varchar(150),
factorial_mart STRING,
sub_category varchar(150),
comment_src STRING,
use_yn char(1),
mode_date timestamp,
reg_date timestamp,
product_name_eng varchar(150),
second_product_name STRING
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '^'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_sku_master_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_25fe43f5-a56e-45e8-9468-9a9d381c75dc); Time taken: 0.238 seconds
INFO  : OK
No rows affected (0.348 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_sku_master_raw;
INFO  : Compiling command(queryId=hive_20180327190202_122aa77f-f718-4397-b4ff-28e5eae987c3): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_sku_master_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_122aa77f-f718-4397-b4ff-28e5eae987c3); Time taken: 0.093 seconds
INFO  : Executing command(queryId=hive_20180327190202_122aa77f-f718-4397-b4ff-28e5eae987c3): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_sku_master_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_122aa77f-f718-4397-b4ff-28e5eae987c3); Time taken: 0.085 seconds
INFO  : OK
No rows affected (0.184 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.002 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert overwrite table ${hivedb}.tb_sku_master_processed PARTITION (ingestion_date)
. . . . . . . . . . . . . . . . . . . . . . .> select
. . . . . . . . . . . . . . . . . . . . . . .> r.sku_cd,
. . . . . . . . . . . . . . . . . . . . . . .> r.product_cd,
. . . . . . . . . . . . . . . . . . . . . . .> r.product_name,
. . . . . . . . . . . . . . . . . . . . . . .> r.biz_category,
. . . . . . . . . . . . . . . . . . . . . . .> r.product_category_cd,
. . . . . . . . . . . . . . . . . . . . . . .> r.product_category_name,
. . . . . . . . . . . . . . . . . . . . . . .> r.brand_cd,
. . . . . . . . . . . . . . . . . . . . . . .> r.brand_name,
. . . . . . . . . . . . . . . . . . . . . . .> r.sub_brand_cd,
. . . . . . . . . . . . . . . . . . . . . . .> r.sub_brand_name,
. . . . . . . . . . . . . . . . . . . . . . .> r.ean13,
. . . . . . . . . . . . . . . . . . . . . . .> r.ean14,
. . . . . . . . . . . . . . . . . . . . . . .> r.main_vision,
. . . . . . . . . . . . . . . . . . . . . . .> r.primary_division,
. . . . . . . . . . . . . . . . . . . . . . .> r.secondary_division,
. . . . . . . . . . . . . . . . . . . . . . .> r.work_group,
. . . . . . . . . . . . . . . . . . . . . . .> r.ctg,
. . . . . . . . . . . . . . . . . . . . . . .> r.vision_category,
. . . . . . . . . . . . . . . . . . . . . . .> r.vlt,
. . . . . . . . . . . . . . . . . . . . . . .> r.factorial_mart,
. . . . . . . . . . . . . . . . . . . . . . .> r.sub_category,
. . . . . . . . . . . . . . . . . . . . . . .> r.comment_src,
. . . . . . . . . . . . . . . . . . . . . . .> r.use_yn,
. . . . . . . . . . . . . . . . . . . . . . .> r.mode_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.reg_date,
. . . . . . . . . . . . . . . . . . . . . . .> r.product_name_eng,
. . . . . . . . . . . . . . . . . . . . . . .> r.second_product_name,
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.tb_sku_master_raw r;
INFO  : Compiling command(queryId=hive_20180327190202_313b1fd3-df8b-4b9a-b836-ee6870445884): insert overwrite table prd_ykdl_adhoc_db.tb_sku_master_processed PARTITION (ingestion_date)
select
r.sku_cd,
r.product_cd,
r.product_name,
r.biz_category,
r.product_category_cd,
r.product_category_name,
r.brand_cd,
r.brand_name,
r.sub_brand_cd,
r.sub_brand_name,
r.ean13,
r.ean14,
r.main_vision,
r.primary_division,
r.secondary_division,
r.work_group,
r.ctg,
r.vision_category,
r.vlt,
r.factorial_mart,
r.sub_category,
r.comment_src,
r.use_yn,
r.mode_date,
r.reg_date,
r.product_name_eng,
r.second_product_name,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_sku_master_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:r.sku_cd, type:bigint, comment:null), FieldSchema(name:r.product_cd, type:varchar(150), comment:null), FieldSchema(name:r.product_name, type:string, comment:null), FieldSchema(name:r.biz_category, type:string, comment:null), FieldSchema(name:r.product_category_cd, type:varchar(150), comment:null), FieldSchema(name:r.product_category_name, type:varchar(150), comment:null), FieldSchema(name:r.brand_cd, type:varchar(150), comment:null), FieldSchema(name:r.brand_name, type:varchar(150), comment:null), FieldSchema(name:r.sub_brand_cd, type:varchar(150), comment:null), FieldSchema(name:r.sub_brand_name, type:varchar(150), comment:null), FieldSchema(name:r.ean13, type:varchar(150), comment:null), FieldSchema(name:r.ean14, type:varchar(150), comment:null), FieldSchema(name:r.main_vision, type:varchar(150), comment:null), FieldSchema(name:r.primary_division, type:varchar(150), comment:null), FieldSchema(name:r.secondary_division, type:varchar(150), comment:null), FieldSchema(name:r.work_group, type:string, comment:null), FieldSchema(name:r.ctg, type:varchar(150), comment:null), FieldSchema(name:r.vision_category, type:varchar(150), comment:null), FieldSchema(name:r.vlt, type:varchar(150), comment:null), FieldSchema(name:r.factorial_mart, type:string, comment:null), FieldSchema(name:r.sub_category, type:varchar(150), comment:null), FieldSchema(name:r.comment_src, type:string, comment:null), FieldSchema(name:r.use_yn, type:char(1), comment:null), FieldSchema(name:r.mode_date, type:timestamp, comment:null), FieldSchema(name:r.reg_date, type:timestamp, comment:null), FieldSchema(name:r.product_name_eng, type:varchar(150), comment:null), FieldSchema(name:r.second_product_name, type:string, comment:null), FieldSchema(name:r.ingestion_date, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_313b1fd3-df8b-4b9a-b836-ee6870445884); Time taken: 0.197 seconds
INFO  : Executing command(queryId=hive_20180327190202_313b1fd3-df8b-4b9a-b836-ee6870445884): insert overwrite table prd_ykdl_adhoc_db.tb_sku_master_processed PARTITION (ingestion_date)
select
r.sku_cd,
r.product_cd,
r.product_name,
r.biz_category,
r.product_category_cd,
r.product_category_name,
r.brand_cd,
r.brand_name,
r.sub_brand_cd,
r.sub_brand_name,
r.ean13,
r.ean14,
r.main_vision,
r.primary_division,
r.secondary_division,
r.work_group,
r.ctg,
r.vision_category,
r.vlt,
r.factorial_mart,
r.sub_category,
r.comment_src,
r.use_yn,
r.mode_date,
r.reg_date,
r.product_name_eng,
r.second_product_name,
r.ingestion_date
from prd_ykdl_adhoc_db.tb_sku_master_raw r
INFO  : Query ID = hive_20180327190202_313b1fd3-df8b-4b9a-b836-ee6870445884
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:1
INFO  : Submitting tokens for job: job_1521666602777_0952
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177337895, maxDate=1522782137895, sequenceNumber=40345, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177337943, maxDate=1522782137943, sequenceNumber=40346, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177337876, maxDate=1522782137876, sequenceNumber=27544, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0952/
INFO  : Starting Job = job_1521666602777_0952, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0952/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0952
INFO  : Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
INFO  : 2018-03-27 19:02:27,023 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 19:02:37,435 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 11.13 sec
INFO  : MapReduce Total cumulative CPU time: 11 seconds 130 msec
INFO  : Ended Job = job_1521666602777_0952
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_sku_master_processed/.hive-staging_hive_2018-03-27_19-02-17_510_4600025533780697355-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_sku_master_processed/.hive-staging_hive_2018-03-27_19-02-17_510_4600025533780697355-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.tb_sku_master_processed partition (ingestion_date=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/tb_sku_master_processed/.hive-staging_hive_2018-03-27_19-02-17_510_4600025533780697355-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 108
INFO  : 	Loading partition {ingestion_date=19990101}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.tb_sku_master_processed{ingestion_date=19990101} stats: [numFiles=1, numRows=7065, totalSize=696783, rawDataSize=190755]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 1   Cumulative CPU: 11.13 sec   HDFS Read: 465947 HDFS Write: 696912 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 11 seconds 130 msec
INFO  : Completed executing command(queryId=hive_20180327190202_313b1fd3-df8b-4b9a-b836-ee6870445884); Time taken: 21.171 seconds
INFO  : OK
No rows affected (21.389 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.tb_sku_master_processed;
INFO  : Compiling command(queryId=hive_20180327190202_2a326877-16f4-4bda-b7ed-a15e61ce76ef): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_sku_master_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_2a326877-16f4-4bda-b7ed-a15e61ce76ef); Time taken: 0.1 seconds
INFO  : Executing command(queryId=hive_20180327190202_2a326877-16f4-4bda-b7ed-a15e61ce76ef): MSCK REPAIR TABLE prd_ykdl_adhoc_db.tb_sku_master_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_2a326877-16f4-4bda-b7ed-a15e61ce76ef); Time taken: 0.057 seconds
INFO  : OK
No rows affected (0.163 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table tb_sku_master.
Moving raw data to archive location for table tb_sku_master.
tb_sku_master tables created successfully and processed the data
Initiating authentication
Executing HQL
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.variable.substitute=true;
No rows affected (0.053 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180327190202_4bdbca90-0a8d-466a-9926-c0fb7760a8b2): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_4bdbca90-0a8d-466a-9926-c0fb7760a8b2); Time taken: 0.112 seconds
INFO  : Executing command(queryId=hive_20180327190202_4bdbca90-0a8d-466a-9926-c0fb7760a8b2): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_4bdbca90-0a8d-466a-9926-c0fb7760a8b2); Time taken: 0.011 seconds
INFO  : OK
No rows affected (0.134 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-1:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating stage table
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_collected_data_raw;
INFO  : Compiling command(queryId=hive_20180327190202_4855eb00-6491-48f7-b26d-2ab58b421abc): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_collected_data_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_4855eb00-6491-48f7-b26d-2ab58b421abc); Time taken: 0.097 seconds
INFO  : Executing command(queryId=hive_20180327190202_4855eb00-6491-48f7-b26d-2ab58b421abc): DROP TABLE IF EXISTS prd_ykdl_adhoc_db.shelfon_collected_data_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_4855eb00-6491-48f7-b26d-2ab58b421abc); Time taken: 0.004 seconds
INFO  : OK
No rows affected (0.107 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_collected_data_raw
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> npid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> ngid varchar(64) ,
. . . . . . . . . . . . . . . . . . . . . . .> npgid varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> site varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> site_pid varchar(128) ,
. . . . . . . . . . . . . . . . . . . . . . .> wave bigint,
. . . . . . . . . . . . . . . . . . . . . . .> sale_type varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> url varchar(1024) ,
. . . . . . . . . . . . . . . . . . . . . . .> img varchar(200) ,
. . . . . . . . . . . . . . . . . . . . . . .> title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> collected_madeby STRING,
. . . . . . . . . . . . . . . . . . . . . . .> collected_brand STRING,
. . . . . . . . . . . . . . . . . . . . . . .> tr_madeby STRING,
. . . . . . . . . . . . . . . . . . . . . . .> tr_brand STRING,
. . . . . . . . . . . . . . . . . . . . . . .> sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> rolling_position int,
. . . . . . . . . . . . . . . . . . . . . . .> seller_size int,
. . . . . . . . . . . . . . . . . . . . . . .> comment_size bigint,
. . . . . . . . . . . . . . . . . . . . . . .> section_name varchar(64) ,
. . . . . . . . . . . . . . . . . . . . . . .> section_position int,
. . . . . . . . . . . . . . . . . . . . . . .> total_position int,
. . . . . . . . . . . . . . . . . . . . . . .> page int,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> rdate date,
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> hashcode varchar(32)
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> partitioned by (ingestion_date String)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${rawFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327190202_94c7065c-b015-4d34-9dea-0c5e316a99ef): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_collected_data_raw
(
shelfon_data_seq bigint,
id varchar(32) ,
npid bigint,
ngid varchar(64) ,
npgid varchar(32) ,
site varchar(32) ,
site_pid varchar(128) ,
wave bigint,
sale_type varchar(32) ,
url varchar(1024) ,
img varchar(200) ,
title STRING,
collected_madeby STRING,
collected_brand STRING,
tr_madeby STRING,
tr_brand STRING,
sale_price decimal(21,2),
rolling_position int,
seller_size int,
comment_size bigint,
section_name varchar(64) ,
section_position int,
total_position int,
page int,
rtime timestamp,
rdate date,
sku_cd bigint,
hashcode varchar(32)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_data_raw/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_94c7065c-b015-4d34-9dea-0c5e316a99ef); Time taken: 0.095 seconds
INFO  : Executing command(queryId=hive_20180327190202_94c7065c-b015-4d34-9dea-0c5e316a99ef): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_collected_data_raw
(
shelfon_data_seq bigint,
id varchar(32) ,
npid bigint,
ngid varchar(64) ,
npgid varchar(32) ,
site varchar(32) ,
site_pid varchar(128) ,
wave bigint,
sale_type varchar(32) ,
url varchar(1024) ,
img varchar(200) ,
title STRING,
collected_madeby STRING,
collected_brand STRING,
tr_madeby STRING,
tr_brand STRING,
sale_price decimal(21,2),
rolling_position int,
seller_size int,
comment_size bigint,
section_name varchar(64) ,
section_position int,
total_position int,
page int,
rtime timestamp,
rdate date,
sku_cd bigint,
hashcode varchar(32)
)
partitioned by (ingestion_date String)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_data_raw/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_94c7065c-b015-4d34-9dea-0c5e316a99ef); Time taken: 0.146 seconds
INFO  : OK
No rows affected (0.256 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Step-2:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --Creating Processed table
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS  ${hivedb}.shelfon_collected_data_processed ;
INFO  : Compiling command(queryId=hive_20180327190202_707b3648-0890-4450-b4c5-c442e6586be7): DROP TABLE IF EXISTS  prd_ykdl_adhoc_db.shelfon_collected_data_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_707b3648-0890-4450-b4c5-c442e6586be7); Time taken: 0.109 seconds
INFO  : Executing command(queryId=hive_20180327190202_707b3648-0890-4450-b4c5-c442e6586be7): DROP TABLE IF EXISTS  prd_ykdl_adhoc_db.shelfon_collected_data_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_707b3648-0890-4450-b4c5-c442e6586be7); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.119 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS ${hivedb}.shelfon_collected_data_processed
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_data_seq bigint,
. . . . . . . . . . . . . . . . . . . . . . .> id varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> npid bigint,
. . . . . . . . . . . . . . . . . . . . . . .> ngid varchar(64) ,
. . . . . . . . . . . . . . . . . . . . . . .> npgid varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> site varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> site_pid varchar(128) ,
. . . . . . . . . . . . . . . . . . . . . . .> wave bigint,
. . . . . . . . . . . . . . . . . . . . . . .> sale_type varchar(32) ,
. . . . . . . . . . . . . . . . . . . . . . .> url varchar(1024) ,
. . . . . . . . . . . . . . . . . . . . . . .> img varchar(200) ,
. . . . . . . . . . . . . . . . . . . . . . .> title STRING,
. . . . . . . . . . . . . . . . . . . . . . .> collected_madeby STRING,
. . . . . . . . . . . . . . . . . . . . . . .> collected_brand STRING,
. . . . . . . . . . . . . . . . . . . . . . .> tr_madeby STRING,
. . . . . . . . . . . . . . . . . . . . . . .> tr_brand STRING,
. . . . . . . . . . . . . . . . . . . . . . .> sale_price decimal(21,2),
. . . . . . . . . . . . . . . . . . . . . . .> rolling_position int,
. . . . . . . . . . . . . . . . . . . . . . .> seller_size int,
. . . . . . . . . . . . . . . . . . . . . . .> comment_size bigint,
. . . . . . . . . . . . . . . . . . . . . . .> section_name varchar(64) ,
. . . . . . . . . . . . . . . . . . . . . . .> section_position int,
. . . . . . . . . . . . . . . . . . . . . . .> total_position int,
. . . . . . . . . . . . . . . . . . . . . . .> page int,
. . . . . . . . . . . . . . . . . . . . . . .> rtime timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> rdate timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd bigint,
. . . . . . . . . . . . . . . . . . . . . . .> hashcode varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> record_type STRING,
. . . . . . . . . . . . . . . . . . . . . . .> delete_flag STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (ingestion_date STRING, active_flag STRING)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LINES TERMINATED BY '\n'
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS parquet
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${processedFilePath}' ;
INFO  : Compiling command(queryId=hive_20180327190202_99eeeb09-210d-4505-a825-e99b83748c96): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_collected_data_processed
(
shelfon_data_seq bigint,
id varchar(32) ,
npid bigint,
ngid varchar(64) ,
npgid varchar(32) ,
site varchar(32) ,
site_pid varchar(128) ,
wave bigint,
sale_type varchar(32) ,
url varchar(1024) ,
img varchar(200) ,
title STRING,
collected_madeby STRING,
collected_brand STRING,
tr_madeby STRING,
tr_brand STRING,
sale_price decimal(21,2),
rolling_position int,
seller_size int,
comment_size bigint,
section_name varchar(64) ,
section_position int,
total_position int,
page int,
rtime timestamp,
rdate timestamp,
sku_cd bigint,
hashcode varchar(32),
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_data_processed/'
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_99eeeb09-210d-4505-a825-e99b83748c96); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180327190202_99eeeb09-210d-4505-a825-e99b83748c96): CREATE EXTERNAL TABLE IF NOT EXISTS prd_ykdl_adhoc_db.shelfon_collected_data_processed
(
shelfon_data_seq bigint,
id varchar(32) ,
npid bigint,
ngid varchar(64) ,
npgid varchar(32) ,
site varchar(32) ,
site_pid varchar(128) ,
wave bigint,
sale_type varchar(32) ,
url varchar(1024) ,
img varchar(200) ,
title STRING,
collected_madeby STRING,
collected_brand STRING,
tr_madeby STRING,
tr_brand STRING,
sale_price decimal(21,2),
rolling_position int,
seller_size int,
comment_size bigint,
section_name varchar(64) ,
section_position int,
total_position int,
page int,
rtime timestamp,
rdate timestamp,
sku_cd bigint,
hashcode varchar(32),
record_type STRING,
delete_flag STRING
)
PARTITIONED BY (ingestion_date STRING, active_flag STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\001'
LINES TERMINATED BY '\n'
STORED AS parquet
LOCATION '/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_data_processed/'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_99eeeb09-210d-4505-a825-e99b83748c96); Time taken: 0.252 seconds
INFO  : OK
No rows affected (0.362 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> --#Step-3:
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---#Loading data from stage table to processed table 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_collected_data_raw;
INFO  : Compiling command(queryId=hive_20180327190202_126a8fe0-6012-4a90-917e-186a9dc60a8a): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_collected_data_raw
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_126a8fe0-6012-4a90-917e-186a9dc60a8a); Time taken: 0.092 seconds
INFO  : Executing command(queryId=hive_20180327190202_126a8fe0-6012-4a90-917e-186a9dc60a8a): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_collected_data_raw
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327190202_126a8fe0-6012-4a90-917e-186a9dc60a8a); Time taken: 0.087 seconds
INFO  : OK
No rows affected (0.184 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.003 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> insert into table ${hivedb}.shelfon_collected_data_processed PARTITION (ingestion_date  , active_flag)
. . . . . . . . . . . . . . . . . . . . . . .> select 
. . . . . . . . . . . . . . . . . . . . . . .>  r.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .> , r.id
. . . . . . . . . . . . . . . . . . . . . . .> , r.npid
. . . . . . . . . . . . . . . . . . . . . . .> , r.ngid
. . . . . . . . . . . . . . . . . . . . . . .> , r.npgid
. . . . . . . . . . . . . . . . . . . . . . .> , r.site
. . . . . . . . . . . . . . . . . . . . . . .> , r.site_pid
. . . . . . . . . . . . . . . . . . . . . . .> , r.wave
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_type
. . . . . . . . . . . . . . . . . . . . . . .> , r.url
. . . . . . . . . . . . . . . . . . . . . . .> , r.img
. . . . . . . . . . . . . . . . . . . . . . .> , r.title
. . . . . . . . . . . . . . . . . . . . . . .> , r.collected_madeby
. . . . . . . . . . . . . . . . . . . . . . .> , r.collected_brand
. . . . . . . . . . . . . . . . . . . . . . .> , r.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .> , r.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .> , r.sale_price
. . . . . . . . . . . . . . . . . . . . . . .> , r.rolling_position
. . . . . . . . . . . . . . . . . . . . . . .> , r.seller_size
. . . . . . . . . . . . . . . . . . . . . . .> , r.comment_size
. . . . . . . . . . . . . . . . . . . . . . .> , r.section_name
. . . . . . . . . . . . . . . . . . . . . . .> , r.section_position
. . . . . . . . . . . . . . . . . . . . . . .> , r.total_position
. . . . . . . . . . . . . . . . . . . . . . .> , r.page
. . . . . . . . . . . . . . . . . . . . . . .> , r.rtime
. . . . . . . . . . . . . . . . . . . . . . .> , r.rdate
. . . . . . . . . . . . . . . . . . . . . . .> , r.sku_cd
. . . . . . . . . . . . . . . . . . . . . . .> , r.hashcode ,
. . . . . . . . . . . . . . . . . . . . . . .> "HISTORY",
. . . . . . . . . . . . . . . . . . . . . . .> "N",
. . . . . . . . . . . . . . . . . . . . . . .> r.ingestion_date,
. . . . . . . . . . . . . . . . . . . . . . .> "Y"
. . . . . . . . . . . . . . . . . . . . . . .> from ${hivedb}.shelfon_collected_data_raw r;
INFO  : Compiling command(queryId=hive_20180327190202_e7f5fac4-eb74-42e7-92fa-6158c6aa9a40): insert into table prd_ykdl_adhoc_db.shelfon_collected_data_processed PARTITION (ingestion_date , active_flag)
select
r.shelfon_data_seq
, r.id
, r.npid
, r.ngid
, r.npgid
, r.site
, r.site_pid
, r.wave
, r.sale_type
, r.url
, r.img
, r.title
, r.collected_madeby
, r.collected_brand
, r.tr_madeby
, r.tr_brand
, r.sale_price
, r.rolling_position
, r.seller_size
, r.comment_size
, r.section_name
, r.section_position
, r.total_position
, r.page
, r.rtime
, r.rdate
, r.sku_cd
, r.hashcode ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_collected_data_raw r
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:_col0, type:bigint, comment:null), FieldSchema(name:_col1, type:varchar(32), comment:null), FieldSchema(name:_col2, type:bigint, comment:null), FieldSchema(name:_col3, type:varchar(64), comment:null), FieldSchema(name:_col4, type:varchar(32), comment:null), FieldSchema(name:_col5, type:varchar(32), comment:null), FieldSchema(name:_col6, type:varchar(128), comment:null), FieldSchema(name:_col7, type:bigint, comment:null), FieldSchema(name:_col8, type:varchar(32), comment:null), FieldSchema(name:_col9, type:varchar(1024), comment:null), FieldSchema(name:_col10, type:varchar(200), comment:null), FieldSchema(name:_col11, type:string, comment:null), FieldSchema(name:_col12, type:string, comment:null), FieldSchema(name:_col13, type:string, comment:null), FieldSchema(name:_col14, type:string, comment:null), FieldSchema(name:_col15, type:string, comment:null), FieldSchema(name:_col16, type:decimal(21,2), comment:null), FieldSchema(name:_col17, type:int, comment:null), FieldSchema(name:_col18, type:int, comment:null), FieldSchema(name:_col19, type:bigint, comment:null), FieldSchema(name:_col20, type:varchar(64), comment:null), FieldSchema(name:_col21, type:int, comment:null), FieldSchema(name:_col22, type:int, comment:null), FieldSchema(name:_col23, type:int, comment:null), FieldSchema(name:_col24, type:timestamp, comment:null), FieldSchema(name:_col25, type:timestamp, comment:null), FieldSchema(name:_col26, type:bigint, comment:null), FieldSchema(name:_col27, type:varchar(32), comment:null), FieldSchema(name:_col28, type:string, comment:null), FieldSchema(name:_col29, type:string, comment:null), FieldSchema(name:_col30, type:string, comment:null), FieldSchema(name:_col31, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20180327190202_e7f5fac4-eb74-42e7-92fa-6158c6aa9a40); Time taken: 0.204 seconds
INFO  : Executing command(queryId=hive_20180327190202_e7f5fac4-eb74-42e7-92fa-6158c6aa9a40): insert into table prd_ykdl_adhoc_db.shelfon_collected_data_processed PARTITION (ingestion_date , active_flag)
select
r.shelfon_data_seq
, r.id
, r.npid
, r.ngid
, r.npgid
, r.site
, r.site_pid
, r.wave
, r.sale_type
, r.url
, r.img
, r.title
, r.collected_madeby
, r.collected_brand
, r.tr_madeby
, r.tr_brand
, r.sale_price
, r.rolling_position
, r.seller_size
, r.comment_size
, r.section_name
, r.section_position
, r.total_position
, r.page
, r.rtime
, r.rdate
, r.sku_cd
, r.hashcode ,
"HISTORY",
"N",
r.ingestion_date,
"Y"
from prd_ykdl_adhoc_db.shelfon_collected_data_raw r
INFO  : Query ID = hive_20180327190202_e7f5fac4-eb74-42e7-92fa-6158c6aa9a40
INFO  : Total jobs = 3
INFO  : Launching Job 1 out of 3
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Number of reduce tasks is set to 0 since there's no reduce operator
INFO  : number of splits:10
INFO  : Submitting tokens for job: job_1521666602777_0953
INFO  : Kind: kms-dt, Service: 165.28.92.219:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177369900, maxDate=1522782169900, sequenceNumber=40347, masterKeyId=862)
INFO  : Kind: kms-dt, Service: 165.28.92.220:16000, Ident: (kms-dt owner=hive, renewer=yarn, realUser=, issueDate=1522177369949, maxDate=1522782169949, sequenceNumber=40348, masterKeyId=863)
INFO  : Kind: HDFS_DELEGATION_TOKEN, Service: ha-hdfs:nameservice1, Ident: (token for hive: HDFS_DELEGATION_TOKEN owner=hive/ustcl705.kcc.com@KCC.COM, renewer=yarn, realUser=, issueDate=1522177369875, maxDate=1522782169875, sequenceNumber=27545, masterKeyId=478)
INFO  : The url to track the job: https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0953/
INFO  : Starting Job = job_1521666602777_0953, Tracking URL = https://ustcl703.kcc.com:8090/proxy/application_1521666602777_0953/
INFO  : Kill Command = /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/lib/hadoop/bin/hadoop job  -kill job_1521666602777_0953
INFO  : Hadoop job information for Stage-1: number of mappers: 10; number of reducers: 0
INFO  : 2018-03-27 19:02:59,023 Stage-1 map = 0%,  reduce = 0%
INFO  : 2018-03-27 19:03:59,249 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 776.55 sec
INFO  : 2018-03-27 19:04:59,253 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 1534.24 sec
INFO  : 2018-03-27 19:06:00,177 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 2288.15 sec
INFO  : 2018-03-27 19:07:01,102 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 3039.82 sec
INFO  : 2018-03-27 19:08:02,030 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 3793.2 sec
INFO  : 2018-03-27 19:09:03,001 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 4547.42 sec
INFO  : 2018-03-27 19:10:03,872 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 5294.62 sec
INFO  : 2018-03-27 19:11:04,729 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 6038.44 sec
INFO  : 2018-03-27 19:12:05,649 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 6786.18 sec
INFO  : 2018-03-27 19:13:06,459 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 7536.47 sec
INFO  : 2018-03-27 19:14:07,339 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 8281.75 sec
INFO  : 2018-03-27 19:15:08,187 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 9030.04 sec
INFO  : 2018-03-27 19:16:09,121 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 9772.68 sec
INFO  : 2018-03-27 19:17:10,042 Stage-1 map = 0%,  reduce = 0%, Cumulative CPU 10522.32 sec
INFO  : 2018-03-27 19:17:49,307 Stage-1 map = 10%,  reduce = 0%, Cumulative CPU 10975.44 sec
INFO  : 2018-03-27 19:18:20,318 Stage-1 map = 20%,  reduce = 0%, Cumulative CPU 11319.94 sec
INFO  : 2018-03-27 19:18:48,203 Stage-1 map = 30%,  reduce = 0%, Cumulative CPU 11621.66 sec
INFO  : 2018-03-27 19:18:52,331 Stage-1 map = 40%,  reduce = 0%, Cumulative CPU 11667.06 sec
INFO  : 2018-03-27 19:18:59,570 Stage-1 map = 50%,  reduce = 0%, Cumulative CPU 11720.56 sec
INFO  : 2018-03-27 19:19:02,668 Stage-1 map = 60%,  reduce = 0%, Cumulative CPU 11725.65 sec
INFO  : 2018-03-27 19:19:12,996 Stage-1 map = 70%,  reduce = 0%, Cumulative CPU 11790.69 sec
INFO  : 2018-03-27 19:19:19,199 Stage-1 map = 80%,  reduce = 0%, Cumulative CPU 11818.48 sec
INFO  : 2018-03-27 19:19:25,402 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 11839.29 sec
INFO  : MapReduce Total cumulative CPU time: 0 days 3 hours 17 minutes 19 seconds 290 msec
INFO  : Ended Job = job_1521666602777_0953
INFO  : Starting task [Stage-7:CONDITIONAL] in serial mode
INFO  : Stage-4 is selected by condition resolver.
INFO  : Stage-3 is filtered out by condition resolver.
INFO  : Stage-5 is filtered out by condition resolver.
INFO  : Starting task [Stage-4:MOVE] in serial mode
INFO  : Moving data to: hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_data_processed/.hive-staging_hive_2018-03-27_19-02-49_514_8273764235754216605-576/-ext-10000 from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_data_processed/.hive-staging_hive_2018-03-27_19-02-49_514_8273764235754216605-576/-ext-10002
INFO  : Starting task [Stage-0:MOVE] in serial mode
INFO  : Loading data to table prd_ykdl_adhoc_db.shelfon_collected_data_processed partition (ingestion_date=null, active_flag=null) from hdfs://nameservice1/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_collected_data_processed/.hive-staging_hive_2018-03-27_19-02-49_514_8273764235754216605-576/-ext-10000
INFO  : 	 Time taken for load dynamic partitions : 138
INFO  : 	Loading partition {ingestion_date=19990101, active_flag=Y}
INFO  : 	 Time taken for adding to write entity : 0
INFO  : Starting task [Stage-2:STATS] in serial mode
INFO  : Partition prd_ykdl_adhoc_db.shelfon_collected_data_processed{ingestion_date=19990101, active_flag=Y} stats: [numFiles=10, numRows=234577809, totalSize=116239545850, rawDataSize=7037334270]
INFO  : MapReduce Jobs Launched: 
INFO  : Stage-Stage-1: Map: 10   Cumulative CPU: 11839.29 sec   HDFS Read: 65764637024 HDFS Write: 116239547440 SUCCESS
INFO  : Total MapReduce CPU Time Spent: 0 days 3 hours 17 minutes 19 seconds 290 msec
INFO  : Completed executing command(queryId=hive_20180327190202_e7f5fac4-eb74-42e7-92fa-6158c6aa9a40); Time taken: 997.273 seconds
INFO  : OK
No rows affected (997.501 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> MSCK REPAIR TABLE ${hivedb}.shelfon_collected_data_processed;
INFO  : Compiling command(queryId=hive_20180327191919_2d2ab0e7-f124-4bab-a1b4-9feb7a06bfc1): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_collected_data_processed
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180327191919_2d2ab0e7-f124-4bab-a1b4-9feb7a06bfc1); Time taken: 0.155 seconds
INFO  : Executing command(queryId=hive_20180327191919_2d2ab0e7-f124-4bab-a1b4-9feb7a06bfc1): MSCK REPAIR TABLE prd_ykdl_adhoc_db.shelfon_collected_data_processed
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180327191919_2d2ab0e7-f124-4bab-a1b4-9feb7a06bfc1); Time taken: 0.055 seconds
INFO  : OK
No rows affected (0.214 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> ---
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Processed table data load done successfully for table shelfon_collected_data.
Moving raw data to archive location for table shelfon_collected_data.
shelfon_collected_data tables created successfully and processed the data
Successfully loaded data into processed tables
Creating all derived tables.
Initiating authentication
Executing HQLs
*********************************
---------------------------------
Executing HQLs to Create all the derived tables
---------------------------------
*********************************
---------------------------------
Initializing tb_category_brand_report.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> create external table ${hivevar:hivedb}.tb_category_brand_report
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> target_date    date,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> site STRING,
. . . . . . . . . . . . . . . . . . . . . . .> brand STRING,
. . . . . . . . . . . . . . . . . . . . . . .> its_weight_point    float,
. . . . . . . . . . . . . . . . . . . . . . .> top7_weight_point    float,
. . . . . . . . . . . . . . . . . . . . . . .> actual    decimal(11,2),
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_category_brand_report.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_category_brand_report_new.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> create external table ${hivevar:hivedb}.tb_category_brand_report_new
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> target_date    date,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> site    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> title    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> brand    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> its_row_count    int,
. . . . . . . . . . . . . . . . . . . . . . .> top7_row_count    int,
. . . . . . . . . . . . . . . . . . . . . . .> actual    DECIMAL(11,2),
. . . . . . . . . . . . . . . . . . . . . . .> reg_date    TIMESTAMP
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_category_brand_report_new.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_category_mnft_report.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> create external table ${hivevar:hivedb}.tb_category_mnft_report
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> target_date    date,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> site    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> manufacturer    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> its_weight_point    float,
. . . . . . . . . . . . . . . . . . . . . . .> top5_weight_point    float,
. . . . . . . . . . . . . . . . . . . . . . .> actual    decimal(11,2),
. . . . . . . . . . . . . . . . . . . . . . .> reg_date    timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_category_mnft_report.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_category_mnft_report_new.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> create external table ${hivevar:hivedb}.tb_category_mnft_report_new
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> target_date    date,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> site    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> title    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> manufacturer    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> its_row_count    int,
. . . . . . . . . . . . . . . . . . . . . . .> top5_row_count    int,
. . . . . . . . . . . . . . . . . . . . . . .> actual    DECIMAL(11,2),
. . . . . . . . . . . . . . . . . . . . . . .> reg_date    timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_category_mnft_report_new.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_korean_comparison.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> create external table ${hivevar:hivedb}.korean_comparison
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> c1 string,
. . . . . . . . . . . . . . . . . . . . . . .> c2 string,
. . . . . . . . . . . . . . . . . . . . . . .> c3 string,
. . . . . . . . . . . . . . . . . . . . . . .> c4 string,
. . . . . . . . . . . . . . . . . . . . . . .> c5 string,
. . . . . . . . . . . . . . . . . . . . . . .> c6 string,
. . . . . . . . . . . . . . . . . . . . . . .> decided_skucd bigint
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_korean_comparison.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_online_dpsm_d_report.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE ${hivevar:hivedb}.tb_online_dpsm_d_report
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> year    int,
. . . . . . . . . . . . . . . . . . . . . . .> month    int,
. . . . . . . . . . . . . . . . . . . . . . .> classification    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> biz_category    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> vlt    varchar(20),
. . . . . . . . . . . . . . . . . . . . . . .> product_category_cd    varchar(5),
. . . . . . . . . . . . . . . . . . . . . . .> brand_cd    varchar(5),
. . . . . . . . . . . . . . . . . . . . . . .> sub_brand_cd    varchar(5),
. . . . . . . . . . . . . . . . . . . . . . .> product_name    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd    bigint,
. . . . . . . . . . . . . . . . . . . . . . .> site    varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> actual    int,
. . . . . . . . . . . . . . . . . . . . . . .> target    decimal(11,2),
. . . . . . . . . . . . . . . . . . . . . . .> reg_date    timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_online_dpsm_d_report.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_online_dpsm_m_report_new.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE ${hivevar:hivedb}.tb_online_dpsm_m_report_new
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> year    int,
. . . . . . . . . . . . . . . . . . . . . . .> month    int,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> site    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> its_weight_point    float,
. . . . . . . . . . . . . . . . . . . . . . .> top5_weight_point    float,
. . . . . . . . . . . . . . . . . . . . . . .> actual decimal(9,2),
. . . . . . . . . . . . . . . . . . . . . . .> target    decimal(9,2),
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_online_dpsm_m_report_new.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_online_dpsm_p_report.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE ${hivevar:hivedb}.tb_online_dpsm_p_report
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> year    int,
. . . . . . . . . . . . . . . . . . . . . . .> month    int,
. . . . . . . . . . . . . . . . . . . . . . .> biz_category    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> vlt    varchar(20),
. . . . . . . . . . . . . . . . . . . . . . .> product_category_cd    varchar(5),
. . . . . . . . . . . . . . . . . . . . . . .> brand_cd    varchar(5),
. . . . . . . . . . . . . . . . . . . . . . .> sub_brand_cd    varchar(5),
. . . . . . . . . . . . . . . . . . . . . . .> product_name    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd    bigint,
. . . . . . . . . . . . . . . . . . . . . . .> entry_site    varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> market    varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> avg_piece_sale_price float,
. . . . . . . . . . . . . . . . . . . . . . .> its_row_count    int,
. . . . . . . . . . . . . . . . . . . . . . .> competitor_product_name    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> avg_competitor_piece_sale_price    float,
. . . . . . . . . . . . . . . . . . . . . . .> competitor_row_count    int,
. . . . . . . . . . . . . . . . . . . . . . .> actual    decimal(11,2),
. . . . . . . . . . . . . . . . . . . . . . .> target    decimal(11,2),
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> second_product_name STRING
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_online_dpsm_p_report.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_online_dpsm_s_report_new.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE ${hivevar:hivedb}.tb_online_dpsm_s_report_new
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> year    int,
. . . . . . . . . . . . . . . . . . . . . . .> month    int,
. . . . . . . . . . . . . . . . . . . . . . .> depth_fullname    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> site    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> item_title    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> its_row_count    int,
. . . . . . . . . . . . . . . . . . . . . . .> top5_row_count    int,
. . . . . . . . . . . . . . . . . . . . . . .> actual decimal(9,2),
. . . . . . . . . . . . . . . . . . . . . . .> target    decimal(9,2),
. . . . . . . . . . . . . . . . . . . . . . .> reg_date timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_online_dpsm_s_report_new.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_penetration_report.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> create external table ${hivevar:hivedb}.tb_penetration_report
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> year    int,
. . . . . . . . . . . . . . . . . . . . . . .> month    int,
. . . . . . . . . . . . . . . . . . . . . . .> classification    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> classification2    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> biz_category    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> vlt    varchar(20),
. . . . . . . . . . . . . . . . . . . . . . .> product_category_cd    varchar(5),
. . . . . . . . . . . . . . . . . . . . . . .> brand_cd    varchar(5),
. . . . . . . . . . . . . . . . . . . . . . .> sub_brand_cd    varchar(5),
. . . . . . . . . . . . . . . . . . . . . . .> product_name    STRING,
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd    bigint,
. . . . . . . . . . . . . . . . . . . . . . .> site    varchar(32),
. . . . . . . . . . . . . . . . . . . . . . .> actual    int,
. . . . . . . . . . . . . . . . . . . . . . .> target    decimal(11,2),
. . . . . . . . . . . . . . . . . . . . . . .> reg_date    timestamp
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_penetration_report.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_shelfon_sku_cd_batch.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> create external table ${hivevar:hivedb}.tb_shelfon_sku_cd_batch
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> SEQ_NO    bigint,
. . . . . . . . . . . . . . . . . . . . . . .> BEGIN_SHELFON_DATA_SEQ    bigint,
. . . . . . . . . . . . . . . . . . . . . . .> LAST_SHELFON_DATA_SEQ    bigint,
. . . . . . . . . . . . . . . . . . . . . . .> BATCH_BEGIN_DT    timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> BATCH_END_DT    timestamp,
. . . . . . . . . . . . . . . . . . . . . . .> UPDATE_CNT    bigint
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_shelfon_sku_cd_batch.hql table CREATED
---------------------------------
---------------------------------
Initializing tb_shelfon_skucd_mapping.hql table creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> USE ${hivevar:hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE ${hivevar:hivedb}.tb_shelfon_skucd_mapping
. . . . . . . . . . . . . . . . . . . . . . .> (
. . . . . . . . . . . . . . . . . . . . . . .> shelfon_data_seq    bigint,
. . . . . . . . . . . . . . . . . . . . . . .> sku_cd    bigint,
. . . . . . . . . . . . . . . . . . . . . . .> insert_dt    timestamp
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY '\001'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION '${hivevar:location}';
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
tb_shelfon_skucd_mapping.hql table CREATED
---------------------------------
Successfully created the derived tables
Creating all derived tables tables.
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1mBuilding recursive_cte 0.0.1-SNAPSHOT[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-compiler-plugin/3.1/maven-compiler-plugin-3.1.pom
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;31mBUILD FAILURE[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time: 01:03 min
[[1;34mINFO[m] Finished at: 2018-03-27T19:21:37Z
[[1;34mINFO[m] Final Memory: 18M/491M
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;31mERROR[m] Plugin org.apache.maven.plugins:maven-compiler-plugin:3.1 or one of its dependencies could not be resolved: Failed to read artifact descriptor for org.apache.maven.plugins:maven-compiler-plugin:jar:3.1: Could not transfer artifact org.apache.maven.plugins:maven-compiler-plugin:pom:3.1 from/to central (https://repo.maven.apache.org/maven2): Connect to repo.maven.apache.org:443 [repo.maven.apache.org/151.101.184.215] failed: Connection timed out -> [1m[Help 1][m
[[1;31mERROR[m] 
[[1;31mERROR[m] To see the full stack trace of the errors, re-run Maven with the [1m-e[m switch.
[[1;31mERROR[m] Re-run Maven using the [1m-X[m switch to enable full debug logging.
[[1;31mERROR[m] 
[[1;31mERROR[m] For more information about the errors and possible solutions, please read the following articles:
[[1;31mERROR[m] [1m[Help 1][m http://cwiki.apache.org/confluence/display/MAVEN/PluginResolutionException
Initiating authentication
Creating all derived tables tables.
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1mBuilding recursive_cte 0.0.1-SNAPSHOT[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-resources-plugin:2.6:resources[m [1m(default-resources)[m @ [36mrecursive_cte[0;1m ---[m
[[1;33mWARNING[m] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[[1;34mINFO[m] skip non existing resourceDirectory /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/priceon_view/src/main/resources
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:compile[m [1m(default-compile)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Nothing to compile - all classes are up to date
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:compile[m [1m(default)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Nothing to compile - all classes are up to date
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-resources-plugin:2.6:testResources[m [1m(default-testResources)[m @ [36mrecursive_cte[0;1m ---[m
[[1;33mWARNING[m] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[[1;34mINFO[m] skip non existing resourceDirectory /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/priceon_view/src/test/resources
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:testCompile[m [1m(default-testCompile)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] No sources to compile
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:testCompile[m [1m(default)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] No sources to compile
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-surefire-plugin:2.12.4:test[m [1m(default-test)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] No tests to run.
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-jar-plugin:2.4:jar[m [1m(default-jar)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-shade-plugin:2.3:shade[m [1m(default)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-common:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-annotations:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.guava:guava:jar:11.0.2 in the shaded jar.
[[1;34mINFO[m] Including commons-cli:commons-cli:jar:1.2 in the shaded jar.
[[1;34mINFO[m] Including org.apache.commons:commons-math3:jar:3.1.1 in the shaded jar.
[[1;34mINFO[m] Including xmlenc:xmlenc:jar:0.52 in the shaded jar.
[[1;34mINFO[m] Including commons-httpclient:commons-httpclient:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including commons-codec:commons-codec:jar:1.4 in the shaded jar.
[[1;34mINFO[m] Including commons-io:commons-io:jar:2.4 in the shaded jar.
[[1;34mINFO[m] Including commons-net:commons-net:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including commons-collections:commons-collections:jar:3.2.2 in the shaded jar.
[[1;34mINFO[m] Including javax.servlet:servlet-api:jar:2.5 in the shaded jar.
[[1;34mINFO[m] Including org.mortbay.jetty:jetty:jar:6.1.26.cloudera.4 in the shaded jar.
[[1;34mINFO[m] Including org.mortbay.jetty:jetty-util:jar:6.1.26.cloudera.4 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-core:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-json:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jettison:jettison:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including com.sun.xml.bind:jaxb-impl:jar:2.2.3-1 in the shaded jar.
[[1;34mINFO[m] Including javax.xml.bind:jaxb-api:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including javax.xml.stream:stax-api:jar:1.0-2 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-jaxrs:jar:1.8.3 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-xc:jar:1.8.3 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-server:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including asm:asm:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including tomcat:jasper-compiler:jar:5.5.23 in the shaded jar.
[[1;34mINFO[m] Including tomcat:jasper-runtime:jar:5.5.23 in the shaded jar.
[[1;34mINFO[m] Including javax.servlet.jsp:jsp-api:jar:2.1 in the shaded jar.
[[1;34mINFO[m] Including commons-el:commons-el:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including commons-logging:commons-logging:jar:1.1.3 in the shaded jar.
[[1;34mINFO[m] Including log4j:log4j:jar:1.2.17 in the shaded jar.
[[1;34mINFO[m] Including net.java.dev.jets3t:jets3t:jar:0.9.0 in the shaded jar.
[[1;34mINFO[m] Including com.jamesmurty.utils:java-xmlbuilder:jar:0.4 in the shaded jar.
[[1;34mINFO[m] Including commons-lang:commons-lang:jar:2.6 in the shaded jar.
[[1;34mINFO[m] Including commons-configuration:commons-configuration:jar:1.6 in the shaded jar.
[[1;34mINFO[m] Including commons-digester:commons-digester:jar:1.8 in the shaded jar.
[[1;34mINFO[m] Including commons-beanutils:commons-beanutils:jar:1.7.0 in the shaded jar.
[[1;34mINFO[m] Including commons-beanutils:commons-beanutils-core:jar:1.8.0 in the shaded jar.
[[1;34mINFO[m] Including org.slf4j:slf4j-api:jar:1.7.5 in the shaded jar.
[[1;34mINFO[m] Including org.slf4j:slf4j-log4j12:jar:1.7.5 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-core-asl:jar:1.8.8 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-mapper-asl:jar:1.8.8 in the shaded jar.
[[1;34mINFO[m] Including org.apache.avro:avro:jar:1.7.6-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.thoughtworks.paranamer:paranamer:jar:2.3 in the shaded jar.
[[1;34mINFO[m] Including org.xerial.snappy:snappy-java:jar:1.0.4.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.protobuf:protobuf-java:jar:2.5.0 in the shaded jar.
[[1;34mINFO[m] Including com.google.code.gson:gson:jar:2.2.4 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-auth:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.server:apacheds-kerberos-codec:jar:2.0.0-M15 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.server:apacheds-i18n:jar:2.0.0-M15 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.api:api-asn1-api:jar:1.0.0-M20 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.api:api-util:jar:1.0.0-M20 in the shaded jar.
[[1;34mINFO[m] Including com.jcraft:jsch:jar:0.1.42 in the shaded jar.
[[1;34mINFO[m] Including org.apache.curator:curator-client:jar:2.7.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.curator:curator-recipes:jar:2.7.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.code.findbugs:jsr305:jar:3.0.0 in the shaded jar.
[[1;34mINFO[m] Including org.apache.htrace:htrace-core4:jar:4.0.1-incubating in the shaded jar.
[[1;34mINFO[m] Including org.apache.zookeeper:zookeeper:jar:3.4.5-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.commons:commons-compress:jar:1.4.1 in the shaded jar.
[[1;34mINFO[m] Including org.tukaani:xz:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-jdbc:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-common:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.commons:commons-lang3:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including org.eclipse.jetty.aggregate:jetty-all:jar:7.6.0.v20120127 in the shaded jar.
[[1;34mINFO[m] Including org.apache.geronimo.specs:geronimo-jta_1.1_spec:jar:1.1.1 in the shaded jar.
[[1;34mINFO[m] Including javax.mail:mail:jar:1.4.1 in the shaded jar.
[[1;34mINFO[m] Including javax.activation:activation:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.geronimo.specs:geronimo-jaspic_1.0_spec:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including org.apache.geronimo.specs:geronimo-annotation_1.0_spec:jar:1.1.1 in the shaded jar.
[[1;34mINFO[m] Including asm:asm-commons:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including asm:asm-tree:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including joda-time:joda-time:jar:2.8.1 in the shaded jar.
[[1;34mINFO[m] Including log4j:apache-log4j-extras:jar:1.2.17 in the shaded jar.
[[1;34mINFO[m] Including org.apache.ant:ant:jar:1.9.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.ant:ant-launcher:jar:1.9.1 in the shaded jar.
[[1;34mINFO[m] Including com.codahale.metrics:metrics-core:jar:3.0.2 in the shaded jar.
[[1;34mINFO[m] Including com.codahale.metrics:metrics-jvm:jar:3.0.2 in the shaded jar.
[[1;34mINFO[m] Including com.codahale.metrics:metrics-json:jar:3.0.2 in the shaded jar.
[[1;34mINFO[m] Including com.fasterxml.jackson.core:jackson-databind:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including com.fasterxml.jackson.core:jackson-annotations:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including com.fasterxml.jackson.core:jackson-core:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-service:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including net.sf.jpam:jpam:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.thrift:libfb303:jar:0.9.3 in the shaded jar.
[[1;34mINFO[m] Including org.jamon:jamon-runtime:jar:2.3.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-serde:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including net.sf.opencsv:opencsv:jar:2.3 in the shaded jar.
[[1;34mINFO[m] Including com.twitter:parquet-hadoop-bundle:jar:1.5.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-servlet:jar:1.14 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-metastore:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.jolbox:bonecp:jar:0.8.0.RELEASE in the shaded jar.
[[1;34mINFO[m] Including org.apache.derby:derby:jar:10.11.1.1 in the shaded jar.
[[1;34mINFO[m] Including org.datanucleus:datanucleus-api-jdo:jar:3.2.6 in the shaded jar.
[[1;34mINFO[m] Including org.datanucleus:datanucleus-core:jar:3.2.10 in the shaded jar.
[[1;34mINFO[m] Including org.datanucleus:datanucleus-rdbms:jar:3.2.9 in the shaded jar.
[[1;34mINFO[m] Including commons-pool:commons-pool:jar:1.5.4 in the shaded jar.
[[1;34mINFO[m] Including commons-dbcp:commons-dbcp:jar:1.4 in the shaded jar.
[[1;34mINFO[m] Including javax.jdo:jdo-api:jar:3.0.1 in the shaded jar.
[[1;34mINFO[m] Including javax.transaction:jta:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including org.antlr:antlr-runtime:jar:3.4 in the shaded jar.
[[1;34mINFO[m] Including org.antlr:stringtemplate:jar:3.2.1 in the shaded jar.
[[1;34mINFO[m] Including antlr:antlr:jar:2.7.7 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-shims:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive.shims:hive-shims-common:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive.shims:hive-shims-0.23:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-resourcemanager:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.inject.extensions:guice-servlet:jar:3.0 in the shaded jar.
[[1;34mINFO[m] Including com.google.inject:guice:jar:3.0 in the shaded jar.
[[1;34mINFO[m] Including javax.inject:javax.inject:jar:1 in the shaded jar.
[[1;34mINFO[m] Including aopalliance:aopalliance:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey.contribs:jersey-guice:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-common:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-api:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-client:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-common:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.fusesource.leveldbjni:leveldbjni-all:jar:1.8 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-applicationhistoryservice:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-web-proxy:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive.shims:hive-shims-scheduler:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.mockito:mockito-all:jar:1.9.5 in the shaded jar.
[[1;34mINFO[m] Including org.apache.httpcomponents:httpclient:jar:4.2.5 in the shaded jar.
[[1;34mINFO[m] Including org.apache.httpcomponents:httpcore:jar:4.2.5 in the shaded jar.
[[1;34mINFO[m] Including org.apache.thrift:libthrift:jar:0.9.3 in the shaded jar.
[[1;34mINFO[m] Including org.apache.curator:curator-framework:jar:2.6.0 in the shaded jar.
[[1;33mWARNING[m] jasper-compiler-5.5.23.jar, jasper-runtime-5.5.23.jar define 1 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.jasper.compiler.Localizer
[[1;33mWARNING[m] apache-log4j-extras-1.2.17.jar, log4j-1.2.17.jar define 126 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.log4j.pattern.MessagePatternConverter
[[1;33mWARNING[m]   - org.apache.log4j.xml.DOMConfigurator$4
[[1;33mWARNING[m]   - org.apache.log4j.varia.StringMatchFilter
[[1;33mWARNING[m]   - org.apache.log4j.spi.OptionHandler
[[1;33mWARNING[m]   - org.apache.log4j.pattern.NameAbbreviator$DropElementAbbreviator
[[1;33mWARNING[m]   - org.apache.log4j.pattern.LevelPatternConverter
[[1;33mWARNING[m]   - org.apache.log4j.pattern.BridgePatternParser
[[1;33mWARNING[m]   - org.apache.log4j.BasicConfigurator
[[1;33mWARNING[m]   - org.apache.log4j.pattern.LoggingEventPatternConverter
[[1;33mWARNING[m]   - org.apache.log4j.ConsoleAppender$SystemErrStream
[[1;33mWARNING[m]   - 116 more...
[[1;33mWARNING[m] geronimo-jta_1.1_spec-1.1.1.jar, jta-1.1.jar define 18 overlappping classes: 
[[1;33mWARNING[m]   - javax.transaction.UserTransaction
[[1;33mWARNING[m]   - javax.transaction.Status
[[1;33mWARNING[m]   - javax.transaction.TransactionRequiredException
[[1;33mWARNING[m]   - javax.transaction.xa.XAResource
[[1;33mWARNING[m]   - javax.transaction.Transaction
[[1;33mWARNING[m]   - javax.transaction.InvalidTransactionException
[[1;33mWARNING[m]   - javax.transaction.SystemException
[[1;33mWARNING[m]   - javax.transaction.HeuristicCommitException
[[1;33mWARNING[m]   - javax.transaction.NotSupportedException
[[1;33mWARNING[m]   - javax.transaction.TransactionManager
[[1;33mWARNING[m]   - 8 more...
[[1;33mWARNING[m] commons-beanutils-1.7.0.jar, commons-collections-3.2.2.jar, commons-beanutils-core-1.8.0.jar define 10 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$EntrySet
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$KeySet
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$CollectionView$CollectionViewIterator
[[1;33mWARNING[m]   - org.apache.commons.collections.ArrayStack
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$Values
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$CollectionView
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$1
[[1;33mWARNING[m]   - org.apache.commons.collections.Buffer
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap
[[1;33mWARNING[m]   - org.apache.commons.collections.BufferUnderflowException
[[1;33mWARNING[m] commons-beanutils-1.7.0.jar, commons-beanutils-core-1.8.0.jar define 82 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.commons.beanutils.ConvertUtilsBean
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.SqlTimeConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.Converter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.FloatArrayConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.NestedNullException
[[1;33mWARNING[m]   - org.apache.commons.beanutils.ConvertingWrapDynaBean
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.LongArrayConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.SqlDateConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.BooleanArrayConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.StringConverter
[[1;33mWARNING[m]   - 72 more...
[[1;33mWARNING[m] hadoop-yarn-api-2.6.0-cdh5.13.1.jar, hadoop-yarn-common-2.6.0-cdh5.13.1.jar define 3 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.hadoop.yarn.util.package-info
[[1;33mWARNING[m]   - org.apache.hadoop.yarn.factories.package-info
[[1;33mWARNING[m]   - org.apache.hadoop.yarn.factory.providers.package-info
[[1;33mWARNING[m] jersey-servlet-1.14.jar, jersey-server-1.9.jar define 73 overlappping classes: 
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.container.servlet.Wrapper
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.container.servlet.JerseyServletContainerInitializer
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.ejb.EJBInjectionInterceptor
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.AnnotatedMemberImpl
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.AnnotatedTypeImpl
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.container.servlet.JSPTemplateProcessor
[[1;33mWARNING[m]   - com.sun.jersey.spi.container.servlet.WebComponent$2
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.AnnotatedConstructorImpl
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.CDIExtension$ParameterBean
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.CDIExtension
[[1;33mWARNING[m]   - 63 more...
[[1;33mWARNING[m] maven-shade-plugin has detected that some .class files
[[1;33mWARNING[m] are present in two or more JARs. When this happens, only
[[1;33mWARNING[m] one single version of the class is copied in the uberjar.
[[1;33mWARNING[m] Usually this is not harmful and you can skeep these
[[1;33mWARNING[m] warnings, otherwise try to manually exclude artifacts
[[1;33mWARNING[m] based on mvn dependency:tree -Ddetail=true and the above
[[1;33mWARNING[m] output
[[1;33mWARNING[m] See http://docs.codehaus.org/display/MAVENUSER/Shade+Plugin
[[1;34mINFO[m] Replacing /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/priceon_view/target/generate-bom-data.jar with /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/priceon_view/target/recursive_cte-0.0.1-SNAPSHOT-shaded.jar
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-assembly-plugin:2.4.1:single[m [1m(make-assembly)[m @ [36mrecursive_cte[0;1m ---[m
Initiating authentication
Creating all derived tables tables.
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1mBuilding recursive_cte 0.0.1-SNAPSHOT[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-resources-plugin:2.6:resources[m [1m(default-resources)[m @ [36mrecursive_cte[0;1m ---[m
[[1;33mWARNING[m] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[[1;34mINFO[m] skip non existing resourceDirectory /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/priceon_view/src/main/resources
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:compile[m [1m(default-compile)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Nothing to compile - all classes are up to date
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:compile[m [1m(default)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Nothing to compile - all classes are up to date
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-resources-plugin:2.6:testResources[m [1m(default-testResources)[m @ [36mrecursive_cte[0;1m ---[m
[[1;33mWARNING[m] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[[1;34mINFO[m] skip non existing resourceDirectory /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/priceon_view/src/test/resources
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:testCompile[m [1m(default-testCompile)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] No sources to compile
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:testCompile[m [1m(default)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] No sources to compile
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-surefire-plugin:2.12.4:test[m [1m(default-test)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] No tests to run.
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-jar-plugin:2.4:jar[m [1m(default-jar)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-shade-plugin:2.3:shade[m [1m(default)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-common:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-annotations:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.guava:guava:jar:11.0.2 in the shaded jar.
[[1;34mINFO[m] Including commons-cli:commons-cli:jar:1.2 in the shaded jar.
[[1;34mINFO[m] Including org.apache.commons:commons-math3:jar:3.1.1 in the shaded jar.
[[1;34mINFO[m] Including xmlenc:xmlenc:jar:0.52 in the shaded jar.
[[1;34mINFO[m] Including commons-httpclient:commons-httpclient:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including commons-codec:commons-codec:jar:1.4 in the shaded jar.
[[1;34mINFO[m] Including commons-io:commons-io:jar:2.4 in the shaded jar.
[[1;34mINFO[m] Including commons-net:commons-net:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including commons-collections:commons-collections:jar:3.2.2 in the shaded jar.
[[1;34mINFO[m] Including javax.servlet:servlet-api:jar:2.5 in the shaded jar.
[[1;34mINFO[m] Including org.mortbay.jetty:jetty:jar:6.1.26.cloudera.4 in the shaded jar.
[[1;34mINFO[m] Including org.mortbay.jetty:jetty-util:jar:6.1.26.cloudera.4 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-core:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-json:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jettison:jettison:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including com.sun.xml.bind:jaxb-impl:jar:2.2.3-1 in the shaded jar.
[[1;34mINFO[m] Including javax.xml.bind:jaxb-api:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including javax.xml.stream:stax-api:jar:1.0-2 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-jaxrs:jar:1.8.3 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-xc:jar:1.8.3 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-server:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including asm:asm:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including tomcat:jasper-compiler:jar:5.5.23 in the shaded jar.
[[1;34mINFO[m] Including tomcat:jasper-runtime:jar:5.5.23 in the shaded jar.
[[1;34mINFO[m] Including javax.servlet.jsp:jsp-api:jar:2.1 in the shaded jar.
[[1;34mINFO[m] Including commons-el:commons-el:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including commons-logging:commons-logging:jar:1.1.3 in the shaded jar.
[[1;34mINFO[m] Including log4j:log4j:jar:1.2.17 in the shaded jar.
[[1;34mINFO[m] Including net.java.dev.jets3t:jets3t:jar:0.9.0 in the shaded jar.
[[1;34mINFO[m] Including com.jamesmurty.utils:java-xmlbuilder:jar:0.4 in the shaded jar.
[[1;34mINFO[m] Including commons-lang:commons-lang:jar:2.6 in the shaded jar.
[[1;34mINFO[m] Including commons-configuration:commons-configuration:jar:1.6 in the shaded jar.
[[1;34mINFO[m] Including commons-digester:commons-digester:jar:1.8 in the shaded jar.
[[1;34mINFO[m] Including commons-beanutils:commons-beanutils:jar:1.7.0 in the shaded jar.
[[1;34mINFO[m] Including commons-beanutils:commons-beanutils-core:jar:1.8.0 in the shaded jar.
[[1;34mINFO[m] Including org.slf4j:slf4j-api:jar:1.7.5 in the shaded jar.
[[1;34mINFO[m] Including org.slf4j:slf4j-log4j12:jar:1.7.5 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-core-asl:jar:1.8.8 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-mapper-asl:jar:1.8.8 in the shaded jar.
[[1;34mINFO[m] Including org.apache.avro:avro:jar:1.7.6-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.thoughtworks.paranamer:paranamer:jar:2.3 in the shaded jar.
[[1;34mINFO[m] Including org.xerial.snappy:snappy-java:jar:1.0.4.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.protobuf:protobuf-java:jar:2.5.0 in the shaded jar.
[[1;34mINFO[m] Including com.google.code.gson:gson:jar:2.2.4 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-auth:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.server:apacheds-kerberos-codec:jar:2.0.0-M15 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.server:apacheds-i18n:jar:2.0.0-M15 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.api:api-asn1-api:jar:1.0.0-M20 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.api:api-util:jar:1.0.0-M20 in the shaded jar.
[[1;34mINFO[m] Including com.jcraft:jsch:jar:0.1.42 in the shaded jar.
[[1;34mINFO[m] Including org.apache.curator:curator-client:jar:2.7.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.curator:curator-recipes:jar:2.7.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.code.findbugs:jsr305:jar:3.0.0 in the shaded jar.
[[1;34mINFO[m] Including org.apache.htrace:htrace-core4:jar:4.0.1-incubating in the shaded jar.
[[1;34mINFO[m] Including org.apache.zookeeper:zookeeper:jar:3.4.5-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.commons:commons-compress:jar:1.4.1 in the shaded jar.
[[1;34mINFO[m] Including org.tukaani:xz:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-jdbc:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-common:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.commons:commons-lang3:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including org.eclipse.jetty.aggregate:jetty-all:jar:7.6.0.v20120127 in the shaded jar.
[[1;34mINFO[m] Including org.apache.geronimo.specs:geronimo-jta_1.1_spec:jar:1.1.1 in the shaded jar.
[[1;34mINFO[m] Including javax.mail:mail:jar:1.4.1 in the shaded jar.
[[1;34mINFO[m] Including javax.activation:activation:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.geronimo.specs:geronimo-jaspic_1.0_spec:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including org.apache.geronimo.specs:geronimo-annotation_1.0_spec:jar:1.1.1 in the shaded jar.
[[1;34mINFO[m] Including asm:asm-commons:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including asm:asm-tree:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including joda-time:joda-time:jar:2.8.1 in the shaded jar.
[[1;34mINFO[m] Including log4j:apache-log4j-extras:jar:1.2.17 in the shaded jar.
[[1;34mINFO[m] Including org.apache.ant:ant:jar:1.9.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.ant:ant-launcher:jar:1.9.1 in the shaded jar.
[[1;34mINFO[m] Including com.codahale.metrics:metrics-core:jar:3.0.2 in the shaded jar.
[[1;34mINFO[m] Including com.codahale.metrics:metrics-jvm:jar:3.0.2 in the shaded jar.
[[1;34mINFO[m] Including com.codahale.metrics:metrics-json:jar:3.0.2 in the shaded jar.
[[1;34mINFO[m] Including com.fasterxml.jackson.core:jackson-databind:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including com.fasterxml.jackson.core:jackson-annotations:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including com.fasterxml.jackson.core:jackson-core:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-service:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including net.sf.jpam:jpam:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.thrift:libfb303:jar:0.9.3 in the shaded jar.
[[1;34mINFO[m] Including org.jamon:jamon-runtime:jar:2.3.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-serde:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including net.sf.opencsv:opencsv:jar:2.3 in the shaded jar.
[[1;34mINFO[m] Including com.twitter:parquet-hadoop-bundle:jar:1.5.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-servlet:jar:1.14 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-metastore:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.jolbox:bonecp:jar:0.8.0.RELEASE in the shaded jar.
[[1;34mINFO[m] Including org.apache.derby:derby:jar:10.11.1.1 in the shaded jar.
[[1;34mINFO[m] Including org.datanucleus:datanucleus-api-jdo:jar:3.2.6 in the shaded jar.
[[1;34mINFO[m] Including org.datanucleus:datanucleus-core:jar:3.2.10 in the shaded jar.
[[1;34mINFO[m] Including org.datanucleus:datanucleus-rdbms:jar:3.2.9 in the shaded jar.
[[1;34mINFO[m] Including commons-pool:commons-pool:jar:1.5.4 in the shaded jar.
[[1;34mINFO[m] Including commons-dbcp:commons-dbcp:jar:1.4 in the shaded jar.
[[1;34mINFO[m] Including javax.jdo:jdo-api:jar:3.0.1 in the shaded jar.
[[1;34mINFO[m] Including javax.transaction:jta:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including org.antlr:antlr-runtime:jar:3.4 in the shaded jar.
[[1;34mINFO[m] Including org.antlr:stringtemplate:jar:3.2.1 in the shaded jar.
[[1;34mINFO[m] Including antlr:antlr:jar:2.7.7 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-shims:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive.shims:hive-shims-common:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive.shims:hive-shims-0.23:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-resourcemanager:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.inject.extensions:guice-servlet:jar:3.0 in the shaded jar.
[[1;34mINFO[m] Including com.google.inject:guice:jar:3.0 in the shaded jar.
[[1;34mINFO[m] Including javax.inject:javax.inject:jar:1 in the shaded jar.
[[1;34mINFO[m] Including aopalliance:aopalliance:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey.contribs:jersey-guice:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-common:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-api:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-client:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-common:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.fusesource.leveldbjni:leveldbjni-all:jar:1.8 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-applicationhistoryservice:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-web-proxy:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive.shims:hive-shims-scheduler:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.mockito:mockito-all:jar:1.9.5 in the shaded jar.
[[1;34mINFO[m] Including org.apache.httpcomponents:httpclient:jar:4.2.5 in the shaded jar.
[[1;34mINFO[m] Including org.apache.httpcomponents:httpcore:jar:4.2.5 in the shaded jar.
[[1;34mINFO[m] Including org.apache.thrift:libthrift:jar:0.9.3 in the shaded jar.
[[1;34mINFO[m] Including org.apache.curator:curator-framework:jar:2.6.0 in the shaded jar.
[[1;33mWARNING[m] jasper-compiler-5.5.23.jar, jasper-runtime-5.5.23.jar define 1 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.jasper.compiler.Localizer
[[1;33mWARNING[m] apache-log4j-extras-1.2.17.jar, log4j-1.2.17.jar define 126 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.log4j.pattern.MessagePatternConverter
[[1;33mWARNING[m]   - org.apache.log4j.xml.DOMConfigurator$4
[[1;33mWARNING[m]   - org.apache.log4j.varia.StringMatchFilter
[[1;33mWARNING[m]   - org.apache.log4j.spi.OptionHandler
[[1;33mWARNING[m]   - org.apache.log4j.pattern.NameAbbreviator$DropElementAbbreviator
[[1;33mWARNING[m]   - org.apache.log4j.pattern.LevelPatternConverter
[[1;33mWARNING[m]   - org.apache.log4j.pattern.BridgePatternParser
[[1;33mWARNING[m]   - org.apache.log4j.BasicConfigurator
[[1;33mWARNING[m]   - org.apache.log4j.pattern.LoggingEventPatternConverter
[[1;33mWARNING[m]   - org.apache.log4j.ConsoleAppender$SystemErrStream
[[1;33mWARNING[m]   - 116 more...
[[1;33mWARNING[m] geronimo-jta_1.1_spec-1.1.1.jar, jta-1.1.jar define 18 overlappping classes: 
[[1;33mWARNING[m]   - javax.transaction.UserTransaction
[[1;33mWARNING[m]   - javax.transaction.Status
[[1;33mWARNING[m]   - javax.transaction.TransactionRequiredException
[[1;33mWARNING[m]   - javax.transaction.xa.XAResource
[[1;33mWARNING[m]   - javax.transaction.Transaction
[[1;33mWARNING[m]   - javax.transaction.InvalidTransactionException
[[1;33mWARNING[m]   - javax.transaction.SystemException
[[1;33mWARNING[m]   - javax.transaction.HeuristicCommitException
[[1;33mWARNING[m]   - javax.transaction.NotSupportedException
[[1;33mWARNING[m]   - javax.transaction.TransactionManager
[[1;33mWARNING[m]   - 8 more...
[[1;33mWARNING[m] commons-beanutils-1.7.0.jar, commons-collections-3.2.2.jar, commons-beanutils-core-1.8.0.jar define 10 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$EntrySet
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$KeySet
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$CollectionView$CollectionViewIterator
[[1;33mWARNING[m]   - org.apache.commons.collections.ArrayStack
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$Values
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$CollectionView
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$1
[[1;33mWARNING[m]   - org.apache.commons.collections.Buffer
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap
[[1;33mWARNING[m]   - org.apache.commons.collections.BufferUnderflowException
[[1;33mWARNING[m] commons-beanutils-1.7.0.jar, commons-beanutils-core-1.8.0.jar define 82 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.commons.beanutils.ConvertUtilsBean
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.SqlTimeConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.Converter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.FloatArrayConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.NestedNullException
[[1;33mWARNING[m]   - org.apache.commons.beanutils.ConvertingWrapDynaBean
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.LongArrayConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.SqlDateConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.BooleanArrayConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.StringConverter
[[1;33mWARNING[m]   - 72 more...
[[1;33mWARNING[m] hadoop-yarn-api-2.6.0-cdh5.13.1.jar, hadoop-yarn-common-2.6.0-cdh5.13.1.jar define 3 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.hadoop.yarn.util.package-info
[[1;33mWARNING[m]   - org.apache.hadoop.yarn.factories.package-info
[[1;33mWARNING[m]   - org.apache.hadoop.yarn.factory.providers.package-info
[[1;33mWARNING[m] jersey-servlet-1.14.jar, jersey-server-1.9.jar define 73 overlappping classes: 
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.container.servlet.Wrapper
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.container.servlet.JerseyServletContainerInitializer
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.ejb.EJBInjectionInterceptor
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.AnnotatedMemberImpl
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.AnnotatedTypeImpl
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.container.servlet.JSPTemplateProcessor
[[1;33mWARNING[m]   - com.sun.jersey.spi.container.servlet.WebComponent$2
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.AnnotatedConstructorImpl
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.CDIExtension$ParameterBean
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.CDIExtension
[[1;33mWARNING[m]   - 63 more...
[[1;33mWARNING[m] maven-shade-plugin has detected that some .class files
[[1;33mWARNING[m] are present in two or more JARs. When this happens, only
[[1;33mWARNING[m] one single version of the class is copied in the uberjar.
[[1;33mWARNING[m] Usually this is not harmful and you can skeep these
[[1;33mWARNING[m] warnings, otherwise try to manually exclude artifacts
[[1;33mWARNING[m] based on mvn dependency:tree -Ddetail=true and the above
[[1;33mWARNING[m] output
[[1;33mWARNING[m] See http://docs.codehaus.org/display/MAVENUSER/Shade+Plugin
[[1;34mINFO[m] Replacing /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/priceon_view/target/generate-bom-data.jar with /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/priceon_view/target/recursive_cte-0.0.1-SNAPSHOT-shaded.jar
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-assembly-plugin:2.4.1:single[m [1m(make-assembly)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Building jar: /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/priceon_view/target/recursive_cte-0.0.1-SNAPSHOT-jar-with-dependencies.jar
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time: 20.525 s
[[1;34mINFO[m] Finished at: 2018-03-28T07:53:21Z
[[1;34mINFO[m] Final Memory: 29M/377M
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Scanning for projects...
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1mBuilding recursive_cte 0.0.1-SNAPSHOT[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-resources-plugin:2.6:resources[m [1m(default-resources)[m @ [36mrecursive_cte[0;1m ---[m
[[1;33mWARNING[m] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[[1;34mINFO[m] skip non existing resourceDirectory /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/shelfon_view/src/main/resources
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:compile[m [1m(default-compile)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Changes detected - recompiling the module!
[[1;33mWARNING[m] File encoding has not been set, using platform encoding UTF-8, i.e. build is platform dependent!
[[1;34mINFO[m] Compiling 3 source files to /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/shelfon_view/target/classes
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:compile[m [1m(default)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Changes detected - recompiling the module!
[[1;33mWARNING[m] File encoding has not been set, using platform encoding UTF-8, i.e. build is platform dependent!
[[1;34mINFO[m] Compiling 3 source files to /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/shelfon_view/target/classes
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-resources-plugin:2.6:testResources[m [1m(default-testResources)[m @ [36mrecursive_cte[0;1m ---[m
[[1;33mWARNING[m] Using platform encoding (UTF-8 actually) to copy filtered resources, i.e. build is platform dependent!
[[1;34mINFO[m] skip non existing resourceDirectory /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/shelfon_view/src/test/resources
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:testCompile[m [1m(default-testCompile)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] No sources to compile
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-compiler-plugin:3.1:testCompile[m [1m(default)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] No sources to compile
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-surefire-plugin:2.12.4:test[m [1m(default-test)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] No tests to run.
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-jar-plugin:2.4:jar[m [1m(default-jar)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Building jar: /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/shelfon_view/target/recursive_cte-0.0.1-SNAPSHOT.jar
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-shade-plugin:2.3:shade[m [1m(default)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-common:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-annotations:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.guava:guava:jar:11.0.2 in the shaded jar.
[[1;34mINFO[m] Including commons-cli:commons-cli:jar:1.2 in the shaded jar.
[[1;34mINFO[m] Including org.apache.commons:commons-math3:jar:3.1.1 in the shaded jar.
[[1;34mINFO[m] Including xmlenc:xmlenc:jar:0.52 in the shaded jar.
[[1;34mINFO[m] Including commons-httpclient:commons-httpclient:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including commons-codec:commons-codec:jar:1.4 in the shaded jar.
[[1;34mINFO[m] Including commons-io:commons-io:jar:2.4 in the shaded jar.
[[1;34mINFO[m] Including commons-net:commons-net:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including commons-collections:commons-collections:jar:3.2.2 in the shaded jar.
[[1;34mINFO[m] Including javax.servlet:servlet-api:jar:2.5 in the shaded jar.
[[1;34mINFO[m] Including org.mortbay.jetty:jetty:jar:6.1.26.cloudera.4 in the shaded jar.
[[1;34mINFO[m] Including org.mortbay.jetty:jetty-util:jar:6.1.26.cloudera.4 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-core:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-json:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jettison:jettison:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including com.sun.xml.bind:jaxb-impl:jar:2.2.3-1 in the shaded jar.
[[1;34mINFO[m] Including javax.xml.bind:jaxb-api:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including javax.xml.stream:stax-api:jar:1.0-2 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-jaxrs:jar:1.8.3 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-xc:jar:1.8.3 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-server:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including asm:asm:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including tomcat:jasper-compiler:jar:5.5.23 in the shaded jar.
[[1;34mINFO[m] Including tomcat:jasper-runtime:jar:5.5.23 in the shaded jar.
[[1;34mINFO[m] Including javax.servlet.jsp:jsp-api:jar:2.1 in the shaded jar.
[[1;34mINFO[m] Including commons-el:commons-el:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including commons-logging:commons-logging:jar:1.1.3 in the shaded jar.
[[1;34mINFO[m] Including log4j:log4j:jar:1.2.17 in the shaded jar.
[[1;34mINFO[m] Including net.java.dev.jets3t:jets3t:jar:0.9.0 in the shaded jar.
[[1;34mINFO[m] Including com.jamesmurty.utils:java-xmlbuilder:jar:0.4 in the shaded jar.
[[1;34mINFO[m] Including commons-lang:commons-lang:jar:2.6 in the shaded jar.
[[1;34mINFO[m] Including commons-configuration:commons-configuration:jar:1.6 in the shaded jar.
[[1;34mINFO[m] Including commons-digester:commons-digester:jar:1.8 in the shaded jar.
[[1;34mINFO[m] Including commons-beanutils:commons-beanutils:jar:1.7.0 in the shaded jar.
[[1;34mINFO[m] Including commons-beanutils:commons-beanutils-core:jar:1.8.0 in the shaded jar.
[[1;34mINFO[m] Including org.slf4j:slf4j-api:jar:1.7.5 in the shaded jar.
[[1;34mINFO[m] Including org.slf4j:slf4j-log4j12:jar:1.7.5 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-core-asl:jar:1.8.8 in the shaded jar.
[[1;34mINFO[m] Including org.codehaus.jackson:jackson-mapper-asl:jar:1.8.8 in the shaded jar.
[[1;34mINFO[m] Including org.apache.avro:avro:jar:1.7.6-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.thoughtworks.paranamer:paranamer:jar:2.3 in the shaded jar.
[[1;34mINFO[m] Including org.xerial.snappy:snappy-java:jar:1.0.4.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.protobuf:protobuf-java:jar:2.5.0 in the shaded jar.
[[1;34mINFO[m] Including com.google.code.gson:gson:jar:2.2.4 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-auth:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.server:apacheds-kerberos-codec:jar:2.0.0-M15 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.server:apacheds-i18n:jar:2.0.0-M15 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.api:api-asn1-api:jar:1.0.0-M20 in the shaded jar.
[[1;34mINFO[m] Including org.apache.directory.api:api-util:jar:1.0.0-M20 in the shaded jar.
[[1;34mINFO[m] Including com.jcraft:jsch:jar:0.1.42 in the shaded jar.
[[1;34mINFO[m] Including org.apache.curator:curator-client:jar:2.7.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.curator:curator-recipes:jar:2.7.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.code.findbugs:jsr305:jar:3.0.0 in the shaded jar.
[[1;34mINFO[m] Including org.apache.htrace:htrace-core4:jar:4.0.1-incubating in the shaded jar.
[[1;34mINFO[m] Including org.apache.zookeeper:zookeeper:jar:3.4.5-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.commons:commons-compress:jar:1.4.1 in the shaded jar.
[[1;34mINFO[m] Including org.tukaani:xz:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-jdbc:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-common:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.commons:commons-lang3:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including org.eclipse.jetty.aggregate:jetty-all:jar:7.6.0.v20120127 in the shaded jar.
[[1;34mINFO[m] Including org.apache.geronimo.specs:geronimo-jta_1.1_spec:jar:1.1.1 in the shaded jar.
[[1;34mINFO[m] Including javax.mail:mail:jar:1.4.1 in the shaded jar.
[[1;34mINFO[m] Including javax.activation:activation:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.geronimo.specs:geronimo-jaspic_1.0_spec:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including org.apache.geronimo.specs:geronimo-annotation_1.0_spec:jar:1.1.1 in the shaded jar.
[[1;34mINFO[m] Including asm:asm-commons:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including asm:asm-tree:jar:3.1 in the shaded jar.
[[1;34mINFO[m] Including joda-time:joda-time:jar:2.8.1 in the shaded jar.
[[1;34mINFO[m] Including log4j:apache-log4j-extras:jar:1.2.17 in the shaded jar.
[[1;34mINFO[m] Including org.apache.ant:ant:jar:1.9.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.ant:ant-launcher:jar:1.9.1 in the shaded jar.
[[1;34mINFO[m] Including com.codahale.metrics:metrics-core:jar:3.0.2 in the shaded jar.
[[1;34mINFO[m] Including com.codahale.metrics:metrics-jvm:jar:3.0.2 in the shaded jar.
[[1;34mINFO[m] Including com.codahale.metrics:metrics-json:jar:3.0.2 in the shaded jar.
[[1;34mINFO[m] Including com.fasterxml.jackson.core:jackson-databind:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including com.fasterxml.jackson.core:jackson-annotations:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including com.fasterxml.jackson.core:jackson-core:jar:2.2.2 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-service:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including net.sf.jpam:jpam:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.thrift:libfb303:jar:0.9.3 in the shaded jar.
[[1;34mINFO[m] Including org.jamon:jamon-runtime:jar:2.3.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-serde:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including net.sf.opencsv:opencsv:jar:2.3 in the shaded jar.
[[1;34mINFO[m] Including com.twitter:parquet-hadoop-bundle:jar:1.5.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-servlet:jar:1.14 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-metastore:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.jolbox:bonecp:jar:0.8.0.RELEASE in the shaded jar.
[[1;34mINFO[m] Including org.apache.derby:derby:jar:10.11.1.1 in the shaded jar.
[[1;34mINFO[m] Including org.datanucleus:datanucleus-api-jdo:jar:3.2.6 in the shaded jar.
[[1;34mINFO[m] Including org.datanucleus:datanucleus-core:jar:3.2.10 in the shaded jar.
[[1;34mINFO[m] Including org.datanucleus:datanucleus-rdbms:jar:3.2.9 in the shaded jar.
[[1;34mINFO[m] Including commons-pool:commons-pool:jar:1.5.4 in the shaded jar.
[[1;34mINFO[m] Including commons-dbcp:commons-dbcp:jar:1.4 in the shaded jar.
[[1;34mINFO[m] Including javax.jdo:jdo-api:jar:3.0.1 in the shaded jar.
[[1;34mINFO[m] Including javax.transaction:jta:jar:1.1 in the shaded jar.
[[1;34mINFO[m] Including org.antlr:antlr-runtime:jar:3.4 in the shaded jar.
[[1;34mINFO[m] Including org.antlr:stringtemplate:jar:3.2.1 in the shaded jar.
[[1;34mINFO[m] Including antlr:antlr:jar:2.7.7 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive:hive-shims:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive.shims:hive-shims-common:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive.shims:hive-shims-0.23:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-resourcemanager:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.google.inject.extensions:guice-servlet:jar:3.0 in the shaded jar.
[[1;34mINFO[m] Including com.google.inject:guice:jar:3.0 in the shaded jar.
[[1;34mINFO[m] Including javax.inject:javax.inject:jar:1 in the shaded jar.
[[1;34mINFO[m] Including aopalliance:aopalliance:jar:1.0 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey.contribs:jersey-guice:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-common:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-api:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including com.sun.jersey:jersey-client:jar:1.9 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-common:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.fusesource.leveldbjni:leveldbjni-all:jar:1.8 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-applicationhistoryservice:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hadoop:hadoop-yarn-server-web-proxy:jar:2.6.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.apache.hive.shims:hive-shims-scheduler:jar:1.1.0-cdh5.13.1 in the shaded jar.
[[1;34mINFO[m] Including org.mockito:mockito-all:jar:1.9.5 in the shaded jar.
[[1;34mINFO[m] Including org.apache.httpcomponents:httpclient:jar:4.2.5 in the shaded jar.
[[1;34mINFO[m] Including org.apache.httpcomponents:httpcore:jar:4.2.5 in the shaded jar.
[[1;34mINFO[m] Including org.apache.thrift:libthrift:jar:0.9.3 in the shaded jar.
[[1;34mINFO[m] Including org.apache.curator:curator-framework:jar:2.6.0 in the shaded jar.
[[1;33mWARNING[m] jasper-compiler-5.5.23.jar, jasper-runtime-5.5.23.jar define 1 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.jasper.compiler.Localizer
[[1;33mWARNING[m] apache-log4j-extras-1.2.17.jar, log4j-1.2.17.jar define 126 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.log4j.pattern.MessagePatternConverter
[[1;33mWARNING[m]   - org.apache.log4j.xml.DOMConfigurator$4
[[1;33mWARNING[m]   - org.apache.log4j.varia.StringMatchFilter
[[1;33mWARNING[m]   - org.apache.log4j.spi.OptionHandler
[[1;33mWARNING[m]   - org.apache.log4j.pattern.NameAbbreviator$DropElementAbbreviator
[[1;33mWARNING[m]   - org.apache.log4j.pattern.LevelPatternConverter
[[1;33mWARNING[m]   - org.apache.log4j.pattern.BridgePatternParser
[[1;33mWARNING[m]   - org.apache.log4j.BasicConfigurator
[[1;33mWARNING[m]   - org.apache.log4j.pattern.LoggingEventPatternConverter
[[1;33mWARNING[m]   - org.apache.log4j.ConsoleAppender$SystemErrStream
[[1;33mWARNING[m]   - 116 more...
[[1;33mWARNING[m] geronimo-jta_1.1_spec-1.1.1.jar, jta-1.1.jar define 18 overlappping classes: 
[[1;33mWARNING[m]   - javax.transaction.UserTransaction
[[1;33mWARNING[m]   - javax.transaction.Status
[[1;33mWARNING[m]   - javax.transaction.TransactionRequiredException
[[1;33mWARNING[m]   - javax.transaction.xa.XAResource
[[1;33mWARNING[m]   - javax.transaction.Transaction
[[1;33mWARNING[m]   - javax.transaction.InvalidTransactionException
[[1;33mWARNING[m]   - javax.transaction.SystemException
[[1;33mWARNING[m]   - javax.transaction.HeuristicCommitException
[[1;33mWARNING[m]   - javax.transaction.NotSupportedException
[[1;33mWARNING[m]   - javax.transaction.TransactionManager
[[1;33mWARNING[m]   - 8 more...
[[1;33mWARNING[m] commons-beanutils-1.7.0.jar, commons-collections-3.2.2.jar, commons-beanutils-core-1.8.0.jar define 10 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$EntrySet
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$KeySet
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$CollectionView$CollectionViewIterator
[[1;33mWARNING[m]   - org.apache.commons.collections.ArrayStack
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$Values
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$CollectionView
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap$1
[[1;33mWARNING[m]   - org.apache.commons.collections.Buffer
[[1;33mWARNING[m]   - org.apache.commons.collections.FastHashMap
[[1;33mWARNING[m]   - org.apache.commons.collections.BufferUnderflowException
[[1;33mWARNING[m] commons-beanutils-1.7.0.jar, commons-beanutils-core-1.8.0.jar define 82 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.commons.beanutils.ConvertUtilsBean
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.SqlTimeConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.Converter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.FloatArrayConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.NestedNullException
[[1;33mWARNING[m]   - org.apache.commons.beanutils.ConvertingWrapDynaBean
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.LongArrayConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.SqlDateConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.BooleanArrayConverter
[[1;33mWARNING[m]   - org.apache.commons.beanutils.converters.StringConverter
[[1;33mWARNING[m]   - 72 more...
[[1;33mWARNING[m] hadoop-yarn-api-2.6.0-cdh5.13.1.jar, hadoop-yarn-common-2.6.0-cdh5.13.1.jar define 3 overlappping classes: 
[[1;33mWARNING[m]   - org.apache.hadoop.yarn.util.package-info
[[1;33mWARNING[m]   - org.apache.hadoop.yarn.factories.package-info
[[1;33mWARNING[m]   - org.apache.hadoop.yarn.factory.providers.package-info
[[1;33mWARNING[m] jersey-servlet-1.14.jar, jersey-server-1.9.jar define 73 overlappping classes: 
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.container.servlet.Wrapper
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.container.servlet.JerseyServletContainerInitializer
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.ejb.EJBInjectionInterceptor
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.AnnotatedMemberImpl
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.AnnotatedTypeImpl
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.container.servlet.JSPTemplateProcessor
[[1;33mWARNING[m]   - com.sun.jersey.spi.container.servlet.WebComponent$2
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.AnnotatedConstructorImpl
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.CDIExtension$ParameterBean
[[1;33mWARNING[m]   - com.sun.jersey.server.impl.cdi.CDIExtension
[[1;33mWARNING[m]   - 63 more...
[[1;33mWARNING[m] maven-shade-plugin has detected that some .class files
[[1;33mWARNING[m] are present in two or more JARs. When this happens, only
[[1;33mWARNING[m] one single version of the class is copied in the uberjar.
[[1;33mWARNING[m] Usually this is not harmful and you can skeep these
[[1;33mWARNING[m] warnings, otherwise try to manually exclude artifacts
[[1;33mWARNING[m] based on mvn dependency:tree -Ddetail=true and the above
[[1;33mWARNING[m] output
[[1;33mWARNING[m] See http://docs.codehaus.org/display/MAVENUSER/Shade+Plugin
[[1;34mINFO[m] Replacing /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/shelfon_view/target/generate-bom-data.jar with /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/shelfon_view/target/recursive_cte-0.0.1-SNAPSHOT-shaded.jar
[[1;34mINFO[m] 
[[1;34mINFO[m] [1m--- [0;32mmaven-assembly-plugin:2.4.1:single[m [1m(make-assembly)[m @ [36mrecursive_cte[0;1m ---[m
[[1;34mINFO[m] Building jar: /home/r62574/Final_run/ykdl_v0.9.0_adhoc/jobs/manual_run/recursive_views/recursive_cte_source_code/shelfon_view/target/recursive_cte-0.0.1-SNAPSHOT-jar-with-dependencies.jar
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] [1;32mBUILD SUCCESS[m
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
[[1;34mINFO[m] Total time: 21.777 s
[[1;34mINFO[m] Finished at: 2018-03-28T07:53:44Z
[[1;34mINFO[m] Final Memory: 35M/354M
[[1;34mINFO[m] [1m------------------------------------------------------------------------[m
Initiating authentication
Initiating authentication
Executing HQLs
*********************************
---------------------------------
Executing HQLs to Create Recursive CTE views
---------------------------------
*********************************
---------------------------------
Initializing priceon_vw_category_tree_tbl_struct.hql view creation
---------------------------------
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 1ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180328075353_45d6236e-a6e2-4042-ba94-6257c1ed61d8): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180328075353_45d6236e-a6e2-4042-ba94-6257c1ed61d8); Time taken: 0.151 seconds
INFO  : Executing command(queryId=hive_20180328075353_45d6236e-a6e2-4042-ba94-6257c1ed61d8): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180328075353_45d6236e-a6e2-4042-ba94-6257c1ed61d8); Time taken: 0.014 seconds
INFO  : OK
No rows affected (0.217 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> drop table if exists priceon_vw_category_tree;
INFO  : Compiling command(queryId=hive_20180328075353_fdd1a995-4bc8-4b1b-bdc8-b4c69cb022a7): drop table if exists priceon_vw_category_tree
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180328075353_fdd1a995-4bc8-4b1b-bdc8-b4c69cb022a7); Time taken: 0.096 seconds
INFO  : Executing command(queryId=hive_20180328075353_fdd1a995-4bc8-4b1b-bdc8-b4c69cb022a7): drop table if exists priceon_vw_category_tree
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180328075353_fdd1a995-4bc8-4b1b-bdc8-b4c69cb022a7); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.107 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS `priceon_vw_category_tree`(
. . . . . . . . . . . . . . . . . . . . . . .>   `priceon_category_seq` bigint, 
. . . . . . . . . . . . . . . . . . . . . . .>   `name` string, 
. . . . . . . . . . . . . . . . . . . . . . .>   `pseq` bigint, 
. . . . . . . . . . . . . . . . . . . . . . .>   `sort_src` varchar(255), 
. . . . . . . . . . . . . . . . . . . . . . .>   `depth_fullname` string)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT SERDE 
. . . . . . . . . . . . . . . . . . . . . . .>   'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' 
. . . . . . . . . . . . . . . . . . . . . . .> WITH SERDEPROPERTIES ( 
. . . . . . . . . . . . . . . . . . . . . . .>   'field.delim'='\t', 
. . . . . . . . . . . . . . . . . . . . . . .>   'line.delim'='\n', 
. . . . . . . . . . . . . . . . . . . . . . .>   'serialization.format'='\t') 
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS INPUTFORMAT 
. . . . . . . . . . . . . . . . . . . . . . .>   'org.apache.hadoop.mapred.TextInputFormat' 
. . . . . . . . . . . . . . . . . . . . . . .> OUTPUTFORMAT 
. . . . . . . . . . . . . . . . . . . . . . .>   'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION
. . . . . . . . . . . . . . . . . . . . . . .>   '/kcc_prd/ykdl/${hivedb}/priceon_vw_category_tree'
. . . . . . . . . . . . . . . . . . . . . . .> TBLPROPERTIES (
. . . . . . . . . . . . . . . . . . . . . . .>   'COLUMN_STATS_ACCURATE'='false', 
. . . . . . . . . . . . . . . . . . . . . . .>   'numFiles'='0', 
. . . . . . . . . . . . . . . . . . . . . . .>   'numRows'='-1', 
. . . . . . . . . . . . . . . . . . . . . . .>   'rawDataSize'='-1', 
. . . . . . . . . . . . . . . . . . . . . . .>   'totalSize'='0', 
. . . . . . . . . . . . . . . . . . . . . . .>   'transient_lastDdlTime'='1516799116')
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> ;
INFO  : Compiling command(queryId=hive_20180328075353_f7fe2471-b121-4baa-8c8c-aad536a8a981): CREATE EXTERNAL TABLE IF NOT EXISTS `priceon_vw_category_tree`(
`priceon_category_seq` bigint,
`name` string,
`pseq` bigint,
`sort_src` varchar(255),
`depth_fullname` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='\t',
'line.delim'='\n',
'serialization.format'='\t')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_vw_category_tree'
TBLPROPERTIES (
'COLUMN_STATS_ACCURATE'='false',
'numFiles'='0',
'numRows'='-1',
'rawDataSize'='-1',
'totalSize'='0',
'transient_lastDdlTime'='1516799116')
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180328075353_f7fe2471-b121-4baa-8c8c-aad536a8a981); Time taken: 0.118 seconds
INFO  : Executing command(queryId=hive_20180328075353_f7fe2471-b121-4baa-8c8c-aad536a8a981): CREATE EXTERNAL TABLE IF NOT EXISTS `priceon_vw_category_tree`(
`priceon_category_seq` bigint,
`name` string,
`pseq` bigint,
`sort_src` varchar(255),
`depth_fullname` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='\t',
'line.delim'='\n',
'serialization.format'='\t')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'/kcc_prd/ykdl/prd_ykdl_adhoc_db/priceon_vw_category_tree'
TBLPROPERTIES (
'COLUMN_STATS_ACCURATE'='false',
'numFiles'='0',
'numRows'='-1',
'rawDataSize'='-1',
'totalSize'='0',
'transient_lastDdlTime'='1516799116')
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180328075353_f7fe2471-b121-4baa-8c8c-aad536a8a981); Time taken: 0.348 seconds
INFO  : OK
No rows affected (0.481 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
---------------------------------
priceon_vw_category_tree_tbl_struct.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_category_tree_tbl_struct.hql view creation
---------------------------------
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=512M; support was removed in 8.0
scan complete in 2ms
Connecting to jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
Connected to: Apache Hive (version 1.1.0-cdh5.13.1)
Driver: Hive JDBC (version 1.1.0-cdh5.13.1)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
INFO  : Compiling command(queryId=hive_20180328075353_2b47df80-7073-413d-8e65-98096ba14025): use prd_ykdl_adhoc_db
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180328075353_2b47df80-7073-413d-8e65-98096ba14025); Time taken: 0.111 seconds
INFO  : Executing command(queryId=hive_20180328075353_2b47df80-7073-413d-8e65-98096ba14025): use prd_ykdl_adhoc_db
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180328075353_2b47df80-7073-413d-8e65-98096ba14025); Time taken: 0.01 seconds
INFO  : OK
No rows affected (0.166 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> drop table if exists shelfon_vw_category_tree;
INFO  : Compiling command(queryId=hive_20180328075353_0aec1a8a-d418-473e-893f-51e5bc27e055): drop table if exists shelfon_vw_category_tree
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180328075353_0aec1a8a-d418-473e-893f-51e5bc27e055); Time taken: 0.094 seconds
INFO  : Executing command(queryId=hive_20180328075353_0aec1a8a-d418-473e-893f-51e5bc27e055): drop table if exists shelfon_vw_category_tree
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180328075353_0aec1a8a-d418-473e-893f-51e5bc27e055); Time taken: 0.005 seconds
INFO  : OK
No rows affected (0.104 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE EXTERNAL TABLE IF NOT EXISTS `shelfon_vw_category_tree`(
. . . . . . . . . . . . . . . . . . . . . . .>   `shelfon_category_seq` bigint, 
. . . . . . . . . . . . . . . . . . . . . . .>   `name` string, 
. . . . . . . . . . . . . . . . . . . . . . .>   `pseq` bigint, 
. . . . . . . . . . . . . . . . . . . . . . .>   `sort_src` varchar(255), 
. . . . . . . . . . . . . . . . . . . . . . .>   `depth_fullname` string)
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT SERDE 
. . . . . . . . . . . . . . . . . . . . . . .>   'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' 
. . . . . . . . . . . . . . . . . . . . . . .> WITH SERDEPROPERTIES ( 
. . . . . . . . . . . . . . . . . . . . . . .>   'field.delim'='\t', 
. . . . . . . . . . . . . . . . . . . . . . .>   'line.delim'='\n', 
. . . . . . . . . . . . . . . . . . . . . . .>   'serialization.format'='\t') 
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS INPUTFORMAT 
. . . . . . . . . . . . . . . . . . . . . . .>   'org.apache.hadoop.mapred.TextInputFormat' 
. . . . . . . . . . . . . . . . . . . . . . .> OUTPUTFORMAT 
. . . . . . . . . . . . . . . . . . . . . . .>   'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION
. . . . . . . . . . . . . . . . . . . . . . .>   '/kcc_prd/ykdl/${hivedb}/shelfon_vw_category_tree'
. . . . . . . . . . . . . . . . . . . . . . .> TBLPROPERTIES (
. . . . . . . . . . . . . . . . . . . . . . .>   'COLUMN_STATS_ACCURATE'='false', 
. . . . . . . . . . . . . . . . . . . . . . .>   'numFiles'='0', 
. . . . . . . . . . . . . . . . . . . . . . .>   'numRows'='-1', 
. . . . . . . . . . . . . . . . . . . . . . .>   'rawDataSize'='-1', 
. . . . . . . . . . . . . . . . . . . . . . .>   'totalSize'='0', 
. . . . . . . . . . . . . . . . . . . . . . .>   'transient_lastDdlTime'='1516799244')
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> ;
INFO  : Compiling command(queryId=hive_20180328075353_8bfbc570-5ce7-4d20-8262-4da932c1f6fb): CREATE EXTERNAL TABLE IF NOT EXISTS `shelfon_vw_category_tree`(
`shelfon_category_seq` bigint,
`name` string,
`pseq` bigint,
`sort_src` varchar(255),
`depth_fullname` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='\t',
'line.delim'='\n',
'serialization.format'='\t')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_vw_category_tree'
TBLPROPERTIES (
'COLUMN_STATS_ACCURATE'='false',
'numFiles'='0',
'numRows'='-1',
'rawDataSize'='-1',
'totalSize'='0',
'transient_lastDdlTime'='1516799244')
INFO  : Semantic Analysis Completed
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20180328075353_8bfbc570-5ce7-4d20-8262-4da932c1f6fb); Time taken: 0.1 seconds
INFO  : Executing command(queryId=hive_20180328075353_8bfbc570-5ce7-4d20-8262-4da932c1f6fb): CREATE EXTERNAL TABLE IF NOT EXISTS `shelfon_vw_category_tree`(
`shelfon_category_seq` bigint,
`name` string,
`pseq` bigint,
`sort_src` varchar(255),
`depth_fullname` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
WITH SERDEPROPERTIES (
'field.delim'='\t',
'line.delim'='\n',
'serialization.format'='\t')
STORED AS INPUTFORMAT
'org.apache.hadoop.mapred.TextInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
'/kcc_prd/ykdl/prd_ykdl_adhoc_db/shelfon_vw_category_tree'
TBLPROPERTIES (
'COLUMN_STATS_ACCURATE'='false',
'numFiles'='0',
'numRows'='-1',
'rawDataSize'='-1',
'totalSize'='0',
'transient_lastDdlTime'='1516799244')
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20180328075353_8bfbc570-5ce7-4d20-8262-4da932c1f6fb); Time taken: 0.386 seconds
INFO  : OK
No rows affected (0.499 seconds)
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
Closing: 0: jdbc:hive2://ustcl705.kcc.com:10000/prd_ykdl_adhoc_db;principal=hive/ustcl705.kcc.com@KCC.COM;ssl=true
---------------------------------
shelfon_vw_category_tree_tbl_struct.hql view CREATED
---------------------------------
*********************************
---------------------------------
Views Creation process finished
---------------------------------
*********************************
Recursive view_as_table structure creation Successful for create_all_views .
Initiating authentication
Running jar
log4j:WARN No appenders could be found for logger (org.apache.hadoop.metrics2.lib.MutableMetricsFactory).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
Initial records to be Exported are identified
2018/03/28 07:54:36
Iteration: 0 2018/03/28 07:54:36
Iteration: 1 2018/03/28 07:54:36
Iteration: 2 2018/03/28 07:54:36
Iteration: 3 2018/03/28 07:54:36
Iteration: 4 2018/03/28 07:54:36
Iteration: 5 2018/03/28 07:54:36
Iteration: 6 2018/03/28 07:54:36
Iteration: 7 2018/03/28 07:54:36
Iteration: 8 2018/03/28 07:54:36
Iteration: 9 2018/03/28 07:54:36
Iteration: 10 2018/03/28 07:54:36
Iteration: 11 2018/03/28 07:54:36
Iteration: 12 2018/03/28 07:54:36
Iteration: 13 2018/03/28 07:54:36
Iteration: 14 2018/03/28 07:54:36
Iteration: 15 2018/03/28 07:54:36
Iteration: 16 2018/03/28 07:54:36
Iteration: 17 2018/03/28 07:54:36
Iteration: 18 2018/03/28 07:54:36
Iteration: 19 2018/03/28 07:54:36
Iteration: 20 2018/03/28 07:54:36
Iteration: 21 2018/03/28 07:54:36
Iteration: 22 2018/03/28 07:54:36
Iteration: 23 2018/03/28 07:54:36
Iteration: 24 2018/03/28 07:54:36
Iteration: 25 2018/03/28 07:54:36
Iteration: 26 2018/03/28 07:54:36
Iteration: 27 2018/03/28 07:54:36
Iteration: 28 2018/03/28 07:54:36
Iteration: 29 2018/03/28 07:54:36
Iteration: 30 2018/03/28 07:54:36
Iteration: 31 2018/03/28 07:54:36
Iteration: 32 2018/03/28 07:54:36
Iteration: 33 2018/03/28 07:54:36
Iteration: 34 2018/03/28 07:54:36
Iteration: 35 2018/03/28 07:54:36
Iteration: 36 2018/03/28 07:54:36
Iteration: 37 2018/03/28 07:54:36
Iteration: 38 2018/03/28 07:54:36
Iteration: 39 2018/03/28 07:54:36
Iteration: 40 2018/03/28 07:54:36
Iteration: 41 2018/03/28 07:54:36
Iteration: 42 2018/03/28 07:54:36
Iteration: 43 2018/03/28 07:54:36
Iteration: 44 2018/03/28 07:54:36
Iteration: 45 2018/03/28 07:54:36
Iteration: 46 2018/03/28 07:54:36
Iteration: 47 2018/03/28 07:54:36
473
Checking Destination HDFS Directory
Placing CSV to HDFS Dest. Directory
Recursive view creation Successful for UID041_priceon_vw_category_tree_view_sh .
Initiating authentication
Running jar
log4j:WARN No appenders could be found for logger (org.apache.hadoop.metrics2.lib.MutableMetricsFactory).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
Initial records to be Exported are identified
2018/03/28 07:55:18
Iteration: 0 2018/03/28 07:55:18
Iteration: 1 2018/03/28 07:55:18
Iteration: 2 2018/03/28 07:55:18
30
Checking Destination HDFS Directory
Placing CSV to HDFS Dest. Directory
Recursive view creation Successful for UID044_shelfon_vw_category_tree_view_sh .
Initiating authentication
Executing HQLs
*********************************
---------------------------------
Executing HQLs to Create all the views
---------------------------------
*********************************
---------------------------------
Initializing online_dpsm_new_vw.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS online_dpsm_new_vw;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE table IF NOT EXISTS online_dpsm_new_vw
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .>         SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>             'D' AS type            
. . . . . . . . . . . . . . . . . . . . . . .>             , year
. . . . . . . . . . . . . . . . . . . . . . .>             , month
. . . . . . . . . . . . . . . . . . . . . . .>             , concat(cast(year AS varchar(4)),'-', CAST(month AS varchar(2))) AS date
. . . . . . . . . . . . . . . . . . . . . . .>             , biz_category
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>             , site
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS item_title
. . . . . . . . . . . . . . . . . . . . . . .>             , vlt
. . . . . . . . . . . . . . . . . . . . . . .>             , product_category_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , sub_brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS second_product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , sku_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS entry_site
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS competitor_product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS market
. . . . . . . . . . . . . . . . . . . . . . .>             , cast( '0' as int) AS its_weight_point
. . . . . . . . . . . . . . . . . . . . . . .>             , cast( '0' as int) AS top5_weight_point
. . . . . . . . . . . . . . . . . . . . . . .>             , actual
. . . . . . . . . . . . . . . . . . . . . . .>             , target
. . . . . . . . . . . . . . . . . . . . . . .>             , reg_date
. . . . . . . . . . . . . . . . . . . . . . .>             
. . . . . . . . . . . . . . . . . . . . . . .>         FROM tb_online_dpsm_d_report
. . . . . . . . . . . . . . . . . . . . . . .>     UNION ALL
. . . . . . . . . . . . . . . . . . . . . . .>         SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>             'P' AS type
. . . . . . . . . . . . . . . . . . . . . . .>             , year
. . . . . . . . . . . . . . . . . . . . . . .>             , month
. . . . . . . . . . . . . . . . . . . . . . .>             , concat(cast(year AS varchar(4)),'-', CAST(month AS varchar(2))) AS date
. . . . . . . . . . . . . . . . . . . . . . .>             , biz_category
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS site
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS item_title
. . . . . . . . . . . . . . . . . . . . . . .>             , vlt
. . . . . . . . . . . . . . . . . . . . . . .>             , product_category_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , sub_brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , second_product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , sku_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , entry_site
. . . . . . . . . . . . . . . . . . . . . . .>             , competitor_product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , market
. . . . . . . . . . . . . . . . . . . . . . .>             , cast( '0' as int) AS its_weight_point
. . . . . . . . . . . . . . . . . . . . . . .>             , cast( '0' as int) AS top5_weight_point
. . . . . . . . . . . . . . . . . . . . . . .>             , actual
. . . . . . . . . . . . . . . . . . . . . . .>             , target
. . . . . . . . . . . . . . . . . . . . . . .>             , reg_date
. . . . . . . . . . . . . . . . . . . . . . .>             
. . . . . . . . . . . . . . . . . . . . . . .>         FROM tb_online_dpsm_p_report
. . . . . . . . . . . . . . . . . . . . . . .>     UNION ALL
. . . . . . . . . . . . . . . . . . . . . . .>         SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>             'S' AS type
. . . . . . . . . . . . . . . . . . . . . . .>             , year
. . . . . . . . . . . . . . . . . . . . . . .>             , month
. . . . . . . . . . . . . . . . . . . . . . .>             , concat(cast(year AS varchar(4)),'-', CAST(month AS varchar(2))) AS date
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS biz_category
. . . . . . . . . . . . . . . . . . . . . . .>             , depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>             , site
. . . . . . . . . . . . . . . . . . . . . . .>             , item_title
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS vlt
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS product_category_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS sub_brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS second_product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , cast( '0' as int) AS sku_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS entry_site
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS competitor_product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS market
. . . . . . . . . . . . . . . . . . . . . . .>             , its_row_count AS its_weight_point
. . . . . . . . . . . . . . . . . . . . . . .>             , top5_row_count AS top5_weight_point
. . . . . . . . . . . . . . . . . . . . . . .>             , actual
. . . . . . . . . . . . . . . . . . . . . . .>             , target
. . . . . . . . . . . . . . . . . . . . . . .>             , reg_date
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         FROM tb_online_dpsm_s_report_new
. . . . . . . . . . . . . . . . . . . . . . .>     UNION ALL
. . . . . . . . . . . . . . . . . . . . . . .>         SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>             'M' AS type
. . . . . . . . . . . . . . . . . . . . . . .>             , year
. . . . . . . . . . . . . . . . . . . . . . .>             , month
. . . . . . . . . . . . . . . . . . . . . . .>             , concat(cast(year AS varchar(4)),'-', CAST(month AS varchar(2))) AS date
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS biz_category
. . . . . . . . . . . . . . . . . . . . . . .>             , depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>             , site
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS item_title
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS vlt
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS product_category_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS sub_brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS second_product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , cast( '0' as int) AS sku_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS entry_site
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS competitor_product_name
. . . . . . . . . . . . . . . . . . . . . . .>             , '' AS market
. . . . . . . . . . . . . . . . . . . . . . .>             , its_weight_point
. . . . . . . . . . . . . . . . . . . . . . .>             , top5_weight_point
. . . . . . . . . . . . . . . . . . . . . . .>             , actual
. . . . . . . . . . . . . . . . . . . . . . .>             , target
. . . . . . . . . . . . . . . . . . . . . . .>             , reg_date
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         FROM tb_online_dpsm_m_report_new
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
online_dpsm_new_vw.hql view CREATED
---------------------------------
---------------------------------
Initializing priceon_vw_all.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS priceon_vw_all;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE table IF NOT EXISTS priceon_vw_all
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .>         SELECT
. . . . . . . . . . . . . . . . . . . . . . .>                 CAT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>                 , SKU.priceon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>                 , SKU.customer_code
. . . . . . . . . . . . . . . . . . . . . . .>                 , SKU.title AS sku_title
. . . . . . . . . . . . . . . . . . . . . . .>          , PU.pid
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.pakcage_count
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.piece_count
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.piece_sale_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.piece_card_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.piece_sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.piece_card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.total_piece
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.unit_base_size
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.unit_sale_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.unit_card_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.unit_sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.unit_card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>                 , PU.total_unit
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.seq AS CPSeq
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.entry_site
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.market
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.title
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.option_name
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.url
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.delivery_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.delivery_charge_type
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>                 , CP.rtime
. . . . . . . . . . . . . . . . . . . . . . .>                 , CC.certified
. . . . . . . . . . . . . . . . . . . . . . .>                 , CC.seller AS seller_collected_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , CC.name AS name_collected_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , CCP.seq AS CCPSeq
. . . . . . . . . . . . . . . . . . . . . . .>                 , CCP.card_name
. . . . . . . . . . . . . . . . . . . . . . .>                 , CCP.card_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , CCP.card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>                 , CC2.seller AS seller_collected_card_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , CC2.name AS name_collected_card_price
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         FROM ${hivedb}.priceon_vw_category_tree AS CAT
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from ${hivedb}.priceon_sku_processed where active_flag = 'Y') AS  SKU ON CAT.priceon_category_seq = SKU.priceon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from ${hivedb}.priceon_piece_unit_processed where active_flag =  'Y') as PU ON SKU.pid = PU.pid
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from ${hivedb}.priceon_collected_price_processed where active_fl ag = 'Y') AS CP ON PU.priceon_data_seq = CP.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         LEFT JOIN (select * from  ${hivedb}.collected_corp_processed where active_flag  = 'Y') AS CC ON CP.corp_seq = CC.corp_seq
. . . . . . . . . . . . . . . . . . . . . . .>         LEFT JOIN (select * from ${hivedb}.priceon_collected_card_price_processed where  active_flag = 'Y') AS CCP ON PU.priceon_data_seq = CCP.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         LEFT JOIN (select * from ${hivedb}.collected_corp_processed where active_flag =  'Y') AS CC2 ON CCP.corp_seq = CC2.corp_seq
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
priceon_vw_all.hql view CREATED
---------------------------------
---------------------------------
Initializing priceon_vw_priceon_lowest_all.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS priceon_vw_priceon_lowest_all;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS priceon_vw_priceon_lowest_all
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         -- Category
. . . . . . . . . . . . . . . . . . . . . . .>         CAT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         -- SKU
. . . . . . . . . . . . . . . . . . . . . . .>         , SKU.customer_code
. . . . . . . . . . . . . . . . . . . . . . .>         , SKU.title AS sku_title
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         -- Piece Unit
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.pakcage_count
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.piece_count
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.piece_sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.piece_card_price
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.piece_sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.piece_card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.total_piece
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.unit_base_size
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.unit_sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.unit_card_price
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.unit_sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.unit_card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.total_unit
. . . . . . . . . . . . . . . . . . . . . . .>         , PU.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         -- Collected Price
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.entry_site
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.market
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.title
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.option_name
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.url
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.delivery_price
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.delivery_charge_type
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.rtime
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         -- Collected Price Seller
. . . . . . . . . . . . . . . . . . . . . . .>         , CC.certified
. . . . . . . . . . . . . . . . . . . . . . .>         , CC.seller AS seller_collected_price
. . . . . . . . . . . . . . . . . . . . . . .>         , CC.name AS name_collected_price
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         -- Collected Card Price
. . . . . . . . . . . . . . . . . . . . . . .>         , CCP.card_name
. . . . . . . . . . . . . . . . . . . . . . .>         , CCP.card_price
. . . . . . . . . . . . . . . . . . . . . . .>         , CCP.card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         -- Collected Price Seller
. . . . . . . . . . . . . . . . . . . . . . .>         , CC2.seller AS seller_collected_card_price
. . . . . . . . . . . . . . . . . . . . . . .>         , CC2.name AS name_collected_card_price
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     FROM priceon_vw_category_tree AS CAT
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from priceon_sku_processed where active_flag = 'Y') AS SKU  ON CAT.pric eon_category_seq = SKU.priceon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from priceon_piece_unit_processed where active_flag = 'Y') AS PU ON SKU .pid = PU.pid 
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from priceon_collected_price_processed where active_flag = 'Y') AS CP O N PU.priceon_data_seq = CP.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>     LEFT JOIN (select * from collected_corp_processed where active_flag = 'Y') AS CC ON CP .corp_seq = CC.corp_seq
. . . . . . . . . . . . . . . . . . . . . . .>     LEFT JOIN (select * from priceon_collected_card_price_processed where active_flag = 'Y ') AS CCP ON PU.priceon_data_seq = CCP.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>     LEFT JOIN (select * from collected_corp_processed where active_flag = 'Y') AS CC2 ON C CP.corp_seq = CC2.corp_seq
. . . . . . . . . . . . . . . . . . . . . . .>     WHERE PU.isLowestPrice = 'Y'
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
priceon_vw_priceon_lowest_all.hql view CREATED
---------------------------------
---------------------------------
Initializing priceon_vw_priceon_lowest_certified.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS priceon_vw_priceon_lowest_certified;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE table IF NOT EXISTS priceon_vw_priceon_lowest_certified
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         CAT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .> , SKU.customer_code
. . . . . . . . . . . . . . . . . . . . . . .> , SKU.title AS sku_title
. . . . . . . . . . . . . . . . . . . . . . .> , PU.pakcage_count
. . . . . . . . . . . . . . . . . . . . . . .> , PU.piece_count
. . . . . . . . . . . . . . . . . . . . . . .> , PU.piece_sale_price
. . . . . . . . . . . . . . . . . . . . . . .> , PU.piece_card_price
. . . . . . . . . . . . . . . . . . . . . . .> , PU.piece_sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , PU.piece_card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , PU.total_piece
. . . . . . . . . . . . . . . . . . . . . . .> , PU.unit_base_size
. . . . . . . . . . . . . . . . . . . . . . .> , PU.unit_sale_price
. . . . . . . . . . . . . . . . . . . . . . .> , PU.unit_card_price
. . . . . . . . . . . . . . . . . . . . . . .> , PU.unit_sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , PU.unit_card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , PU.total_unit
. . . . . . . . . . . . . . . . . . . . . . .> , PU.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .> , CP.seq AS CPSeq
. . . . . . . . . . . . . . . . . . . . . . .> , CP.entry_site
. . . . . . . . . . . . . . . . . . . . . . .> , CP.market
. . . . . . . . . . . . . . . . . . . . . . .> , CP.title
. . . . . . . . . . . . . . . . . . . . . . .> , CP.option_name
. . . . . . . . . . . . . . . . . . . . . . .> , CP.url
. . . . . . . . . . . . . . . . . . . . . . .> , CP.sale_price
. . . . . . . . . . . . . . . . . . . . . . .> , CP.delivery_price
. . . . . . . . . . . . . . . . . . . . . . .> , CP.delivery_charge_type
. . . . . . . . . . . . . . . . . . . . . . .> , CP.sale_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , CP.rtime
. . . . . . . . . . . . . . . . . . . . . . .> , CC.certified
. . . . . . . . . . . . . . . . . . . . . . .> , CC.seller AS seller_collected_price
. . . . . . . . . . . . . . . . . . . . . . .> , CC.name AS name_collected_price
. . . . . . . . . . . . . . . . . . . . . . .> , CCP.seq AS CCPSeq
. . . . . . . . . . . . . . . . . . . . . . .> , CCP.card_name
. . . . . . . . . . . . . . . . . . . . . . .> , CCP.card_price
. . . . . . . . . . . . . . . . . . . . . . .> , CCP.card_price_appended_delivery
. . . . . . . . . . . . . . . . . . . . . . .> , CC2.seller AS seller_collected_card_price
. . . . . . . . . . . . . . . . . . . . . . .> , CC2.name AS name_collected_card_price
. . . . . . . . . . . . . . . . . . . . . . .>         
. . . . . . . . . . . . . . . . . . . . . . .>     FROM priceon_vw_category_tree AS CAT
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from ${hivedb}.priceon_sku_processed where active_flag = 'Y' ) AS SKU O N CAT.priceon_category_seq = SKU.priceon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from ${hivedb}.priceon_piece_unit_processed where active_flag = 'Y' ) A S PU ON SKU.pid = PU.pid  
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from ${hivedb}.priceon_collected_price_processed where active_flag = 'Y ') AS CP ON PU.priceon_data_seq = CP.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>     LEFT JOIN (select * from ${hivedb}.collected_corp_processed  where active_flag = 'Y')  AS CC ON CP.corp_seq = CC.corp_seq
. . . . . . . . . . . . . . . . . . . . . . .>     LEFT JOIN  (select * from ${hivedb}.priceon_collected_card_price_processed where activ e_flag = 'Y') AS CCP ON PU.priceon_data_seq = CCP.priceon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>     LEFT JOIN  (select * from ${hivedb}.collected_corp_processed  where active_flag = 'Y')  AS CC2 ON CCP.corp_seq = CC2.corp_seq
. . . . . . . . . . . . . . . . . . . . . . .>     WHERE (PU.certifiedLowest = 'true' OR PU.uncertifiedLowest = 'true')
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
priceon_vw_priceon_lowest_certified.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_deal_keyword.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS shelfon_vw_deal_keyword;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE table IF NOT EXISTS shelfon_vw_deal_keyword
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>         
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from ${hivedb}.shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from ${hivedb}.shelfon_item_channel_processed where active_flag = 'Y')  AS IC ON SI.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN ${hivedb}.shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfo n_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from ${hivedb}.shelfon_collected_data_processed where active_flag = 'Y' ) AS SCD  ON IC.ngid = SCD.ngid 
. . . . . . . . . . . . . . . . . . . . . . .>     WHERE SCD.total_position <= 40 
. . . . . . . . . . . . . . . . . . . . . . .>     and IC.query_type = 'keyword' 
. . . . . . . . . . . . . . . . . . . . . . .>     and SCD.tr_brand != ''
. . . . . . . . . . . . . . . . . . . . . . .>     and VCT.shelfon_category_seq not in (3989, 3990)
. . . . . . . . . . . . . . . . . . . . . . .>     and (
. . . . . . . . . . . . . . . . . . . . . . .>         (
. . . . . . . . . . . . . . . . . . . . . . .>             SCD.site in ('gmarket_mobile', 'gmarket')
. . . . . . . . . . . . . . . . . . . . . . .>             and SCD.section_name in ('power_click', 'smart_delivery', 'power', 'plus')
. . . . . . . . . . . . . . . . . . . . . . .>         )
. . . . . . . . . . . . . . . . . . . . . . .>         OR
. . . . . . . . . . . . . . . . . . . . . . .>         (
. . . . . . . . . . . . . . . . . . . . . . .>             SCD.site in ('street11')
. . . . . . . . . . . . . . . . . . . . . . .>             and SCD.section_name in ('power', 'hot_click', 'now_delivery', 'recommend', 'shockin g_deal', 'top_click')
. . . . . . . . . . . . . . . . . . . . . . .>         )
. . . . . . . . . . . . . . . . . . . . . . .>         OR
. . . . . . . . . . . . . . . . . . . . . . .>         (
. . . . . . . . . . . . . . . . . . . . . . .>             SCD.site in ('street11_mobile')
. . . . . . . . . . . . . . . . . . . . . . .>             and SCD.section_name in ('power', 'hot_click', 'now_delivery', 'recommend', 'top_cli ck')
. . . . . . . . . . . . . . . . . . . . . . .>         )
. . . . . . . . . . . . . . . . . . . . . . .>         OR
. . . . . . . . . . . . . . . . . . . . . . .>         (
. . . . . . . . . . . . . . . . . . . . . . .>             SCD.site in ('auction_mobile', 'auction')
. . . . . . . . . . . . . . . . . . . . . . .>             and SCD.section_name in ('chance_shopping', 'power_click', 'smart_delivery', 'power' )
. . . . . . . . . . . . . . . . . . . . . . .>         )
. . . . . . . . . . . . . . . . . . . . . . .>     )
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_deal_keyword.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_deal_keyword_subbrand.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_deal_keyword;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_deal_keyword_subbrand
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         SELECT
. . . . . . . . . . . . . . . . . . . . . . .>                 VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>                 , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>                 , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.madeby AS multi_madeby
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.brand AS multi_brand
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.subbrand AS multi_subbrrand
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_item_channel_processed where active_flag = 'Y') AS  IC  ON SI.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfon_c ategory_seq
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') A S SCD  ON IC.ngid = SCD.ngid
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_attr_processed where active_flag = 'Y') AS ATT  ON  ATT.hashcode = SCD.hashcode
. . . . . . . . . . . . . . . . . . . . . . .>         WHERE SCD.total_position <= 40
. . . . . . . . . . . . . . . . . . . . . . .>         and IC.query_type = 'keyword'
. . . . . . . . . . . . . . . . . . . . . . .>         and SCD.tr_brand != ''
. . . . . . . . . . . . . . . . . . . . . . .>         and VCT.shelfon_category_seq not in (3989, 3990)                
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         and (
. . . . . . . . . . . . . . . . . . . . . . .>                 (
. . . . . . . . . . . . . . . . . . . . . . .>                         SCD.site in ('gmarket_mobile', 'gmarket')
. . . . . . . . . . . . . . . . . . . . . . .>                         and SCD.section_name in ('power_click', 'smart_delivery', 'powe r', 'plus')
. . . . . . . . . . . . . . . . . . . . . . .>                 )
. . . . . . . . . . . . . . . . . . . . . . .>                 OR
. . . . . . . . . . . . . . . . . . . . . . .>                 (
. . . . . . . . . . . . . . . . . . . . . . .>                         SCD.site in ('street11')
. . . . . . . . . . . . . . . . . . . . . . .>                         and SCD.section_name in ('power', 'hot_click', 'now_delivery',  'recommend', 'shocking_deal', 'top_click')
. . . . . . . . . . . . . . . . . . . . . . .>                 )
. . . . . . . . . . . . . . . . . . . . . . .>                 OR
. . . . . . . . . . . . . . . . . . . . . . .>                 (
. . . . . . . . . . . . . . . . . . . . . . .>                         SCD.site in ('street11_mobile')
. . . . . . . . . . . . . . . . . . . . . . .>                         and SCD.section_name in ('power', 'hot_click', 'now_delivery',  'recommend', 'top_click')
. . . . . . . . . . . . . . . . . . . . . . .>                 )
. . . . . . . . . . . . . . . . . . . . . . .>                 OR
. . . . . . . . . . . . . . . . . . . . . . .>                 (
. . . . . . . . . . . . . . . . . . . . . . .>                         SCD.site in ('auction_mobile', 'auction')
. . . . . . . . . . . . . . . . . . . . . . .>                         and SCD.section_name in ('chance_shopping', 'power_click', 'sma rt_delivery', 'power')
. . . . . . . . . . . . . . . . . . . . . . .>                 )
. . . . . . . . . . . . . . . . . . . . . . .>         );
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_deal_keyword_subbrand.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_deal_keyword_subbrand_temp.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_deal_keyword_subbrand_temp;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_deal_keyword_subbrand_temp
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         SELECT
. . . . . . . . . . . . . . . . . . . . . . .>                 VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>                 , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>                 , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.madeby AS multi_madeby
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.brand AS multi_brand
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.subbrand AS multi_subbrrand
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_item_channel_processed where active_flag = 'Y') AS  IC  ON SI.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN shelfon_vw_category_tree AS VCT  ON IC.shelfon_category_seq = VCT.shelfon_ category_seq
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') A S SCD  ON IC.ngid = SCD.ngid
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_attr_processed where active_flag = 'Y') AS ATT  ON  ATT.hashcode = SCD.hashcode
. . . . . . . . . . . . . . . . . . . . . . .>         WHERE SCD.total_position <= 40
. . . . . . . . . . . . . . . . . . . . . . .>         and IC.query_type = 'keyword'
. . . . . . . . . . . . . . . . . . . . . . .>         and SCD.tr_brand != ''
. . . . . . . . . . . . . . . . . . . . . . .>         and VCT.shelfon_category_seq not in (3989, 3990)                -- 3390:  / 3 989: 
. . . . . . . . . . . . . . . . . . . . . . .>                                                                           -- -- 
. . . . . . . . . . . . . . . . . . . . . . .>         and (
. . . . . . . . . . . . . . . . . . . . . . .>                 (
. . . . . . . . . . . . . . . . . . . . . . .>                         SCD.site in ('gmarket_mobile', 'gmarket')
. . . . . . . . . . . . . . . . . . . . . . .>                         and SCD.section_name in ('power_click', 'smart_delivery', 'powe r', 'plus')
. . . . . . . . . . . . . . . . . . . . . . .>                 )
. . . . . . . . . . . . . . . . . . . . . . .>                 OR
. . . . . . . . . . . . . . . . . . . . . . .>                 (
. . . . . . . . . . . . . . . . . . . . . . .>                         SCD.site in ('street11')
. . . . . . . . . . . . . . . . . . . . . . .>                         and SCD.section_name in ('power', 'hot_click', 'now_delivery',  'recommend', 'shocking_deal', 'top_click')
. . . . . . . . . . . . . . . . . . . . . . .>                 )
. . . . . . . . . . . . . . . . . . . . . . .>                 OR
. . . . . . . . . . . . . . . . . . . . . . .>                 (
. . . . . . . . . . . . . . . . . . . . . . .>                         SCD.site in ('street11_mobile')
. . . . . . . . . . . . . . . . . . . . . . .>                         and SCD.section_name in ('power', 'hot_click', 'now_delivery',  'recommend', 'top_click')
. . . . . . . . . . . . . . . . . . . . . . .>                 )
. . . . . . . . . . . . . . . . . . . . . . .>                 OR
. . . . . . . . . . . . . . . . . . . . . . .>                 (
. . . . . . . . . . . . . . . . . . . . . . .>                         SCD.site in ('auction_mobile', 'auction')
. . . . . . . . . . . . . . . . . . . . . . .>                         and SCD.section_name in ('chance_shopping', 'power_click', 'sma rt_delivery', 'power')
. . . . . . . . . . . . . . . . . . . . . . .>                 )
. . . . . . . . . . . . . . . . . . . . . . .>         )
. . . . . . . . . . . . . . . . . . . . . . .>         and depth_fullname ='/ > ' and SCD.site = 'street11' and rdate between ' 2017-01-01' and '2017-10-31'
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_deal_keyword_subbrand_temp.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_merchandising_paid.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_merchandising_paid;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_merchandising_paid
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rolling_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_item_channel_processed where active_flag = 'Y') AS IC ON S I.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfon_category _seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') AS SCD O N IC.ngid = SCD.ngid 
. . . . . . . . . . . . . . . . . . . . . . .>           AND SCD.site in ('gmarket','gmarket_mobile','street11','street11_mobile','auctio n','auction_mobile')
. . . . . . . . . . . . . . . . . . . . . . .>           AND SCD.rdate >= '2017-04-01'
. . . . . . . . . . . . . . . . . . . . . . .>           AND SCD.section_name not in ('normal')
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_merchandising_paid.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_penetration.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_penetration_innervw;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_penetration;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_penetration_innervw
. . . . . . . . . . . . . . . . . . . . . . .> AS 
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> SELECT
. . . . . . . . . . . . . . . . . . . . . . .>             SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.rdate
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.sku_cd
. . . . . . . . . . . . . . . . . . . . . . .>         FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI 
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_item_channel_processed where active_flag = 'Y') AS SIC  O N SI.npid = SIC.npid
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') AS SCD   ON SIC.ngid = SCD.ngid
. . . . . . . . . . . . . . . . . . . . . . .>         ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_penetration
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT
. . . . . . . . . . . . . . . . . . . . . . .>         CP.item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.site
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.url
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (CP.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.sku_cd
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.product_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.biz_category
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.product_category_cd
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.sub_brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>         , AK.classification
. . . . . . . . . . . . . . . . . . . . . . .>         , AK.classification_purpose
. . . . . . . . . . . . . . . . . . . . . . .>     
. . . . . . . . . . . . . . . . . . . . . . .>     FROM tb_sku_master_processed AS SM 
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN tb_attentive_sku_processed AS AK  ON SM.sku_cd = AK.sku_cd AND SM.use_yn = 'Y' AN D AK.use_yn = 'Y'
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN shelfon_vw_penetration_innervw AS CP ON SM.sku_cd = CP.sku_cd
. . . . . . . . . . . . . . . . . . . . . . .>     WHERE CP.sku_cd > 0
. . . . . . . . . . . . . . . . . . . . . . .>     
. . . . . . . . . . . . . . . . . . . . . . .>     ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_penetration.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_penetration_skucd_mapping.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS ${hivedb}.shelfon_vw_penetration_skucd_mapping_innervw;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS ${hivedb}.shelfon_vw_penetration_skucd_mapping;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS ${hivedb}.shelfon_vw_penetration_skucd_mapping_innervw
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT  
. . . . . . . . . . . . . . . . . . . . . . .>             SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>             , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>             , SCD.rdate    
. . . . . . . . . . . . . . . . . . . . . . .>             , SM.sku_cd
. . . . . . . . . . . . . . . . . . . . . . .>             , SM.insert_dt
. . . . . . . . . . . . . . . . . . . . . . .>         FROM (select * from ${hivedb}.shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from ${hivedb}.shelfon_item_channel_processed where active_flag = 'Y')  AS SIC ON SI.npid = SIC.npid
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from ${hivedb}.shelfon_collected_data_processed where active_flag = 'Y ') AS SCD ON SIC.ngid = SCD.ngid 
. . . . . . . . . . . . . . . . . . . . . . .>         LEFT OUTER JOIN ${hivedb}.tb_shelfon_skucd_mapping AS SM  ON SCD.shelfon_data_seq = S M.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         WHERE SCD.site NOT IN ('naver','danawa','enuri') 
. . . . . . . . . . . . . . . . . . . . . . .>         AND SCD.rdate >= '2017-04-01'
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE table IF NOT EXISTS ${hivedb}.shelfon_vw_penetration_skucd_mapping
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT
. . . . . . . . . . . . . . . . . . . . . . .>         CP.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.site
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.url
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (CP.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , CP.insert_dt
. . . . . . . . . . . . . . . . . . . . . . .>         , CEILING(CAST(RAND()*(1000000000-5+1)+500000000 as bigint)) as shelfon_option_data_s eq
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.sku_cd
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.product_cd
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.product_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.biz_category
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.product_category_cd
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.sub_brand_cd
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.ean13
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.ean14
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.main_vision
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.primary_division
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.secondary_division
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.work_group
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.ctg
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.vision_category
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.vlt
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.factorial_mart
. . . . . . . . . . . . . . . . . . . . . . .>         , SM.sub_category
. . . . . . . . . . . . . . . . . . . . . . .>         , AK.classification
. . . . . . . . . . . . . . . . . . . . . . .>         , AK.classification_purpose
. . . . . . . . . . . . . . . . . . . . . . .>         
. . . . . . . . . . . . . . . . . . . . . . .>     FROM ${hivedb}.tb_sku_master_processed AS SM 
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN ${hivedb}.tb_attentive_sku_processed AS AK  ON SM.sku_cd = AK.sku_cd AND SM.use_y n = 'Y' AND AK.use_yn = 'Y'
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN ${hivedb}.shelfon_vw_penetration_skucd_mapping_innervw AS CP ON SM.sku_cd = CP.sk u_cd
. . . . . . . . . . . . . . . . . . . . . . .>     ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_penetration_skucd_mapping.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_simple_doctormomming.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS shelfon_vw_simple_doctormomming;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE table IF NOT EXISTS shelfon_vw_simple_doctormomming
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from ${hivedb}.shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from ${hivedb}.shelfon_item_channel_processed where active_flag = 'Y')  AS IC ON SI.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN ${hivedb}.shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfo n_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from ${hivedb}.shelfon_collected_data_processed where active_flag = 'Y' ) AS SCD ON IC.ngid = SCD.ngid 
. . . . . . . . . . . . . . . . . . . . . . .>     WHERE SCD.tr_brand = ''
. . . . . . . . . . . . . . . . . . . . . . .>     AND SCD.rdate >= '2017-07-01' 
. . . . . . . . . . . . . . . . . . . . . . .>     AND IC.query_type NOT IN ('keyword')
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_simple_doctormomming.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_simple.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_simple;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_simple
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI 
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_item_channel_processed where active_flag = 'Y') AS IC ON S I.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfon_category _seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') AS SCD O N IC.ngid = SCD.ngid
. . . . . . . . . . . . . . . . . . . . . . .>     ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_simple.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_simple_reliu.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_simple_reliu;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS shelfon_vw_simple_reliu;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE TABLE if not exists shelfon_vw_simple_reliu
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>         
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from shelfon_item_processed where active_flag = 'Y' ) AS SI 
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_item_channel_processed  where active_flag = 'Y' ) AS IC ON  SI.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfon_category _seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y' ) AS SCD  ON IC.ngid = SCD.ngid 
. . . . . . . . . . . . . . . . . . . . . . .>     WHERE tr_brand='' and rdate >= '2017-07-01' and query_type != 'keyword'
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_simple_reliu.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_simple_top10.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP TABLE IF EXISTS shelfon_vw_simple_top10;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE table IF NOT EXISTS shelfon_vw_simple_top10
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .> SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>         
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from ${hivedb}.shelfon_item_processed where active_flag = 'Y') AS SI 
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from ${hivedb}.shelfon_item_channel_processed where active_flag = 'Y')  AS IC ON SI.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN ${hivedb}.shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfo n_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from ${hivedb}.shelfon_collected_data_processed where active_flag = 'Y' ) AS SCD ON IC.ngid = SCD.ngid 
. . . . . . . . . . . . . . . . . . . . . . .>     WHERE SCD.total_position <=10
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_simple_top10.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_simple_top10_multiBrand_add_option.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_simple_top10_multiBrand_add_option;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_simple_top10_multiBrand_add_option
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCOD.shelfon_option_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCOD.option_name AS collected_Option
. . . . . . . . . . . . . . . . . . . . . . .>         , SCOD.sale_price AS Option_sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , ATT.madeby AS multi_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , ATT.brand AS multi_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , ATT.subbrand AS multi_subbrrand
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_item_channel_processed where active_flag = 'Y') AS IC ON S I.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfon_category _seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') AS SCD O N IC.ngid = SCD.ngid 
. . . . . . . . . . . . . . . . . . . . . . .>     LEFT JOIN (select * from shelfon_collected_option_data_processed where active_flag = ' Y') AS SCOD ON SCD.shelfon_data_seq = SCOD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_attr_processed where active_flag = 'Y') AS ATT  ON ATT.has hcode = SCD.hashcode
. . . . . . . . . . . . . . . . . . . . . . .>     WHERE SCD.total_position <=10 and  ic.query_type != 'keyword' and rdate > '2017-09-30' 
. . . . . . . . . . . . . . . . . . . . . . .>     ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_simple_top10_multiBrand_add_option.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_simple_top10_multiBrand_DP.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_simple_top10_multiBrand_DP;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_simple_top10_multiBrand_DP
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         SELECT
. . . . . . . . . . . . . . . . . . . . . . .>                 VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>                 , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>                 , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>                 , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>                 , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.madeby AS multi_madeby
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.brand AS multi_brand
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.subbrand AS multi_subbrrand
. . . . . . . . . . . . . . . . . . . . . . .>                 , ATT.category AS multi_category
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>         FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_item_channel_processed  where active_flag = 'Y') AS  IC ON SI.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfon_c ategory_seq
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') A S SCD ON IC.ngid = SCD.ngid
. . . . . . . . . . . . . . . . . . . . . . .>         JOIN (select * from shelfon_attr_processed where active_flag = 'Y') AS ATT ON A TT.hashcode = SCD.hashcode
. . . . . . . . . . . . . . . . . . . . . . .>         WHERE SCD.total_position <=10 and vct.depth_fullname = '/ > ' and IC.que ry_type != 'keyword' and att.madeby !='' 
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_simple_top10_multiBrand_DP.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_simple_top10_multiBrand.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_simple_top10_multiBrand;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_simple_top10_multiBrand
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , ATT.madeby AS multi_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , ATT.brand AS multi_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , ATT.subbrand AS multi_subbrrand
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_item_channel_processed where active_flag = 'Y') AS IC  ON  SI.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN shelfon_vw_category_tree AS VCT  ON IC.shelfon_category_seq = VCT.shelfon_categor y_seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') AS SCD   ON IC.ngid = SCD.ngid 
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_attr_processed where active_flag = 'Y') AS ATT  ON ATT.has hcode = SCD.hashcode
. . . . . . . . . . . . . . . . . . . . . . .>     WHERE SCD.total_position <=10 and ic.query_type != 'keyword'
. . . . . . . . . . . . . . . . . . . . . . .> ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_simple_top10_multiBrand.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_simple_top10_NoBrand.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_simple_top10_NoBrand;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_simple_top10_NoBrand
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_item_channel_processed where active_flag = 'Y') AS IC ON S I.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfon_category _seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') AS SCD O N IC.ngid = SCD.ngid AND SCD.total_position <=10
. . . . . . . . . . . . . . . . . . . . . . .>     where scd.tr_madeby IS NULL or scd.tr_madeby = ''
. . . . . . . . . . . . . . . . . . . . . . .>     ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_simple_top10_NoBrand.hql view CREATED
---------------------------------
---------------------------------
Initializing shelfon_vw_simple_top20.hql view creation
---------------------------------
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> use ${hivedb};
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> DROP VIEW IF EXISTS shelfon_vw_simple_top20;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> CREATE VIEW IF NOT EXISTS shelfon_vw_simple_top20
. . . . . . . . . . . . . . . . . . . . . . .> AS
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>         VCT.depth_fullname
. . . . . . . . . . . . . . . . . . . . . . .>         , SI.title AS item_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.shelfon_data_seq
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.site
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.url
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.wave
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.sale_price
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_name
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.section_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.total_position
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.page
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.rtime
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.title AS collected_Title
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_madeby
. . . . . . . . . . . . . . . . . . . . . . .>         , SCD.tr_brand
. . . . . . . . . . . . . . . . . . . . . . .>         , cast (SCD.rdate as date) as rdate
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_type
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.query_params
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.help
. . . . . . . . . . . . . . . . . . . . . . .>         , IC.shelfon_category_seq
. . . . . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . . . . .>     FROM (select * from shelfon_item_processed where active_flag = 'Y') AS SI
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_item_channel_processed where active_flag = 'Y') AS IC ON S I.npid = IC.npid
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN shelfon_vw_category_tree AS VCT ON IC.shelfon_category_seq = VCT.shelfon_category _seq
. . . . . . . . . . . . . . . . . . . . . . .>     JOIN (select * from shelfon_collected_data_processed where active_flag = 'Y') AS SCD O N IC.ngid = SCD.ngid AND SCD.total_position <=20
. . . . . . . . . . . . . . . . . . . . . . .>     ;
0: jdbc:hive2://ustcl705.kcc.com:10000/prd_yk> 
---------------------------------
shelfon_vw_simple_top20.hql view CREATED
---------------------------------
*********************************
---------------------------------
Views Creation process finished
---------------------------------
*********************************
Successful for recursive view 
Starting sqoop-export loading data from hadoop to hana.
Initiating authentication
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for tb_category_brand_report .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for tb_category_brand_report_new .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for tb_category_mnft_report .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for tb_category_mnft_report_new .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for tb_online_dpsm_d_report .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for tb_online_dpsm_p_report .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for online_dpsm_new_vw .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for priceon_vw_all .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for priceon_vw_priceon_lowest_certified .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for shelfon_vw_deal_keyword .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for shelfon_vw_simple_doctormomming .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for shelfon_vw_simple_reliu .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for shelfon_vw_simple_top10 .
Warning: /opt/cloudera/parcels/CDH-5.13.1-1.cdh5.13.1.p0.2/bin/../lib/sqoop/../accumulo does not exist! Accumulo imports will fail.
Please set $ACCUMULO_HOME to the root of your Accumulo installation.
Sqoop Export to HANA Successful for shelfon_vw_penetration_skucd_mapping .
Successfully exported data to HANA
